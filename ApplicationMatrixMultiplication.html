<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Application: Matrix Multiplication</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 1768 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots.html'>prev</a>][<a href='BFVScheme.html#ApplicationMatrixMultiplication.html'>parent</a>][<a href='NoiseBootstrapping1.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='application-matrix-multiplication'><span class='titlemark'>D-2.10   </span> <a id='x125-165000D-2.10'></a>Application: Matrix Multiplication</h4>
<!-- l. 1771 --><p class='noindent'>BFV has no clean way to do a homomorphic dot product between two vectors (i.e.,
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>),
because the last step of a vector dot product requires summation of all slot-wise intermediate values (i.e.,
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi></mrow></msub><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi></mrow></msub></mrow></math>).
However, each slot in BFV’s batch encoding is independent from each other, which
cannot be simply added up across slots (i.e., input vector elements). Instead, we need
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> copies
of the multiplied ciphertexts and properly align their slots by many rotation operations before adding
them up. Meanwhile, the homomorphic input vector slot rotation scheme can be effectively used when we
homomorphically multiply a plaintext matrix with an encrypted vector. Remember that given a matrix
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math> and
vector <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
(Definition A-10.3 in <a href='MatrixArithmetic.html#matrix-arithmetic'><span class='ts1-lmr10-x-x-109'>§</span>A-10.3<!-- tex4ht:ref: subsec:matrix-arithmetic  --></a>):
</p><!-- l. 1773 --><p class='indent'>   <!-- l. 1773 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'>  <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msub><mrow><mi>a</mi></mrow><mrow>
<mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> </mtd><mtd class='array-td' columnalign='center'> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> </mtd><mtd class='array-td' columnalign='center'> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'><msub><mrow>   <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'><msub><mrow>  <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'><msub><mrow>  <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub>  </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>      </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'><msub><mrow> <mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> </mrow><mrow>
<mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                  </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1787 --><p class='indent'>   <!-- l. 1787 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1789 --><p class='indent'>   The result of <!-- l. 1789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
is an <!-- l. 1789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>-dimensional
vector computed as:
</p><!-- l. 1791 --><p class='indent'>   <!-- l. 1791 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>m</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 1793 --><p class='indent'>   <!-- l. 1793 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1795 --><p class='indent'>   Let’s define <!-- l. 1795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ρ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as
the rotation of <!-- l. 1795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
by <!-- l. 1795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left. And remember that the Hadamard dot product (Definition A-10.1 in <a href='VectorArithmetic.html#vector-arithmetic'><span class='ts1-lmr10-x-x-109'>§</span>A-10.1<!-- tex4ht:ref: subsec:vector-arithmetic  --></a>) is
defined as slot-wise multiplication of two vectors:
</p><!-- l. 1797 --><p class='indent'>   <!-- l. 1797 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-bin' stretchy='false'>⊙</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>b</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>b</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1799 --><p class='indent'>   <!-- l. 1799 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1801 --><p class='indent'>   Let’s define <!-- l. 1801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
diagonal vector <!-- l. 1801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>u</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>i</mi></mrow></msub></math>
extracted from matrix <!-- l. 1801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math>
as follows:
</p><!-- l. 1803 --><p class='indent'>   <!-- l. 1803 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>u</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>j</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>m</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>n</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p><!-- l. 1805 --><p class='indent'>   <!-- l. 1805 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1807 --><p class='indent'>   Then, the original matrix-to-vector multiplication formula can be equivalently constructed as
follows:
</p><!-- l. 1809 --><p class='indent'>   <!-- l. 1809 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mover accent='true'><mrow><mi>u</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⊙</mo><mi>ρ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mi>u</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⊙</mo><mi>ρ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mi>u</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⊙</mo><mi>ρ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 1811 --><p class='indent'>   , whose computation result is equivalent to <!-- l. 1811 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>.
The above formula is compatible with homomorphic computation, because BFV
supports Hadamard dot product between input vectors as a ciphertext-to-plaintext
multiplication between their polynomial-encoded forms (<a href='CiphertexttoPlaintextMultiplication1.html#ciphertexttoplaintext-multiplication1'><span class='ts1-lmr10-x-x-109'>§</span>D-3.6<!-- tex4ht:ref: subsec:vector-arithmetic  --></a>), and BFV also supports
<!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ρ</mi><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as homomorphic
input vector slot rotation (<a href='HomomorphicRotationofInputVectorSlots1.html#homomorphic-rotation-of-input-vector-slots1'><span class='ts1-lmr10-x-x-109'>§</span>D-3.9<!-- tex4ht:ref: subsec:vector-arithmetic  --></a>). After homomorphically computing the above formula, we can consider only the
first <!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> (out of
<!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>) resulting input vector
slots to store the result of <!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>x</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>.
                                                                                         
                                                                                         
</p>
   <!-- l. 1816 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots.html'>prev</a>][<a href='BFVScheme.html#ApplicationMatrixMultiplication.html'>parent</a>][<a href='NoiseBootstrapping1.html'>next</a>]</p></div>
    
</body> 
</html>