<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Applying RNS Techniques to FHE Operations</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 815 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>][<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='applying-rns-techniques-to-fhe-operations'><span class='titlemark'>D-5.10   </span>   <a id='x162-236000D-5.10'></a>Applying RNS Techniques to FHE Operations</h4>
<!-- l. 818 --><p class='noindent'>This subsection will explain how the RNS primitives we have learned so far are used to handle FHE
operations for RNS-based ciphertexts in BFV, CKKS, and BGV.
   
</p>
   <h5 class='subsubsectionHead' id='addition-and-multiplication-of-polynomials'><span class='titlemark'>D-5.10.1   </span>   <a id='x162-237000D-5.10.1'></a>Addition and Multiplication of Polynomials</h5>
<!-- l. 824 --><p class='noindent'>In BFV, CKKS, and BGV, ciphertext-to-plaintext addition, ciphertext-to-ciphertext addition,
and ciphertext-to-plaintext multiplication are performed by only involving modulo additions
and multiplications among polynomial coefficients. Therefore, we can represent each
polynomial coefficient as an RNS residue vector and compute coefficient-wise additions and
multiplications by using RNS-based addition and multiplication of residues, as explained in
SummaryÂ A-13.1 (<a href='ApplicationResidueNumberSystemRNS.html#application-residue-number-system-rns'><span class='ts1-lmr10-x-x-109'>Â§</span>A-13.1<!-- tex4ht:ref: subsec:crt-application  --></a>). For example, suppose we have the following two polynomials
<!-- l. 824 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math> and
<!-- l. 824 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>:
</p><!-- l. 826 --><p class='indent'>   <!-- l. 826 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>a</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>a</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msub></mrow></math>
</p><!-- l. 828 --><p class='indent'>   <!-- l. 828 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>b</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>b</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msub></mrow></math>
</p><!-- l. 830 --><p class='indent'>   <!-- l. 830 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 832 --><p class='indent'>   In the RNS-variant FHE schemes, we express each coefficient of the polynomial as an RNS residue
vector as follows:
</p><!-- l. 834 --><p class='indent'>   <!-- l. 834 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span style='color:#FF0000;'>
<!-- l. 834 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> for
<!-- l. 834 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 836 --><p class='indent'>   <!-- l. 836 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span style='color:#FF0000;'>
<!-- l. 836 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> for
<!-- l. 836 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 838 --><p class='indent'>   <!-- l. 838 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 840 --><p class='indent'>   Given the above RNS setup, when we add or multiply two polynomials, each coefficient-to-coefficient
addition is computed as element-wise additions of two RNS residue vectors as follows:
</p><!-- l. 842 --><p class='indent'>   <!-- l. 842 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span style='color:#FF0000;'>
<!-- l. 842 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> where
<!-- l. 842 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mstyle></mrow></math>,
<!-- l. 842 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 844 --><p class='indent'>   <!-- l. 844 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>âŸº</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 846 --><p class='indent'>   <!-- l. 846 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 848 --><p class='indent'>   Similarly, each coefficient-to-coefficient multiplication is computed as element-wise multiplications of
two RNS residue vectors as follows:
</p><!-- l. 850 --><p class='indent'>   <!-- l. 850 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 852 --><p class='indent'>   <!-- l. 852 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>âŸº</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 854 --><p class='indent'>   <!-- l. 854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 856 --><p class='indent'>   Using the above isomorphism, we can efficiently compute ciphertext-to-plaintext addition,
ciphertext-to-ciphertext addition, and ciphertext-to-plaintext multiplication of big polynomial coefficients
(e.g., 1000 bits big) based on small RNS residues (e.g., 30 bits each).
   
</p>
   <h5 class='subsubsectionHead' id='key-switching1'><span class='titlemark'>D-5.10.2   </span>   <a id='x162-238000D-5.10.2'></a>Key Switching</h5>
<!-- l. 862 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertextâ€™s key-switching operation from
<!-- l. 862 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math> is
performed by computing the following formula in RNS vectors:
</p><!-- l. 864 --><p class='indent'>   <!-- l. 864 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–£ğ–¾ğ–¼ğ—ˆğ—†ğ—‰</mtext></mstyle></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¾ğ—</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></mrow></math>
</p><!-- l. 867 --><p class='indent'>   <!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 869 --><p class='indent'>   In the above formula, the computation of <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–£ğ–¾ğ–¼ğ—ˆğ—†ğ—‰</mtext></mstyle></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¾ğ—</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></mrow></math>
can be performed by using <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–£ğ–¾ğ–¼ğ—ˆğ—†ğ—‰ğ–¬ğ—ğ—…ğ—<msub><mrow></mrow><mrow><mtext>ğ–±ğ–­ğ–²</mtext></mrow></msub></mtext></mstyle></math>
(SummaryÂ D-5.9 in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>Â§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>), after which <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>
can be added to it by using regular RNS-based addition.
</p><!-- l. 871 --><p class='indent'>   <!-- l. 871 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 873 --><p class='indent'>   Similarly, in the case of the BGV, an RNS-based key-switching operation on a ciphertext from
<!-- l. 873 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math> is
performed by computing the following in RNS vectors:
</p><!-- l. 875 --><p class='indent'>   <!-- l. 875 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–£ğ–¾ğ–¼ğ—ˆğ—†ğ—‰</mtext></mstyle></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¾ğ—</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow><mrow><mi>Î²</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></mrow></math>
   
</p>
   <h5 class='subsubsectionHead' id='input-slot-rotation'><span class='titlemark'>D-5.10.3   </span>   <a id='x162-239000D-5.10.3'></a>Input Slot Rotation</h5>
<!-- l. 881 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertextâ€™s input slot rotation is performed by computing the following
formulas in RNS vectors:
</p><!-- l. 883 --><p class='indent'>   <!-- l. 883 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 886 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 888 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 888 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 891 --><p class='indent'>   <!-- l. 891 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 893 --><p class='indent'>   Step 1 is equivalent to re-positioning the coefficients within each polynomial and flipping their signs whenever they cross
the boundary of the <!-- l. 893 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
degree term. This step can be done with RNS-based coefficients by moving around each set of RNS
                                                                                         
                                                                                         
residue vectors as a whole whenever the coefficient they represent is re-positioned to a new degree term,
and flipping the signs of the residues in the same RNS vector altogether whenever their representing
coefficientâ€™s sign is to be flipped. Step 2â€™s RNS-based key switching can be done in the same way as
explained in the previous subsection (<a href='#key-switching1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-5.10.2<!-- tex4ht:ref: subsec:rns-decompmult  --></a>).
</p><!-- l. 895 --><p class='indent'>   <!-- l. 895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 897 --><p class='indent'>   Similarly, in BGV, an RNS-based ciphertextâ€™s input slot rotation is performed by computing the
following formulas in RNS vectors:
</p><!-- l. 899 --><p class='indent'>   <!-- l. 899 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 902 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 902 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 904 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 904 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 907 --><p class='indent'>   <!-- l. 907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 909 --><p class='indent'>   We can compute the above formulas in RNS by using the same strategy explained for BFV or
CKKS.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.4   </span>   <a id='x162-240000D-5.10.4'></a>BFVâ€™s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 917 --><p class='noindent'>BFVâ€™s ciphertext-to-ciphertext multiplication (SummaryÂ D-2.7.5 in <a href='CiphertexttoCiphertextMultiplication.html#summary1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.7.5<!-- tex4ht:ref: subsubsec:bfv-mult-cipher-summary  --></a>) comprises <span class='rm-lmss-10x-x-109'>ModRaise</span>
<!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo></mrow></math> polynomial
multiplication <!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo></mrow></math>
relinearization <!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo></mrow></math>
rescaling, where the order of relinearization and rescaling can be swapped. In RNS-based ciphertext-to-ciphertext
multiplication, we will swap the order of these two steps. The procedure is as follows: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>
from <!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi mathvariant='italic'>ğ‘ğ‘</mi></mrow></math>;
(2) polynomial multiplication; (3) constant multiplication by
<!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>; (4) <span class='rm-lmss-10x-x-109'>ModSwitch </span>from
<!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>b</mi></mrow></math>; (5) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from
<!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math>; and (6) relinearization.
Among these, step <!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo><mn>5</mn></mrow></math>
corresponds to the rescaling operation. We will explain how each of these steps works.
</p><!-- l. 920 --><p class='indent'>   <!-- l. 920 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 923 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 924 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 926 --><p class='noindent'>Let <!-- l. 926 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   be a new RNS base where <!-- l. 926 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi mathvariant='normal'>Î”</mi></mrow></math>
   so that <!-- l. 926 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi></mrow></math>
                                                                                         
                                                                                         
   is large enough to prevent a multiplied scaled plaintext in ciphertexts (i.e., <!-- l. 926 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>)
   from exceeding its allowed limit (SummaryÂ D-2.3 in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a>) during ciphertext-to-ciphertext
   multiplication. <!-- l. 926 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></math>
   is also added for exact fast base conversion to be performed later. Specifically, we mod-raise the
   modulus of each polynomial coefficient of ciphertexts <!-- l. 927 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and <!-- l. 927 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   </p><!-- l. 930 --><p class='noindent'><!-- l. 930 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 932 --><p class='noindent'><!-- l. 932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 934 --><p class='noindent'><!-- l. 934 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 936 --><p class='noindent'>, where each coefficient of <!-- l. 936 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup></mrow></math>
   is either <!-- l. 936 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Decrypting these two (noisy) ciphertexts with the private key <!-- l. 936 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   would give the following outputs:
   </p><!-- l. 938 --><p class='noindent'><!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 940 --><p class='noindent'><!-- l. 940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 942 --><p class='noindent'><!-- l. 942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 944 --><p class='noindent'><!-- l. 944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi></mrow></math>
   is the <!-- l. 944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>-overflows
   of the decryption process</span>
   </p><!-- l. 946 --><p class='noindent'><!-- l. 946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 948 --><p class='noindent'><!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 950 --><p class='noindent'><!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 952 --><p class='noindent'><!-- l. 952 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 954 --><p class='noindent'><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 957 --><p class='noindent'><!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Polynomial Multiplication:</span></span>
   <!-- l. 961 --><p class='noindent'>Compute <!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>,
   whose decryption relation is as follows:
   </p><!-- l. 963 --><p class='noindent'><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 965 --><p class='noindent'><!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 967 --><p class='noindent'><!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 969 --><p class='noindent'><!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>ğ­</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 973 --><p class='noindent'>Step <!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo><mn>5</mn></mrow></math>
   are equivalent to rescaling the plaintextâ€™s scaling factor from <!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi mathvariant='normal'>Î”</mi></mrow></math>
   as well as switching the ciphertextâ€™s modulus from <!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   to <!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   In this step, we multiply <!-- l. 974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
   to each coefficient of the resulting polynomials from the previous step as follows:
   </p><!-- l. 976 --><p class='noindent'><!-- l. 976 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 978 --><p class='noindent'><!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 980 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 982 --><p class='noindent'><!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 984 --><p class='noindent'><!-- l. 984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 987 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 989 --><p class='noindent'>We switch the modulus of the ciphertext from <!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi></mrow></math>
   to <!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   by using <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> as follows:
   </p><!-- l. 992 --><p class='noindent'><!-- l. 992 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 994 --><p class='noindent'><!-- l. 994 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 996 --><p class='noindent'>, which is (almost, considering the rounding error) equivalent to a ciphertext encrypting the
   following plaintext:
   </p><!-- l. 998 --><p class='noindent'><!-- l. 998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo>
                                                              </mrow><mrow><mi>q</mi>                                                     </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 1000 --><p class='noindent'><!-- l. 1000 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1002 --><p class='noindent'><!-- l. 1002 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>ğœ–</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   </p><!-- l. 1004 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 1004 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 1004 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ğœ–</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   is a rounding error caused by treating <!-- l. 1004 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi></mrow></math></span>
   </p><!-- l. 1008 --><p class='noindent'><!-- l. 1008 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1013 --><p class='noindent'>We exactly convert the base of the ciphertext from <!-- l. 1013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math>
   as follows:
   </p><!-- l. 1015 --><p class='noindent'><!-- l. 1015 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1017 --><p class='noindent'><!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1019 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 1022 --><p class='noindent'><!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>ğœ–</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1024 --><p class='noindent'><!-- l. 1024 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 1026 --><p class='noindent'>  <!-- l. 1026 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>t</mi><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>ğœ–</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>âŒ‹</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1029 --><p class='noindent'><!-- l. 1029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 1029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   all other terms are relatively much smaller than <!-- l. 1029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   in modulo <!-- l. 1029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 1031 --><p class='noindent'><!-- l. 1031 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Relinearization</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1037 --><p class='noindent'>Once we have derived the rescaled polynomial triple <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   the final relinearization step is equivalent to deriving the synthetic ciphertexts <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î±</mi></mrow></msub></math>
   and <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î²</mi></mrow></msub></math>
   and then computing <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î²</mi></mrow></msub></mrow></math>.
                                                                                         
                                                                                         
   <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î±</mi></mrow></msub></math>
   is simply <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and we can derive <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î²</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by using the <span class='rm-lmss-10x-x-109'>DecompMult</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation (SummaryÂ D-5.9 in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>Â§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>). The final ciphertext-to-ciphertext
   addition of <!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mi>Î²</mi></mrow></msub></mrow></math>
   can be performed by using regular RNS addition.
</p>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.5   </span>   <a id='x162-241000D-5.10.5'></a>CKKSâ€™s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1045 --><p class='noindent'>CKKSâ€™s ciphertext-to-ciphertext multiplication (SummaryÂ D-3.5.6 in <a href='CiphertexttoCiphertextMultiplication1.html#summary4'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.5.6<!-- tex4ht:ref: subsubsec:ckks-mult-cipher-summary  --></a>) is almost the same as BFVâ€™s, except
that CKKS does not need the <span class='rm-lmss-10x-x-109'>ModRaise </span>operation in the beginning (because each multiplicative levelâ€™s modulus
<!-- l. 1045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> is large enough to hold a
multiplied scaled plaintext <!-- l. 1045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>).
Therefore, CKKSâ€™s RNS-based multiplication is the same as BFVâ€™s except
that it does not require step 1 (<span class='rm-lmss-10x-x-109'>ModRaise</span>), step 3 (constant multiplication by
<!-- l. 1045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>),
and step 5 (exact fast base conversion). Since a CKKS ciphertextâ€™s scaling factor
<!-- l. 1045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Î”</mi></math> is
approximately the same as the prime modulus factor of each multiplicative level, each
ciphertext-to-ciphertext multiplication only needs to perform a modulus switch to a lower
level.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.6   </span>   <a id='x162-242000D-5.10.6'></a>BGVâ€™s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1053 --><p class='noindent'>BGVâ€™s ciphertext-to-ciphertext multiplication (SummaryÂ D-4.8 in <a href='CiphertexttoCiphertextMultiplication2.html#ciphertexttociphertext-multiplication2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-4.8<!-- tex4ht:ref: subsec:bgv-mult-cipher  --></a>) is
almost the same as CKKSâ€™s, except that BGV uses its own modulus switch
(<!-- l. 1053 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¬ğ—ˆğ–½ğ–²ğ—ğ—‚ğ—ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–­ğ–²</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¡ğ–¦ğ–µ</mtext></mstyle></mrow></msubsup></math> as
described in SummaryÂ D-4.7 in <a href='ModulusSwitch.html#modulus-switch1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-4.7<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>) during the rescaling step. Therefore, BGVâ€™s RNS-based
ciphertext-to-ciphertext multiplication is the same as CKKSâ€™s, except that <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is replaced by
<!-- l. 1053 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¬ğ—ˆğ–½ğ–²ğ—ğ—‚ğ—ğ–¼ğ—</mtext></mstyle></mrow><mrow>
<mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–­ğ–²</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¡ğ–¦ğ–µ</mtext></mstyle></mrow></msubsup></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-bootstrapping'><span class='titlemark'>D-5.10.7   </span>   <a id='x162-243000D-5.10.7'></a>BFVâ€™s Bootstrapping</h5>
<!-- l. 1059 --><p class='noindent'>BFVâ€™s original bootstrapping procedure (SummaryÂ D-2.11.6 in <a href='NoiseBootstrapping1.html#summary3'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.6<!-- tex4ht:ref: subsubsec:bfv-bootstrapping-summary  --></a>) is as follows: (1) modulus switch
from <!-- l. 1059 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>;
(2) homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (6) re-interpretation.
</p><!-- l. 1061 --><p class='indent'>   However, in RNS, we cannot mod-switch to <!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
because RNSâ€™s base moduli have to be co-prime to each other, whereas the factors of
                                                                                         
                                                                                         
<!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> are not. To
avoid this issue, RNS-based BFVâ€™s bootstrapping instead performs the following: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from
<!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>, where
<!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math> is an auxiliary base; (2)
coefficient multiplication by <!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from <!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>;
(4) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from <!-- l. 1061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math>;
(5) homomorphic decryption to adjust the scaling factor of the plaintext; (6) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (7)
<span class='rm-lmss-10x-x-109'>EvalExp</span>; (8) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (9) re-interpretation. The detailed procedure is described as
follows:
</p><!-- l. 1063 --><p class='indent'>   <!-- l. 1063 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1065 --><p class='indent'>   <span class='underline'><span class='rm-lmbx-10x-x-109'>Input</span></span><span class='rm-lmbx-10x-x-109'>: </span>The input BFV ciphertext to bootstrap is
<!-- l. 1065 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, which
would decrypt to:
</p><!-- l. 1067 --><p class='indent'>   <!-- l. 1067 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ¾ğ‘</mi></mrow></math> <span style='color:#FF0000;'>
<!-- l. 1067 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> where
<!-- l. 1067 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math></span>
</p><!-- l. 1069 --><p class='indent'>   <!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1072 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1075 --><p class='noindent'>Mod-raise ciphertext <!-- l. 1075 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   to <!-- l. 1075 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1077 --><p class='noindent'><!-- l. 1077 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ¾ğ‘</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ‘ˆğ‘</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1079 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 1079 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 1079 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ˆğ‘</mi></mrow></math>
   is the <span class='rm-lmss-10x-x-109'>FastBConv </span>+ <span class='rm-lmss-10x-x-109'>SmallMont </span>error, and <!-- l. 1079 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>U</mi></math>â€™s
   coefficients are either <!-- l. 1079 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math></span>
   </p><!-- l. 1081 --><p class='noindent'><!-- l. 1081 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 1083 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1085 --><p class='noindent'>Multiply the coefficients of <!-- l. 1085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   by <!-- l. 1085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   to update the ciphertext to <!-- l. 1085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1087 --><p class='noindent'><!-- l. 1087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi mathvariant='italic'>ğ¾ğ‘</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi mathvariant='italic'>ğ‘ˆğ‘</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1089 --><p class='noindent'><!-- l. 1089 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1093 --><p class='noindent'>Mod-switch the ciphertext <!-- l. 1093 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>ğ‘ğ‘</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   to <!-- l. 1093 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
                                                                                         
                                                                                         
   which would decrypt to:
   </p><!-- l. 1095 --><p class='noindent'><!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Î”</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>M</mi>
   </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi mathvariant='italic'>ğ¾ğ‘</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi mathvariant='italic'>ğ‘ˆğ‘</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ğœ–</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1097 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 1097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   <!-- l. 1097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ–</mi></math>
   is a small rounding error</span>
   </p><!-- l. 1099 --><p class='noindent'><!-- l. 1099 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ğœ–</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1101 --><p class='noindent'><!-- l. 1101 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1105 --><p class='noindent'>Exact fast base conversion of <!-- l. 1105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>Î±</mi></mrow></msub></mrow></math>
   to <!-- l. 1105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1107 --><p class='noindent'><!-- l. 1107 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ğœ–</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1109 --><p class='noindent'><!-- l. 1109 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1113 --><p class='noindent'>Now, we have the ciphertext <!-- l. 1113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ğœ–</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   We do homomorphic decryption by using the encrypted private key <!-- l. 1113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Î”</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 1113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Î”</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>.
   The output is <!-- l. 1113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Î”</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>ğœ–</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   </p><!-- l. 1115 --><p class='noindent'><!-- l. 1115 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>Perform <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit extraction, and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>. These operations can be performed by
   only regular RNS-based additions and multiplications. The final digit-extracted ciphertext is
   <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Î”</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
   where all noise values smaller than the (base-<!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
   digits are eliminated.
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-bootstrapping'><span class='titlemark'>D-5.10.8   </span>   <a id='x162-244000D-5.10.8'></a>CKKSâ€™s Bootstrapping</h5>
<!-- l. 1143 --><p class='noindent'>CKKSâ€™s original bootstrapping procedure (SummaryÂ D-3.13.7 in <a href='ModulusBootstrapping.html#summary5'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.7<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) <span class='rm-lmss-10x-x-109'>Modraise</span>; (2)
homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; (6) Re-interpretation. In the
RNS-based CKKS bootstrapping, we perform <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> at step 1, and all other steps are computed using
regular RNS-based addition and multiplication operations. Step 1â€™s <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation generates a
<!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> noise (where
<!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> using
<span class='rm-lmss-10x-x-109'>SmallMont</span>) for each polynomial coefficient during <span class='rm-lmss-10x-x-109'>FastBConv</span>. Therefore, step 2â€™s homomorphic decryption
outputs <!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>W</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>,
                                                                                         
                                                                                         
where <!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
represents the aggregation of all coefficient noise terms that are multiplied by the
<!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-overflow noises generated by
<span class='rm-lmss-10x-x-109'>FastBConv </span>and <span class='rm-lmss-10x-x-109'>SmallMont</span>. The <!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
term is eliminated by step 4â€™s <span class='rm-lmss-10x-x-109'>EvalExp</span>, which performs approximated modulo reduction based on a sine-graph evaluation
whose period is <!-- l. 1145 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-bootstrapping'><span class='titlemark'>D-5.10.9   </span>   <a id='x162-245000D-5.10.9'></a>BGVâ€™s Bootstrapping</h5>
<!-- l. 1153 --><p class='noindent'>BGVâ€™s original bootstrapping procedure (<a href='ModulusBootstrapping1.html#modulus-bootstrapping1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-4.11<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) modulus switch from
<!-- l. 1154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>; (2) ciphertext coefficient
multiplication by <!-- l. 1154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModRaise</span>; (4) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (5) digit extraction; (6) homomorphic multiplication by
<!-- l. 1154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msup></mrow></msub></mrow></math>; (7)
<span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; (8) noise term re-interpretation. Given this procedure, the RNS-based bootstrapping steps
are as follows.
</p><!-- l. 1156 --><p class='indent'>   <!-- l. 1156 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1159 --><p class='indent'>   Suppose the target BGV ciphertext to bootstrap is
<!-- l. 1159 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>, where the plaintext modulus
(i.e., noise scaling factor) is <!-- l. 1159 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
</p><!-- l. 1162 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¬ğ—ˆğ–½ğ–²ğ—ğ—‚ğ—ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–­ğ–²</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¡ğ–¦ğ–µ</mtext></mstyle></mrow></msubsup></math></span>
   from <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   where <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a special modulus satisfying the following requirements: <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a prime and is co-prime with <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>,
   and <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   <!-- l. 1166 --><p class='noindent'><!-- l. 1166 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant multiplication</span></span> by <!-- l. 1168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>
   to the coefficients of the ciphertext polynomials <!-- l. 1168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which increases the underlying plaintextâ€™s noise scaling factor <!-- l. 1168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Î”</mi></math>
   and the plaintext modulus from <!-- l. 1168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   This effectively updates the underlying plaintext to <!-- l. 1168 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi></mrow></math>.
   <!-- l. 1170 --><p class='noindent'><!-- l. 1170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> from <!-- l. 1172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   which generates additional noise <!-- l. 1172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></msub></mrow></math>
   (where <!-- l. 1172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   using <span class='rm-lmss-10x-x-109'>SmallMont</span>). At this point, the ciphertext is <!-- l. 1172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>K</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   whose underlying plaintext is:
                                                                                         
                                                                                         
   <!-- l. 1174 --><p class='noindent'><!-- l. 1174 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>K</mi></mrow></math>
   </p><!-- l. 1176 --><p class='noindent'><!-- l. 1176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 1176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   since <!-- l. 1176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math></span>
</p>
   </dd></dl>
<!-- l. 1180 --><p class='indent'>   <!-- l. 1180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1182 --><p class='indent'>   After the above steps, the remaining steps (i.e., <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, homomorphic multiplication by
<!-- l. 1182 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msup></mrow></msub></mrow></math>,
<span class='rm-lmss-10x-x-109'>SlotToCoeff</span>, and re-interpretation) can be performed using regular RNS-based addition and multiplication
operations.
   
</p>
   <h5 class='subsubsectionHead' id='noise-impact-of-rns-operations'><span class='titlemark'>D-5.10.10   </span>   <a id='x162-246000D-5.10.10'></a>Noise Impact of RNS Operations</h5>
<!-- l. 1188 --><p class='noindent'>When RNS techniques are used in FHE operations, the noise generated by <span class='rm-lmss-10x-x-109'>FastBConv</span>, <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>,
and <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is directly added to each coefficient of the ciphertext polynomials
<!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math> and
<!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>. Since the decryption relation
is <!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi></mrow></math>, even the noise added to the
coefficients of the polynomial <!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math>
is multiplied by a large factor due to the polynomial multiplication with
<!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Therefore, it is important to always ensure that the generated noise of each <span class='rm-lmss-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is reduced
by using it with <span class='rm-lmss-10x-x-109'>SmallMont</span>.
   
</p>
   <h5 class='subsubsectionHead' id='python-source-code-of-rns-primitives'><span class='titlemark'>D-5.10.11   </span>   <a id='x162-247000D-5.10.11'></a>Python Source Code of RNS Primitives</h5>
<!-- l. 1193 --><p class='noindent'>We provide a <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/rns.py'><span class='underline'>Python script</span></a> implementing the following exemplary RNS primitives: <span class='rm-lmss-10x-x-109'>FastBConv</span>,
<span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModDrop</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>SmallMont</span>, and <span class='rm-lmss-10x-x-109'>FastBConvEx</span>.
                                                                                         
                                                                                         
</p>
   <!-- l. 644 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>][<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>parent</a>]</p></div>
    
</body> 
</html>