<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Applying RNS Techniques to FHE Operations</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 859 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>][<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='applying-rns-techniques-to-fhe-operations'><span class='titlemark'>D-5.10   </span> <a id='x159-237000D-5.10'></a>Applying RNS Techniques to FHE Operations</h4>
<!-- l. 862 --><p class='noindent'>This subsection will explain how the RNS primitives we have learned so far are used to handle FHE
operations for RNS-based ciphertexts in BFV, CKKS, and BGV.
   
</p>
   <h5 class='subsubsectionHead' id='addition-and-multiplication-of-polynomials'><span class='titlemark'>D-5.10.1   </span> <a id='x159-238000D-5.10.1'></a>Addition and Multiplication of Polynomials</h5>
<!-- l. 868 --><p class='noindent'>In BFV, CKKS, and BGV, ciphertext-to-plaintext addition, ciphertext-to-ciphertext addition,
and ciphertext-to-plaintext multiplication are performed by only involving modulo additions
and multiplications among polynomial coefficients. Therefore, we can represent each
polynomial coefficient as an RNS residue vector and compute coefficient-wise additions and
multiplications by using RNS-based addition and multiplication of residues as explained in
Summary A-13.1 (<a href='ApplicationResidueNumberSystemRNS.html#application-residue-number-system-rns'><span class='ts1-lmr10-x-x-109'>§</span>A-13.1<!-- tex4ht:ref: subsec:crt-application  --></a>). For example, suppose we have the following two polynomials
<!-- l. 868 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> and
<!-- l. 868 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>:
</p><!-- l. 870 --><p class='indent'>   <!-- l. 870 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>a</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>a</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 872 --><p class='indent'>   <!-- l. 872 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>P</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>b</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>b</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
</p><!-- l. 874 --><p class='indent'>   <!-- l. 874 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 876 --><p class='indent'>   In the RNS-variant FHE schemes, we express each polynomial’s each coefficient as an RNS residue
vector as follows:
</p><!-- l. 878 --><p class='indent'>   <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span style='color:#FF0000;'> #
for <!-- l. 878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 880 --><p class='indent'>   <!-- l. 880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math> <span style='color:#FF0000;'> #
for <!-- l. 880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math></span>
</p><!-- l. 882 --><p class='indent'>   <!-- l. 882 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 884 --><p class='indent'>   Given the above RNS setup, when we add or multiply two polynomials, each coefficient-to-coefficient
addition is computed as element-wise additions of two RNS residue vectors as follows:
</p><!-- l. 886 --><p class='indent'>   <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span style='color:#FF0000;'> #
where <!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></mfrac></mstyle></mrow></math>,
<!-- l. 886 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 888 --><p class='indent'>   <!-- l. 888 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 890 --><p class='indent'>   <!-- l. 890 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 892 --><p class='indent'>   Similarly, each coefficient-to-coefficient multiplication is computed as element-wise multiplications of
two RNS residue vectors as follows:
</p><!-- l. 894 --><p class='indent'>   <!-- l. 894 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>k</mi></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><msub><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 896 --><p class='indent'>   <!-- l. 896 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⟺</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>c</mi></mrow><mrow><mi>a</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>c</mi></mrow><mrow><mi>b</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msub> <mo class='MathClass-bin' stretchy='false'>×</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>×</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>k</mi></mrow></msub></mrow></msub></mrow></math>
</p><!-- l. 898 --><p class='indent'>   <!-- l. 898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 900 --><p class='indent'>   Using the above isomorphism, we can efficiently compute ciphertext-to-plaintext addition,
ciphertext-to-ciphertext addition, and ciphertext-to-plaintext multiplication of big polynomial coefficients
(e.g., 1000 bits big) based on small RNS residues (e.g., 30 bits each).
   
</p>
   <h5 class='subsubsectionHead' id='key-switching'><span class='titlemark'>D-5.10.2   </span> <a id='x159-239000D-5.10.2'></a>Key Switching</h5>
<!-- l. 906 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertext’s key-switching operation from
<!-- l. 906 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math> is
performed by computing the following formula in RNS vectors:
</p><!-- l. 908 --><p class='indent'>   <!-- l. 908 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
</p><!-- l. 911 --><p class='indent'>   <!-- l. 911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 913 --><p class='indent'>   In the above formula, the computation of <!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
can be performed by using <!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉𝖬𝗎𝗅𝗍<msub><mrow></mrow><mrow><mtext>𝖱𝖭𝖲</mtext></mrow></msub></mtext></mstyle></math>
(Summary D-5.9 in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>), after which <!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>
can be added to it by using regular RNS-based addition.
</p><!-- l. 915 --><p class='indent'>   <!-- l. 915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 917 --><p class='indent'>   Similarly, in the case of the BGV, an RNS-based key-switching operation on a ciphertext from
<!-- l. 917 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math> is
performed by computing the following in RNS vectors:
</p><!-- l. 919 --><p class='indent'>   <!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><msup><mrow><mi>S</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math>
   
</p>
   <h5 class='subsubsectionHead' id='input-slot-rotation'><span class='titlemark'>D-5.10.3   </span> <a id='x159-240000D-5.10.3'></a>Input Slot Rotation</h5>
<!-- l. 925 --><p class='noindent'>In BFV or CKKS, an RNS-based ciphertext’s input slot rotation is performed by computing the following
formulas in RNS vectors:
</p><!-- l. 927 --><p class='indent'>   <!-- l. 927 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 930 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 930 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 930 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span style='color:#FF0000;'> # where <!-- l. 930 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 935 --><p class='indent'>   <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 937 --><p class='indent'>   Step 1 is equivalent to re-positioning the coefficients within each polynomial and flipping their signs whenever they cross
the boundary of the <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
degree term. This step can be done with RNS-based coefficients by moving around each set of RNS
residue vectors as a whole whenever the coefficient they represent is re-positioned to a new degree term,
and flipping the signs of the residues in the same RNS vector altogether whenever their representing
coefficient’s sign is to be flipped. Step 2’s RNS-based key switching can be done in the same way as
                                                                                         
                                                                                         
explained in the previous subsection (<a href='#key-switching'><span class='ts1-lmr10-x-x-109'>§</span>D-5.10.2<!-- tex4ht:ref: subsec:rns-decompmult  --></a>).
</p><!-- l. 939 --><p class='indent'>   <!-- l. 939 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 941 --><p class='indent'>   Similarly, in BGV, an RNS-based ciphertext’s input slot rotation is performed by computing the
following formulas in RNS vectors:
</p><!-- l. 943 --><p class='indent'>   <!-- l. 943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 946 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><!-- l. 946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span style='color:#FF0000;'> # where <!-- l. 946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Key-switch <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   to <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></dd></dl>
<!-- l. 951 --><p class='indent'>   <!-- l. 951 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 953 --><p class='indent'>   We can compute the above formulas in RNS by using the same strategy explained for BFV or
CKKS.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.4   </span> <a id='x159-241000D-5.10.4'></a>BFV’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 961 --><p class='noindent'>BFV’s ciphertext-to-ciphertext multiplication (Summary D-2.7.5 in <a href='CiphertexttoCiphertextMultiplication.html#summary1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.7.5<!-- tex4ht:ref: subsubsec:bfv-mult-cipher-summary  --></a>) comprises <span class='rm-lmss-10x-x-109'>ModRaise</span>
<!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math> polynomial
multiplication <!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math>
relinearization <!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math>
rescaling, where the order of relinearization and rescaling can be swapped. In RNS-based ciphertext-to-ciphertext
multiplication, we will swap the order of these two steps. The procedure is as follows: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>
from <!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>;
(2) polynomial multiplication; (3) constant multiplication by
<!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>; (4) <span class='rm-lmss-10x-x-109'>ModSwitch </span>from
<!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi></mrow></math>; (5) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from
<!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>; and (6) relinearization.
Among these, step <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>∼</mo><mn>5</mn></mrow></math>
corresponds to the rescaling operation. We will explain how each of these steps works.
</p><!-- l. 964 --><p class='indent'>   <!-- l. 964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 967 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 970 --><p class='noindent'>Let <!-- l. 970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   be a new RNS base where <!-- l. 970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi mathvariant='normal'>Δ</mi></mrow></math>
   so that <!-- l. 970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>
   is large enough to prevent a multiplied scaled plaintext in ciphertexts (i.e., <!-- l. 970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>)
   from exceeding its allowed limit (Summary D-2.3 in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a>) during ciphertext-to-ciphertext
   multiplication. <!-- l. 970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></math>
   is also added for exact fast base conversion to be performed later. Specifically, we mod-raise the
                                                                                         
                                                                                         
   modulus of each polynomial coefficient of ciphertexts <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   </p><!-- l. 987 --><p class='noindent'><!-- l. 987 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 989 --><p class='noindent'><!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 991 --><p class='noindent'><!-- l. 991 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 993 --><p class='noindent'>, where each coefficient of <!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></mrow></math>
   is either <!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Decrypting these two (noisy) ciphertexts with the private key <!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   would give the following outputs:
   </p><!-- l. 995 --><p class='noindent'><!-- l. 995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 997 --><p class='noindent'><!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 999 --><p class='noindent'><!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1001 --><p class='noindent'><!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   <span style='color:#FF0000;'> # where <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi></mrow></math>
   is the <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>-overflows
   of the decryption process</span>
   </p><!-- l. 1003 --><p class='noindent'><!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1005 --><p class='noindent'><!-- l. 1005 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1007 --><p class='noindent'><!-- l. 1007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1009 --><p class='noindent'><!-- l. 1009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1011 --><p class='noindent'><!-- l. 1011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1014 --><p class='noindent'><!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Polynomial Multiplication:</span></span>
   <!-- l. 1018 --><p class='noindent'>Compute <!-- l. 1018 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   whose decryption relation is as follows:
   </p><!-- l. 1020 --><p class='noindent'><!-- l. 1020 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1022 --><p class='noindent'><!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1024 --><p class='noindent'><!-- l. 1024 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1026 --><p class='noindent'><!-- l. 1026 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 1028 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐭</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1030 --><p class='noindent'>Step <!-- l. 1030 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>∼</mo><mn>5</mn></mrow></math>
   are equivalent to rescaling the plaintext’s scaling factor from <!-- l. 1030 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='normal'>Δ</mi></mrow></math>
   as well as switching the ciphertext’s modulus from <!-- l. 1030 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1030 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   In this step, we multiply <!-- l. 1031 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
   to each coefficient of the resulting polynomials from the previous step as follows:
   </p><!-- l. 1033 --><p class='noindent'><!-- l. 1033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1035 --><p class='noindent'><!-- l. 1035 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1037 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 1039 --><p class='noindent'><!-- l. 1039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1041 --><p class='noindent'><!-- l. 1041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
                                                                                         
                                                                                         
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1057 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1059 --><p class='noindent'>We switch the modulus of the ciphertext from <!-- l. 1059 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi></mrow></math>
   to <!-- l. 1059 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   by using <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> as follows:
   </p><!-- l. 1069 --><p class='noindent'><!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1071 --><p class='noindent'><!-- l. 1071 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1073 --><p class='noindent'>, which is (almost, considering the rounding error) equivalent to a ciphertext encrypting the
   following plaintext:
   </p><!-- l. 1075 --><p class='noindent'><!-- l. 1075 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo>
                                                              </mrow><mrow><mi>q</mi>                                                     </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1077 --><p class='noindent'><!-- l. 1077 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1079 --><p class='noindent'><!-- l. 1079 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   </p><!-- l. 1081 --><p class='noindent'><span style='color:#FF0000;'> # where <!-- l. 1081 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   is a rounding error caused by treating <!-- l. 1081 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≈</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi></mrow></math></span>
   </p><!-- l. 1085 --><p class='noindent'><!-- l. 1085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1110 --><p class='noindent'>We exactly convert the base of the ciphertext from <!-- l. 1110 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>
   as follows:
   </p><!-- l. 1112 --><p class='noindent'><!-- l. 1112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
             </mrow><mrow><mi>q</mi>               </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup>
      </mrow><mrow><mi>q</mi>       </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1114 --><p class='noindent'><!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1116 --><p class='noindent'>, which is equivalent to a ciphertext encrypting the following plaintext:
   </p><!-- l. 1119 --><p class='noindent'><!-- l. 1119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1121 --><p class='noindent'><!-- l. 1121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mi>q</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   </p><!-- l. 1123 --><p class='noindent'>  <!-- l. 1123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>t</mi><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>d</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi>U</mi></mrow><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mi>q</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>
   </p><!-- l. 1126 --><p class='noindent'><!-- l. 1126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> # all other terms are relatively much smaller than <!-- l. 1126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
   in modulo <!-- l. 1126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math></span>
   </p><!-- l. 1128 --><p class='noindent'><!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Relinearization</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1155 --><p class='noindent'>Once we have derived the rescaled polynomial triple <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   the final relinearization step is equivalent to deriving the synthetic ciphertexts <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub></math>
   and <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></math>
   and then computing <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></mrow></math>.
   <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub></math>
   is simply <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>D</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and we can derive <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>D</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>S</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   by using the <span class='rm-lmss-10x-x-109'>DecompMult</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation (Summary D-5.9 in <a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html#decomposing-multiplication-decompmult-rns'><span class='ts1-lmr10-x-x-109'>§</span>D-5.9<!-- tex4ht:ref: subsec:rns-decompmult  --></a>). The final ciphertext-to-ciphertext
   addition of <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mi>β</mi></mrow></msub></mrow></math>
   can be performed by using regular RNS addition.
</p>
                                                                                         
                                                                                         
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.5   </span> <a id='x159-242000D-5.10.5'></a>CKKS’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1163 --><p class='noindent'>CKKS’s ciphertext-to-ciphertext multiplication (Summary D-3.5.6 in <a href='HomomorphicCiphertexttoCiphertextMultiplication1.html#summary4'><span class='ts1-lmr10-x-x-109'>§</span>D-3.5.6<!-- tex4ht:ref: subsubsec:ckks-mult-cipher-summary  --></a>) is almost the same as BFV’s, except
that CKKS does not need the <span class='rm-lmss-10x-x-109'>ModRaise </span>operation in the beginning (because each multiplicative level’s modulus
<!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> is large enough to hold a
multiplied scaled plaintext <!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><msup><mrow><mi>M</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>).
Therefore, CKKS’s RNS-based multiplication is the same as BFV’s except
that it does not require step 1 (<span class='rm-lmss-10x-x-109'>ModRaise</span>), step 3 (constant multiplication by
<!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>),
and step 5 (exact fast base conversion). Since a CKKS ciphertext’s scaling factor
<!-- l. 1163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math> is
approximately the same as the prime modulus factor of each multiplicative level, each
ciphertext-to-ciphertext multiplication only needs to perform a modulus switch to a lower
level.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-ciphertexttociphertext-multiplication'><span class='titlemark'>D-5.10.6   </span> <a id='x159-243000D-5.10.6'></a>BGV’s Ciphertext-to-Ciphertext Multiplication</h5>
<!-- l. 1171 --><p class='noindent'>BGV’s ciphertext-to-ciphertext multiplication (Summary D-4.8 in <a href='CiphertexttoCiphertextMultiplication1.html#ciphertexttociphertext-multiplication1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.8<!-- tex4ht:ref: subsec:bgv-mult-cipher  --></a>) is
almost the same as CKKS’s, except that BGV uses its own modulus switch
(<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math> as
described in Summary D-4.7 in <a href='ModulusSwitch.html#modulus-switch1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.7<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>) during the rescaling step. Therefore, BGV’s RNS-based
ciphertext-to-ciphertext multiplication is the same as CKKS’s, except that <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is replaced by
<!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow>
<mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bfvs-bootstrapping'><span class='titlemark'>D-5.10.7   </span> <a id='x159-244000D-5.10.7'></a>BFV’s Bootstrapping</h5>
<!-- l. 1177 --><p class='noindent'>BFV’s original bootstrapping procedure (Summary D-2.11.7 in <a href='NoiseBootstrapping1.html#summary3'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.7<!-- tex4ht:ref: subsubsec:bfv-bootstrapping-summary  --></a>) is as follows: (1) modulus switch
from <!-- l. 1177 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>;
(2) homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (6) re-interpretation.
</p><!-- l. 1179 --><p class='indent'>   However, in RNS, we cannot mod-switch to <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
because RNS’s base moduli have to be co-prime to each other, whereas the factors of
<!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> are not. To
avoid this issue, RNS-based BFV’s bootstrapping instead performs the following: (1) <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from
<!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>, where
<!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math> is an auxiliary base; (2)
coefficient multiplication by <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> from <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>;
(4) <span class='rm-lmss-10x-x-109'>FastBConvEx </span>from <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math>;
                                                                                         
                                                                                         
(5) homomorphic decryption to adjust the scaling factor of the plaintext; (6) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (7)
<span class='rm-lmss-10x-x-109'>EvalExp</span>; (8) <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>; and (9) re-interpretation. The detailed procedure is described as
follows:
</p><!-- l. 1181 --><p class='indent'>   <!-- l. 1181 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1183 --><p class='indent'>   <span class='underline'><span class='rm-lmbx-10x-x-109'>Input</span></span><span class='rm-lmbx-10x-x-109'>: </span>The input BFV ciphertext to bootstrap is
<!-- l. 1183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, which
would decrypt to:
</p><!-- l. 1185 --><p class='indent'>   <!-- l. 1185 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝐾𝑞</mi></mrow></math> <span style='color:#FF0000;'> #
where <!-- l. 1185 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math></span>
</p><!-- l. 1187 --><p class='indent'>   <!-- l. 1187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1190 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1191 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1193 --><p class='noindent'>Mod-raise ciphertext <!-- l. 1193 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   to <!-- l. 1193 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1195 --><p class='noindent'><!-- l. 1195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝐾𝑞</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>𝑈𝑞</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1197 --><p class='noindent'><span style='color:#FF0000;'> # where <!-- l. 1197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑈𝑞</mi></mrow></math>
   is the <span class='rm-lmss-10x-x-109'>FastBConv </span>+ <span class='rm-lmss-10x-x-109'>SmallMont </span>error, and <!-- l. 1197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>U</mi></math>’s
   coefficients are either <!-- l. 1197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math></span>
   </p><!-- l. 1199 --><p class='noindent'><!-- l. 1199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Multiplication</span></span> <span class='rm-lmbx-10x-x-109'>by </span><!-- l. 1201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1203 --><p class='noindent'>Multiply the coefficients of <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   by <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   to update the ciphertext to <!-- l. 1203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑝𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1205 --><p class='noindent'><!-- l. 1205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝐾𝑞</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝑈𝑞</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1207 --><p class='noindent'><!-- l. 1207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModSwitch</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1209 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='italic'>𝑞𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1211 --><p class='noindent'>Mod-switch the ciphertext <!-- l. 1211 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi mathvariant='italic'>𝑝𝑏</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1211 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1213 --><p class='noindent'><!-- l. 1213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi>
 </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>M</mi>
   </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝐾𝑞</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi mathvariant='italic'>𝑈𝑞</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1215 --><p class='noindent'><span style='color:#FF0000;'> # <!-- l. 1215 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜖</mi></math>
   is a small rounding error</span>
   </p><!-- l. 1217 --><p class='noindent'><!-- l. 1217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1219 --><p class='noindent'><!-- l. 1219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
                                                                                         
                                                                                         
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>FastBConvEx</span></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 1221 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>q</mi></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1223 --><p class='noindent'>Exact fast base conversion of <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>b</mi><msub><mrow><mi>b</mi></mrow><mrow><mi>α</mi></mrow></msub></mrow></math>
   to <!-- l. 1223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   which would decrypt to:
   </p><!-- l. 1225 --><p class='noindent'><!-- l. 1225 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1227 --><p class='noindent'><!-- l. 1227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 1231 --><p class='noindent'>Now, we have the ciphertext <!-- l. 1231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   We do homomorphic decryption by using the encrypted private key <!-- l. 1231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 1231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math>.
   The output is <!-- l. 1231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi>
  </mrow><mrow><mi>q</mi>  </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>U</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>𝜖</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
   </p><!-- l. 1233 --><p class='noindent'><!-- l. 1233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>Perform <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit extraction, and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>. These operations can be performed by
   only regular RNS-based additions and multiplications. The final digit-extracted ciphertext is
   <!-- l. 1235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
   where all noise values smaller than the (base-<!-- l. 1235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 1235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
   digits are eliminated.
   <!-- l. 1237 --><p class='noindent'><!-- l. 1237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation:</span></span>
   <!-- l. 1241 --><p class='noindent'>Theoretically re-interpret the ciphertext without any additional mathematical computation. The
   ciphertext <!-- l. 1241 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   is mathematically the same as:
   </p><!-- l. 1243 --><p class='noindent'><!-- l. 1243 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1245 --><p class='noindent'><!-- l. 1245 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>U</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>q</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   <span style='color:#FF0000;'> # since <!-- l. 1245 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>,
   and <!-- l. 1245 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>a</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math></span>
   </p><!-- l. 1247 --><p class='noindent'><!-- l. 1247 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>.
</p>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='ckkss-bootstrapping'><span class='titlemark'>D-5.10.8   </span> <a id='x159-245000D-5.10.8'></a>CKKS’s Bootstrapping</h5>
<!-- l. 1279 --><p class='noindent'>CKKS’s original bootstrapping procedure (Summary D-3.13.7 in <a href='ModulusBootstrapping.html#summary5'><span class='ts1-lmr10-x-x-109'>§</span>D-3.13.7<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) <span class='rm-lmss-10x-x-109'>Modraise</span>; (2)
homomorphic decryption; (3) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (4) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (5) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (6) Re-interpretation. In the
RNS-based CKKS bootstrapping, we perform <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> at step 1, and all other steps are computed by
using regular RNS-based addition and multiplication operations. Step 1’s <span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> operation generates a
                                                                                         
                                                                                         
<!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> noise (where
<!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> using
<span class='rm-lmss-10x-x-109'>SmallMont</span>) for each polynomial coefficient during <span class='rm-lmss-10x-x-109'>FastBConv</span>. Therefore, step 2’s homomorphic decryption
outputs <!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>,
where <!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
represents the aggregation of all coefficient noise terms which are multiplied with the
<!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-overflow noises generated by
<span class='rm-lmss-10x-x-109'>FastBConv </span>and <span class='rm-lmss-10x-x-109'>SmallMont</span>. The <!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
term gets eliminated by step 4’s <span class='rm-lmss-10x-x-109'>EvalExp </span>which performs approximated modulo reduction based on a sine-graph evaluation
whose period is <!-- l. 1281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
   
</p>
   <h5 class='subsubsectionHead' id='bgvs-bootstrapping'><span class='titlemark'>D-5.10.9   </span> <a id='x159-246000D-5.10.9'></a>BGV’s Bootstrapping</h5>
<!-- l. 1289 --><p class='noindent'>BGV’s original bootstrapping procedure (<a href='ModulusBootstrapping1.html#modulus-bootstrapping1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.11<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>) is as follows: (1) modulus switch from
<!-- l. 1290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>; (2) ciphertext coefficient
multiplication by <!-- l. 1290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>;
(3) <span class='rm-lmss-10x-x-109'>ModRaise</span>; (4) <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>; (5) <span class='rm-lmss-10x-x-109'>EvalExp</span>; (6) homomorphic multiplication by
<!-- l. 1290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></mrow></math>; (7)
<span class='rm-lmss-10x-x-109'>SlottToCoeff</span>; (8) noise term re-interpretation. Given this procedure, the RNS-based bootstrapping steps
are as follows:
</p><!-- l. 1292 --><p class='indent'>   <!-- l. 1292 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1383 --><p class='indent'>   Suppose the target BGV ciphertext to bootstrap is
<!-- l. 1383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>, where the plaintext modulus
(i.e., noise scaling factor) is <!-- l. 1383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
</p><!-- l. 1386 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖬𝗈𝖽𝖲𝗐𝗂𝗍𝖼𝗁</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖭𝖲</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖡𝖦𝖵</mtext></mstyle></mrow></msubsup></math></span> from
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> where
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a special modulus satisfying the following requirements:
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>,
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> and
   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> are co-prime,
   and <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   <!-- l. 1393 --><p class='noindent'><!-- l. 1393 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Constant multiplication</span></span> by <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
   to the coefficients of the ciphertext polynomials
   <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which increases the underlying plaintext’s noise scaling factor
   <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math> and the plaintext modulus
   from <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. This effectively updates
                                                                                         
                                                                                         
   the underlying plaintext to <!-- l. 1395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi></mrow></math>.
   <!-- l. 1397 --><p class='noindent'><!-- l. 1397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span><sub><span class='rm-lmssbx-10x-x-109'>RNS</span></sub></span> from <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>, which
   generates an additional noise <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>u</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></msub></mrow></math>
   (where <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>u</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>using <span class='rm-lmss-10x-x-109'>SmallMont</span>). At
   this point, the ciphertext is <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>K</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   whose underlying plaintext is:
   <!-- l. 1401 --><p class='noindent'><!-- l. 1401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>K</mi></mrow></math>
   </p><!-- l. 1403 --><p class='noindent'><!-- l. 1403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> <span style='color:#FF0000;'># since
   <!-- l. 1403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math></span>
</p>
   </dd></dl>
<!-- l. 1407 --><p class='indent'>   <!-- l. 1407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1409 --><p class='indent'>   After the above steps, the remaining steps (i.e., <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, homomorphic multiplication by
<!-- l. 1409 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></mrow></math>,
<span class='rm-lmss-10x-x-109'>SlotToCoeff</span>, and re-interpretation) can be performed by regular RNS-based addition and multiplication
operations.
   
</p>
   <h5 class='subsubsectionHead' id='noise-impact-of-rns-operations'><span class='titlemark'>D-5.10.10   </span> <a id='x159-247000D-5.10.10'></a>Noise Impact of RNS Operations</h5>
<!-- l. 1415 --><p class='noindent'>When RNS techniques are used in FHE operations, the noise generated by <span class='rm-lmss-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>,
<span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, and <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> is directly added to each coefficient of the ciphertext polynomials
<!-- l. 1415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math> and
<!-- l. 1415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>. Since the decryption relation
is <!-- l. 1415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi></mrow></math>, even the noise added to the
coefficients of the polynomial <!-- l. 1415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math>
gets multiplied by a large factor due to the polynomial multiplication with
<!-- l. 1415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Therefore, it is important to always ensure to reduce the generated noise of each <span class='rm-lmss-10x-x-109'>FastBConvEx</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub> by
using it with <span class='rm-lmss-10x-x-109'>SmallMont</span>.
   
</p>
   <h5 class='subsubsectionHead' id='python-source-code-of-rns-primitives'><span class='titlemark'>D-5.10.11   </span> <a id='x159-248000D-5.10.11'></a>Python Source Code of RNS Primitives</h5>
<!-- l. 1420 --><p class='noindent'>We provide a <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/rns.py'><span class='underline'>Python script</span></a> implementing the following exemplary RNS primitives: <span class='rm-lmss-10x-x-109'>FastBConv</span>,
<span class='rm-lmss-10x-x-109'>ModRaise</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModDrop</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>ModSwitch</span><sub><span class='rm-lmss-10x-x-109'>RNS</span></sub>, <span class='rm-lmss-10x-x-109'>SmallMont</span>, and <span class='rm-lmss-10x-x-109'>BaseBConvEx</span>.
                                                                                         
                                                                                         
</p>
   <!-- l. 641 --><div class='crosslinks'><p class='noindent'>[<a href='DecomposingMultiplicationtextsfDecompMulttextsubscriptRNS.html'>prev</a>][<a href='RNSvariantFHESchemes.html#ApplyingRNSTechniquestoFHEOperations.html'>parent</a>]</p></div>
    
</body> 
</html>