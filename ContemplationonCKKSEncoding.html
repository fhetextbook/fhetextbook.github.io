<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Contemplation on CKKS Encoding</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!--  l. 1308  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots1.html'>prev</a>][<a href='CKKSScheme.html#ContemplationonCKKSEncoding.html'>parent</a>][<a href='HomomorphicConjugation.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='contemplation-on-ckks-encoding'><span class='titlemark'>D-3.10   </span> <a id='x133-193000D-3.10'></a>Contemplation on CKKS Encoding</h4>
<!--  l. 1311  --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Why CKKSâ€™s Encoding Uses the </span><!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğ›</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>ğ§</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Cyclotomic Polynomial: </span>At this point, it becomes clear why the CKKS
encoding and decoding scheme uses the (power-of-2)-th cyclotomic polynomial (i.e.,
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>) over
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„‚</mi></mrow></math>
(complex numbers) (<a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!--  tex4ht:ref: subsec:ckks-rotation   --></a>). The first reason is that CKKSâ€™s first requirement for designing a valid
encoding and decoding formula for an input complex vector is to isomorphically convert it into a unique
real number vector (and we scale this real number vector as an integer vector and use it as a list of
coefficients for polynomial encoding, because CKKSâ€™s homomorphic encryption and decryption are
supported only based on polynomials with integer coefficients). As for the decoding formula of an input
complex vector, our high-level idea was to treat the encoded real number vector as coefficients of an
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial and
evaluate this polynomial at <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
distinct <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math> coordinates, whose
resulting set of <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Y</mi> </mrow></math> values is guaranteed to
be unique within the <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
degree polynomial ring. Based on this insight, we designed a decoding matrix (<a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!--  tex4ht:ref: subsec:ckks-rotation   --></a>) in
the form of a Vandermonde matrix (<a href='VariousTypesofMatrix.html#various-types-of-matrix'><span class='ts1-lmr10-x-x-109'>Â§</span>A-10.2<!--  tex4ht:ref: subsec:ckks-rotation   --></a>). Then, the encoding formula is equivalent to
multiplying the input complex vector by an inverse of this decoding matrix. However,
in linear algebra, not all matrices are guaranteed to have a counterpart inverse matrix.
Therefore, for the guarantee of the existence of a valid encoding matrix (i.e., an inverse of the
decoding matrix), we leveraged the following arithmetic property: if a Vandermonde matrix
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='italic'><mi>ğ‘‰ğ‘ğ‘›ğ‘‘ğ‘’ğ‘Ÿ</mi></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is made of
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct primitive
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of unity
(where <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> is a
power of 2), then such a Vandermonde matrix is guaranteed to have an inverse (<a href='VandermondeMatrixwithRootsofCyclotomicPolynomialoverComplexNumbers.html#vandermonde-matrix-with-roots-of-cyclotomic-polynomial-over-complex-numbers'><span class='ts1-lmr10-x-x-109'>Â§</span>A-11.4<!--  tex4ht:ref: subsec:ckks-rotation   --></a>) counterpart. In fact, the
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of unity are
<!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct roots of
the <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomial: <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> (<a href='Definitions4.html#definitions4'><span class='ts1-lmr10-x-x-109'>Â§</span>A-8.1<!--  tex4ht:ref: subsec:ckks-rotation   --></a>).
Therefore, CKKS uses <!--  l. 1311  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
as the polynomial ring of its subsequent encryption and decryption scheme (<a href='EncryptionandDecryption2.html#encryption-and-decryption2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.2<!--  tex4ht:ref: subsec:ckks-rotation   --></a>) as well.
</p><!--  l. 1313  --><p class='indent'>   The CKKS encodingâ€™s second reason for using the
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomialis to design a valid input vector slot rotation scheme (<a href='HomomorphicRotationofInputVectorSlots1.html#homomorphic-rotation-of-input-vector-slots1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.9<!--  tex4ht:ref: subsec:ckks-rotation   --></a>). In this rotation scheme, updating the encoded
                                                                                         
                                                                                         
polynomial <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(where <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>)
is equivalent to updating the CKKS decoding processâ€™s each evaluation coordinate of
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> from
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub></math> to
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msubsup></math> (where
each <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>x</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is the
primitive <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity), which gives the same effect as vertically rotating the encoding
matrix (i.e., inverse of the Vandermonde matrix whose roots are the primitive
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of unity)
upward by <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math> positions.
And this vertical rotation of the encoding matrix (while the input vector is fixed) gives the same effect of rotating
the input vector <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></math>
by <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (without modifying the encoding matrix). Therefore, the
<!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomial <!--  l. 1313  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
is an ideal tool to design input vector slot rotation.
                                                                                         
                                                                                         
</p>
   <!--  l. 1316  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots1.html'>prev</a>][<a href='CKKSScheme.html#ContemplationonCKKSEncoding.html'>parent</a>][<a href='HomomorphicConjugation.html'>next</a>]</p></div>
    
</body> 
</html>