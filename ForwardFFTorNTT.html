<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Forward FFT (or NTT)</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 35 --><div class='crosslinks'><p class='noindent'>[<a href='BackgroundandMotivation.html'>prev</a>][<a href='EfficientPolynomialMultiplicationbyFFTandNTT.html#ForwardFFTorNTT.html'>parent</a>][<a href='PointwiseMultiplication.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='forward-fft-or-ntt'><span class='titlemark'>A-16.2   </span> <a id='x56-69000A-16.2'></a>Forward FFT (or NTT)</h4>
<!-- l. 38 --><p class='noindent'>We assume a polynomial ring of either <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
for FTT, and <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℤ</mi><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mi>p</mi></mrow></msub><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> for NTT (where
<!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> is a cyclotomic polynomial).
The <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> coordinates to evaluate
the target polynomial are <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
distinct <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th roots of
unity that satisfy <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
which are: <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ω</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>. In the
case of FFT (i.e., <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>),
the primitive <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th root
of unity is <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
 <mrow><mi>n</mi></mrow></mfrac>  </mrow></msup></mrow></math>. In the
case of NTT (i.e., <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
where <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> is a prime),
the primitive <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
root of unity <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>g</mi></mrow><mrow><mfrac><mrow><mi>p</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow>
  <mrow><mi>n</mi></mrow></mfrac>  </mrow></msup></mrow></math>,
where <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>g</mi></math> is the
generator of <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>×</mo></mrow></msubsup></math>
and <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
divides <!-- l. 38 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
(a variation of Summary A-10.5 in <a href='BasisofaPolynomialRing.html#basis-of-a-polynomial-ring'><span class='ts1-lmr10-x-x-109'>§</span>A-10.5<!-- tex4ht:ref: subsec:polynomial-ring-basis  --></a>).
</p><!-- l. 40 --><p class='indent'>   Then, the point-value representation of polynomial
<!-- l. 40 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is
<!-- l. 40 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
where:
</p><!-- l. 42 --><p class='indent'>   <!-- l. 42 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>y</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>i</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>i</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi mathvariant='italic'>𝑖𝑗</mi></mrow></msup></mrow></math>.
</p><!-- l. 44 --><p class='indent'>   We call the vector <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>y</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>0</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>y</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
the Discrete Fourier Transform (DFT) of the coefficient vector
<!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. We write this as
<!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>y</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖥𝖳</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. As explained in <a href='BackgroundandMotivation.html#background-and-motivation'><span class='ts1-lmr10-x-x-109'>§</span>A-16.1<!-- tex4ht:ref: subsec:polynomial-ring-basis  --></a>, the
computation of DFT takes <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
because we have to evaluate <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
distinct <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math> values for a
polynomial which has <!-- l. 44 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
terms.
   
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='highlevel-idea'><span class='titlemark'>A-16.2.1   </span> <a id='x56-70000A-16.2.1'></a>High-level Idea</h5>
<!-- l. 49 --><p class='noindent'>FFT (or NTT) is an improved way of computing DFT which reduces the time complexity from
<!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. The high-level idea of FFT is to
split the <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree (or lesser degree)
target polynomial <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to evaluate
into 2 half-degree polynomials <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
and <!-- l. 49 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as
follows:
</p><!-- l. 52 --><p class='indent'>   <!-- l. 52 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 54 --><p class='indent'>   <!-- l. 54 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FFFFFF;'><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
<!-- l. 55 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 57 --><p class='indent'>   <!-- l. 57 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>1</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 59 --><p class='indent'>   The above way of splitting a polynomial into two half-degree polynomials is called the Cooley-Tukey step. As we split
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> into two smaller-degree
polynomials <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
and <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
evaluating <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
at <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th roots of unity
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> is equivalent
to evaluating <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
and <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct <span class='rm-lmri-10x-x-109'>squared</span>
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th roots of unity
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> and computing
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. However, remember
that the primitive <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
root of unity <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>
has order <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
(i.e., <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math> and
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>m</mi></mrow></msup><mo class='MathClass-rel' stretchy='false'>≠</mo><mn>1</mn></mrow></math> for all
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>n</mi></mrow></math>). Therefore, the
second half of <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
is a repetition of the first half. This implies that we only need to evaluate
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> distinct
<!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> coordinates each
instead of <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
coordinates, because the polynomial evaluation results for the other half are the same as those of the first half (as
their input <!-- l. 59 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
to the polynomial is the same).
</p><!-- l. 61 --><p class='indent'>   We recursively split <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
and <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
into half-degree polynomials and evaluate them at half-counted
<!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th roots of unity. Then, the
total rounds of splitting are <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi></mrow></math>,
and each round’s maximum number of root-to-coefficient multiplications is
<!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>, which
aggregates to <!-- l. 61 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   
</p>
   <h5 class='subsubsectionHead' id='details'><span class='titlemark'>A-16.2.2   </span> <a id='x56-71000A-16.2.2'></a>Details</h5>
<!-- l. 66 --><p class='noindent'>Suppose we have a polynomial ring which is either
<!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> (i.e., over a finite
field with prime <!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>) or
<!-- l. 66 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> (over complex numbers).
We denote the primitive <!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity as <!-- l. 68 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>,
and the <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
<!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of
unity are: <!-- l. 71 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
</p><!-- l. 74 --><p class='indent'>   <!-- l. 74 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 76 --><p class='indent'>   Now, we define our target polynomial to evaluate as follows:
</p><!-- l. 78 --><p class='indent'>   <!-- l. 78 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math>
</p><!-- l. 80 --><p class='indent'>   <!-- l. 80 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 82 --><p class='indent'>   We split this 7-degree polynomial into the following two 3-degree polynomials (using the Cooley-Tukey
step):
</p><!-- l. 84 --><p class='indent'>   <!-- l. 84 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow></math>
</p><!-- l. 86 --><p class='indent'>   <!-- l. 86 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow></math>
</p><!-- l. 88 --><p class='indent'>   <!-- l. 88 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 90 --><p class='indent'>   <!-- l. 90 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 92 --><p class='indent'>   We recursively split the above two 3-degree polynomials into 1-degree polynomials as follows:
</p><!-- l. 95 --><p class='indent'>   <!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><mi>X</mi></mrow></math>, <span style='color:#FFFFFF;'>...</span>
<!-- l. 95 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><mi>X</mi></mrow></math>
</p><!-- l. 97 --><p class='indent'>   <!-- l. 97 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 99 --><p class='indent'>   <!-- l. 99 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 101 --><p class='indent'>   <!-- l. 101 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi></mrow></math>, <span style='color:#FFFFFF;'>...</span>
<!-- l. 101 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><mi>X</mi></mrow></math>
</p><!-- l. 103 --><p class='indent'>   <!-- l. 103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 105 --><p class='indent'>   <!-- l. 105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 107 --><p class='indent'>   <!-- l. 107 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 109 --><p class='indent'>   <!-- l. 109 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FFFFFF;'><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><munder class='msub'><mrow><munder accentunder='false'><mrow> <munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow>
<mstyle class='text'><mtext>FFT Level 1</mtext></mstyle></mrow></munder> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>A</mi></mrow><mrow>
<mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow>
<mstyle class='text'><mtext>FFT Level 1</mtext></mstyle></mrow></munder><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>FFT Level 2</mtext></mstyle></mrow></munder> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>X</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow>
<mstyle class='text'><mtext>FFT Level 1</mtext></mstyle></mrow></munder> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>A</mi></mrow><mrow>
<mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow>
<mstyle class='text'><mtext>FFT Level 1</mtext></mstyle></mrow></munder><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>FFT Level 2</mtext></mstyle></mrow></munder></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>FFT Level 3</mtext></mstyle></mrow></munder></mrow></math>
</p><!-- l. 111 --><p class='indent'>   <!-- l. 111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 113 --><p class='indent'>   To evaluate <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct roots of unity
                                                                                         
                                                                                         
<!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, we evaluate the above
formula’s each FFT level at <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
from level <!-- l. 113 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>l</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mn>3</mn></mrow></math>.
</p><!-- l. 115 --><p class='indent'>   <!-- l. 115 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 117 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>FFT Level </span><!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐥</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
We evaluate <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, and
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>. However, notice
that plugging in <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
to <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup></math> results in only
2 distinct values: <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup></math>
and <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>4</mn></mrow></msup></math>. This is because
the order of <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>
is <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> (i.e.,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>), and thus
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup></mrow></math>, and
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup></mrow></math>. Therefore, we only
need to evaluate <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, and
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at 2
distinct <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
values instead of 8, where each evaluation requires a constant number of arithmetic operations:
computing 1 multiplication and 1 addition. As there are a total of 4 polynomials to evaluate (i.e.,
<!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>), we compute
FFT a total of <!-- l. 117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>2</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
times.
</p><!-- l. 119 --><p class='indent'>   <!-- l. 119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 121 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>FFT Level </span><!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐥</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
Based on the evaluation results from FFT Level 1 as building blocks, we evaluate
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>. However, notice
that plugging in <!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
to <!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup></math> results in only
4 distinct values: <!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup></math>,
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup></math>,
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>4</mn></mrow></msup></math>, and
<!-- l. 121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup></math>. This is because
the order of <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>
is <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> (i.e.,
<!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>), and
thus <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>,
                                                                                         
                                                                                         
<!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>,
<!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>, and
<!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>. Therefore, we only
need to evaluate <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
and <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at 4
distinct <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
values instead of 8, where each evaluation requires a constant number of arithmetic operations: computing
1 multiplication and 1 addition (where we use the results from FFT Level 1 as building blocks and FFT Level 2’s
computation structure is the same as that of FFT Level 1). There are a total of 2 polynomials to evaluate (i.e.,
<!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>), thus we compute
FFT a total of <!-- l. 122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>4</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
times.
</p><!-- l. 124 --><p class='indent'>   <!-- l. 124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 126 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>FFT Level </span><!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐥</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>:</span>
Based on the evaluation results from FFT Level 2 as building blocks, we evaluate
<!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at
<!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>0</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
For this last level of computation, we need to evaluate all 8 distinct
<!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math> values,
since they are all unique values, and each evaluation requires a constant number of arithmetic operations:
computing 1 multiplication and 1 addition. There is a total of 1 polynomial to evaluate (i.e.,
<!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>), thus we compute
FFT a total of <!-- l. 126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>8</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
times.
</p><!-- l. 128 --><p class='indent'>   <!-- l. 128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 130 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Generalization: </span>Suppose that the degree of the target polynomial to evaluate is bound by
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> degree and
we define <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>L</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi></mrow></math>
(i.e., the total number of FFT levels). Then, the forward FFT operation requires a total of
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>L</mi></math> FFT levels, where
each <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>l</mi></math>-th level requires
the evaluation of <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mn>2</mn></mrow><mrow><mi>L</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>l</mi></mrow></msup></math>
polynomials at <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mn>2</mn></mrow><mrow><mi>l</mi></mrow></msup></math>
distinct <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math>
values. Therefore, the total number of FFT computations for forward FFT is:
<!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>2</mn></mrow><mrow><mi>L</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>l</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mn>2</mn></mrow><mrow><mi>l</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>2</mn></mrow><mrow><mi>L</mi></mrow></msup><mstyle> <mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi><mstyle><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>n</mi></mrow></math>. Therefore, the time
complexity of forward FFT is <!-- l. 130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 132 --><p class='indent'>   Using the FFT technique, we reduce the number of
<!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
points to evaluate into half as the level goes down (while the number of polynomials
to evaluate doubles), and their growth and reduction cancel each other, resulting in
<!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> for each level. Since there
are <!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi></mrow></math> such levels, the total
time complexity is <!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>O</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mi class='loglike'>log</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
The core enabler of this optimization is the special property of the
                                                                                         
                                                                                         
<!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> evaluation coordinates:
its power (i.e., <!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mi>i</mi></mrow></msup></math>)
is cyclic. To enforce this cyclic property, FFT requires the evaluation points of
<!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> to be
the <!-- l. 132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-th
roots of unity.
                                                                                         
                                                                                         
</p>
   <!-- l. 141 --><div class='crosslinks'><p class='noindent'>[<a href='BackgroundandMotivation.html'>prev</a>][<a href='EfficientPolynomialMultiplicationbyFFTandNTT.html#ForwardFFTorNTT.html'>parent</a>][<a href='PointwiseMultiplication.html'>next</a>]</p></div>
    
</body> 
</html>