<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Homomorphic Rotation of Input Vector Slots</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 845 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicKeySwitching1.html'>prev</a>][<a href='BFVScheme.html#HomomorphicRotationofInputVectorSlots.html'>parent</a>][<a href='ApplicationMatrixMultiplication.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='homomorphic-rotation-of-input-vector-slots'><span class='titlemark'>D-2.9   </span> <a id='x120-159000D-2.9'></a>Homomorphic Rotation of Input Vector Slots</h4>
<!-- l. 849 --><p class='noindent'>In this section, we will explain how to homomorphically rotate the elements of an input vector
<!-- l. 849 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> after it
is already encoded as a polynomial and encrypted as an RLWE ciphertext. In <a href='CoefficientRotation.html#coefficient-rotation'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2<!-- tex4ht:ref: subsec:bfv-key-switching  --></a>, we learned
how to rotate the coefficients of a polynomial. However, rotating the plaintext polynomial
<!-- l. 849 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> or RLWE ciphertext
polynomials <!-- l. 849 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
does not necessarily rotate the input vector, which is the source of them.
</p><!-- l. 851 --><p class='indent'>   The key requirement of homomorphic rotation of input vector slots (i.e., input vector) is that this
operation should be performed on the RLWE ciphertext such that after this operation, if we decrypt the
RLWE ciphertext and decode it, the recovered input vector will be in a rotated state as we expect. We
will divide this task into the following two sub-problems:
</p><!-- l. 853 --><p class='indent'>
          </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
       1. </dt><dd class='enumerate-enumitem'>How to indirectly rotate the input vector by updating the plaintext polynomial <!-- l. 854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>
          to <!-- l. 854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup></math>?
          </dd><dt class='enumerate-enumitem'>
       2. </dt><dd class='enumerate-enumitem'>How to indirectly update the plaintext polynomial <!-- l. 856 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>
          to <!-- l. 856 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
          by updating the RLWE ciphertext polynomials <!-- l. 856 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
          to <!-- l. 856 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>?</dd></dl>
   
   <h5 class='subsubsectionHead' id='rotating-input-vector-slots-by-updating-the-plaintext-polynomial'><span class='titlemark'>D-2.9.1   </span> <a id='x120-160000D-2.9.1'></a>Rotating Input Vector Slots by Updating the Plaintext Polynomial</h5>
<!-- l. 863 --><p class='noindent'>In this task, our goal is to modify the plaintext polynomial
<!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> such that the first-half
elements of the input vector <!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
are shifted to the left by <!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions in a wrapping manner among them, and the second-half elements of
<!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> are also shifted to the left by
<!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math> positions in a wrapping manner
among them. Specifically, if <!-- l. 863 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
is defined as follows:
</p><!-- l. 865 --><p class='indent'>   <!-- l. 865 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 867 --><p class='indent'>   <!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 869 --><p class='indent'>   Then, we will denote the <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>-shifted
vector <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>
as follows:
                                                                                         
                                                                                         
</p><!-- l. 871 --><p class='indent'>   <!-- l. 871 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo></mrow><mo>⏟</mo></munder></mrow><mrow>
<mstyle class='text'><mtext>The first-half </mtext><mstyle class='math'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mstyle><mtext> elements </mtext><mstyle class='math'><mi>h</mi></mstyle><mtext>-rotated to the left</mtext></mstyle></mrow></munder><mstyle class='text'><mtext> </mtext></mstyle><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder> </mrow><mrow>
<mstyle class='text'><mtext>The second-half </mtext><mstyle class='math'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mstyle><mtext> elements </mtext><mstyle class='math'><mi>h</mi></mstyle><mtext>-rotated to the left</mtext></mstyle></mrow></munder><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 873 --><p class='indent'>   <!-- l. 873 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 875 --><p class='indent'>   Remember from <a href='BatchEncoding.html#batch-encoding'><span class='ts1-lmr10-x-x-109'>§</span>D-2.2<!-- tex4ht:ref: subsec:bfv-key-switching  --></a> that the BFV encoding scheme’s components are as follows:
</p><!-- l. 877 --><p class='indent'>   <!-- l. 877 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> <span style='color:#FF0000;'>  #
<!-- l. 877 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
input vector</span>
</p><!-- l. 879 --><p class='indent'>   <!-- l. 879 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 881 --><p class='indent'>   <!-- l. 881 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>W</mi> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mn>1</mn>     </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>    </mtd><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                      </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 889 --><p class='indent'>   <!-- l. 889 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>     <mn>1</mn>     </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>        </mtd><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>       </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>       </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>    </mtd><mtd class='array-td' columnalign='center'>     <mi>⋮</mi>     </mtd><mtd class='array-td' columnalign='center'> <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mo class='MathClass-rel' stretchy='false'>⋱</mo>      </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                   </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 897 --><p class='indent'>   , where <!-- l. 897 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>g</mi></mrow><mrow><mfrac><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow>
 <mrow><mn>2</mn><mi>n</mi></mrow></mfrac> </mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
(<!-- l. 897 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>g</mi></math> is a
generator of <!-- l. 897 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>×</mo></mrow></msubsup></math>)
</p><!-- l. 899 --><p class='indent'>   <span style='color:#FF0000;'># The encoding matrix that converts <!-- l. 899 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
into <!-- l. 899 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> ( i.e.,
<!-- l. 899 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> coefficients of the
plaintext polynomial <!-- l. 899 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
)</span>
</p><!-- l. 903 --><p class='indent'>   <!-- l. 903 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 905 --><p class='indent'>   <!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi mathvariant='normal'>Δ</mi><mi>W</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
</p><!-- l. 907 --><p class='indent'>   <span style='color:#FF0000;'> # A vector containing the scaled <!-- l. 907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
integer coefficients of the plaintext polynomial</span>
</p><!-- l. 909 --><p class='indent'>   <!-- l. 909 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 911 --><p class='indent'>   <!-- l. 911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 913 --><p class='indent'>   <span style='color:#FF0000;'># The integer polynomial that isomorphically encodes the input vector
<!-- l. 913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math></span>
</p><!-- l. 916 --><p class='indent'>   <!-- l. 916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 918 --><p class='indent'>   We learned from <a href='IsomorphismbetweenPolynomialsandVectorsoverIntegers.html#isomorphism-between-polynomials-and-vectors-over-integers'><span class='ts1-lmr10-x-x-109'>§</span>A-10.6<!-- tex4ht:ref: subsec:bfv-key-switching  --></a> that decoding the polynomial
<!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> back to
<!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> is equivalent to
evaluating <!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at the
following <!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
primitive <!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
root of unity: <!-- l. 918 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi>ω</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
Thus, the above decoding process is equivalent to the following:
</p><!-- l. 920 --><p class='indent'>   <!-- l. 920 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup><mi mathvariant='normal'>Δ</mi><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover>
    </mrow><mrow><mi mathvariant='normal'>Δ</mi>    </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 922 --><p class='indent'>   <!-- l. 922 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 925 --><p class='indent'>   <!-- l. 925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 933 --><p class='indent'>   <!-- l. 933 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 935 --><p class='indent'>   Now, our next task is to modify <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
to <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> such that decoding
<!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> will give us a modified input
vector <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> that is a rotation
of the first half elements of <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
by <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them), and the second half elements of it also rotated
by <!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them). To accomplish this rotation, we will take a
2-step solution:
</p><!-- l. 937 --><p class='indent'>
          </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
       1. </dt><dd class='enumerate-enumitem'>To convert <!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
          into <!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
          we will define the new mapping <!-- l. 938 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub></math>
          as follows:
          <!-- l. 940 --><p class='noindent'><!-- l. 940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>
          </p><!-- l. 942 --><p class='noindent'>, where <!-- l. 942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
          is the number of rotation positions to be applied to <!-- l. 942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>.
          </p></dd><dt class='enumerate-enumitem'>
       2. </dt><dd class='enumerate-enumitem'>To decode <!-- l. 943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
          into the rotated input vector <!-- l. 943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>,
          we need to re-design our decoding scheme by modifying <span class='rm-lmss-10x-x-109'>Encoding</span><sub><span class='rm-lmss-10x-x-109'>1</span></sub>’s (<a href='BatchEncoding.html#encoding-'><span class='ts1-lmr10-x-x-109'>§</span>D-2.2.1<!-- tex4ht:ref: subsec:bfv-key-switching  --></a>) isomorphic
          mapping <!-- l. 943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>σ</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msup><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msup></mrow></math></dd></dl>
<!-- l. 946 --><p class='indent'>   <!-- l. 946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 948 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Converting </span><!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐌</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math> <span class='rm-lmbx-10x-x-109'>into</span>
<!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><msup><mrow><mi>𝐌</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>: </span>Our first task is
to convert <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> into
<!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, which is equivalent to
applying our new mapping <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub></mrow></math>,
such that decoding <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> gives a
rotated input vector <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> whose
first half of the elements in <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
are rotated by <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them), and the second half of the elements are also rotated
by <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them). To design
<!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub></math> that satisfies this requirement,
we will use the number <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup></math>
which has the following two special properties (based on number theory): </p>
   <ul class='itemize1'>
   <li class='itemize'><!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and <!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   generate all odd numbers between <!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   for the integer <!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math>
                                                                                         
                                                                                         
   where <!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>.
   </li>
   <li class='itemize'>For each integer <!-- l. 951 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math>
   where <!-- l. 951 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>,
   <!-- l. 951 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>.</li></ul>
<!-- l. 953 --><p class='noindent'>For example, suppose the modulus <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math>.
Then,
</p>
   <div class='columns-2'>
<!-- l. 956 --><p class='noindent'><!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>5</mn></mrow><mrow><mn>0</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>
<br class='newline' /><!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>5</mn></mrow><mrow><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>5</mn></mrow></math>
<br class='newline' /><!-- l. 958 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>5</mn></mrow><mrow><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>9</mn></mrow></math>
<br class='newline' /><!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>5</mn></mrow><mrow><mn>3</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn></mrow></math>
<br class='newline' /><!-- l. 960 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>5</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>0</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>15</mn></mrow></math>
<br class='newline' /><!-- l. 961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>5</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>11</mn></mrow></math>
<br class='newline' /><!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>5</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>7</mn></mrow></math>
<br class='newline' /><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>5</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn></mrow></math>
</p>
   </div>
<!-- l. 967 --><p class='indent'>   As shown above, <!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mn>4</mn></mrow></math> generate
all odd numbers between <!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Also, for each <!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math>
in <!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mn>4</mn></mrow></math>,
<!-- l. 967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>16</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math>.
</p><!-- l. 969 --><p class='indent'>   <!-- l. 969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 971 --><p class='indent'>   Let’s define <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>,
 and   <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>.
Based on <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
<!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, we will define
the mapping <!-- l. 971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 973 --><p class='indent'>   <!-- l. 973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 975 --><p class='indent'>   <!-- l. 975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 977 --><p class='indent'>   Given a plaintext polynomial <!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
in order to give its decoded version of input vector
<!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> the effect of the first half of
the elements being rotated by <!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
                                                                                         
                                                                                         
positions to the left (in a wrapping manner) and the second half of the elements also being rotated by
<!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner), we update the current plaintext polynomial
<!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to a new
polynomial <!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup>
   </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
applying the <!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>M</mi></mrow></msub></math>
mapping, where <!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
is the number of positions for left rotations for the first half and second half of the elements of
<!-- l. 977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>.
</p><!-- l. 980 --><p class='indent'>   <!-- l. 980 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 982 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Decoding </span><!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><msup><mrow><mi>𝐌</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>into </span><!-- l. 982 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>:
Our second task is to modify our original decoding scheme in order to successfully decode
<!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> into the rotated input vector
<!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>. For this, we will modify our
original isomorphic mapping <!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>σ</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>,
from:
</p><!-- l. 984 --><p class='indent'>   <!-- l. 984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>σ</mi> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msup><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msup></mrow></math> <span style='color:#FF0000;'>   #
designed in <a href='IsomorphismbetweenPolynomialsandVectorsoverIntegers.html#isomorphism-between-polynomials-and-vectors-over-integers'><span class='ts1-lmr10-x-x-109'>§</span>A-10.6<!-- tex4ht:ref: subsec:bfv-key-switching  --></a></span>
</p><!-- l. 986 --><p class='indent'>   <!-- l. 986 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 988 --><p class='indent'>   , to the following:
</p><!-- l. 990 --><p class='indent'>   <!-- l. 990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 992 --><p class='indent'>   <span style='color:#FFFFFF;'><!-- l. 992 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub> <mo class='MathClass-punc' stretchy='false'>:</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub><mo class='MathClass-rel' stretchy='false'>→</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle></mrow></math></span>
<!-- l. 992 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msup><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msup></mrow></math>
</p><!-- l. 997 --><p class='indent'>   <!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 999 --><p class='indent'>   The common aspect between <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>σ</mi></math>
and <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub></math> is that they both
evaluate the polynomial <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
at <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
primitive <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots
of unity (i.e., <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>w</mi></mrow><mrow><mi>i</mi></mrow></msup></math> for
all odd <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math> between
<!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math> ). In the case of
the <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub></math> mapping,
note that <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>j</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>
and   <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>j</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>  for
each <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math> in
<!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>  cover all odd
numbers between <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
Therefore, <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>j</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
and <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>j</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math> between
<!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mfrac><mrow><mi>n</mi></mrow> 
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> cover all
<!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
primitive <!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
                                                                                         
                                                                                         
roots of unity.
</p><!-- l. 1001 --><p class='indent'>   Meanwhile, the difference between <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>σ</mi></math>
and <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub></math> is the order of the output vector
elements. In the <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>σ</mi></math> mapping, the
order of evaluated coordinates for <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>, whereas in the
<!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub></math> mapping, the order of
evaluated coordinates is <!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>.
We will later explain why we modified the ordering like this.
</p><!-- l. 1003 --><p class='indent'>   In the original <span class='rm-lmss-10x-x-109'>Decoding</span><sub><span class='rm-lmss-10x-x-109'>2</span></sub> process (<a href='BatchEncoding.html#batch-encoding'><span class='ts1-lmr10-x-x-109'>§</span>D-2.2<!-- tex4ht:ref: subsec:bfv-key-switching  --></a>), applying the
<!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>σ</mi></math> mapping to a
plaintext polynomial <!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
was equivalent to computing the following:
</p><!-- l. 1005 --><p class='indent'>   <!-- l. 1005 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1007 --><p class='indent'>   <!-- l. 1007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1009 --><p class='indent'>   <!-- l. 1009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>ω</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1011 --><p class='indent'>   <!-- l. 1011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1013 --><p class='indent'>   <!-- l. 1013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>W</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>T</mi> </mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
<!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math> <span style='color:#FF0000;'> # where
<!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>W</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>T</mi> </mrow></msubsup></math> is the
<!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th row
of <!-- l. 1014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math></span>
</p><!-- l. 1016 --><p class='indent'>   <!-- l. 1016 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
</p><!-- l. 1022 --><p class='indent'>   <!-- l. 1022 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1024 --><p class='indent'>   Similarly, the modified <!-- l. 1024 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>σ</mi></mrow><mrow><mi>J</mi></mrow></msub></math> mapping
to the plaintext polynomial <!-- l. 1024 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is equivalent to computing the following:
</p><!-- l. 1026 --><p class='indent'>   <!-- l. 1026 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1030 --><p class='indent'>   <!-- l. 1030 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1032 --><p class='indent'>   <!-- l. 1032 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1034 --><p class='indent'>   <!-- l. 1034 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1036 --><p class='indent'>   <!-- l. 1036 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>,
where
</p><!-- l. 1038 --><p class='indent'>   <!-- l. 1038 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1040 --><p class='noindent'><!-- l. 1040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1053 --><p class='indent'>   <!-- l. 1053 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1055 --><p class='indent'>   <!-- l. 1055 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 1057 --><p class='noindent'><!-- l. 1057 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>       </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>    <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1065 --><p class='indent'>   <!-- l. 1065 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1067 --><p class='indent'>   <!-- l. 1067 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1069 --><p class='indent'>   From this point, we will replace <!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math>
in the <span class='rm-lmss-10x-x-109'>Encoding</span><sub><span class='rm-lmss-10x-x-109'>1</span></sub> process (<a href='BatchEncoding.html#batch-encoding'><span class='ts1-lmr10-x-x-109'>§</span>D-2.2<!-- tex4ht:ref: subsec:bfv-key-switching  --></a>) by <!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math>,
and <!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math> in the <span class='rm-lmss-10x-x-109'>Decoding</span><sub><span class='rm-lmss-10x-x-109'>2</span></sub>
process by <!-- l. 1069 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>.
</p><!-- l. 1071 --><p class='indent'>   <!-- l. 1071 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1073 --><p class='indent'>   To demonstrate that <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> is
a valid encoding matrix like <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math>
and <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> is a valid
decoding matrix like <!-- l. 1073 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>W</mi></mrow><mrow><mi>T</mi> </mrow></msup></math>,
we need to prove the following 2 aspects: </p>
          <ul class='itemize1'>
          <li class='itemize'><!-- l. 1076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle mathvariant='bold'><mi>𝐖</mi></mstyle></mrow><mo accent='true' stretchy='false'>~</mo></mover></math>
          <span class='rm-lmbx-10x-x-109'>is a basis of the </span><!-- l. 1076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math><span class='rm-lmbx-10x-x-109'>-dimensional
          vector space: </span>This is true, because <!-- l. 1076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math>
          is simply a row-wise re-ordering of <!-- l. 1076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math>,
          which is still a basis of the <!-- l. 1076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math>-dimensional
          vector space.
          </li>
          <li class='itemize'>
          <!-- l. 1078 --><p class='noindent'><!-- l. 1078 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo> <msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>
          (to satisfy Theorem A-11.4 in <a href='VandermondeMatrixwithRootsofCyclotomicPolynomialoverComplexNumbers.html#vandermonde-matrix-with-roots-of-cyclotomic-polynomial-over-complex-numbers'><span class='ts1-lmr10-x-x-109'>§</span>A-11.4<!-- tex4ht:ref: subsec:vandermonde-euler  --></a>): This proof is split into 2 sub-proofs:
                </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
              1. </dt><dd class='enumerate-enumitem'><!-- l. 1080 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow></math>
                has value <!-- l. 1080 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐧</mi></mstyle></math>
                along the anti-diagonal line: Each element along the anti-diagonal line of <!-- l. 1080 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow></math>
                is computed as <!-- l. 1080 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi mathvariant='italic'>𝑛𝑖𝑘</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi></mrow></math>
                where <!-- l. 1080 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math>
                is some integer.
                </dd><dt class='enumerate-enumitem'>
              2. </dt><dd class='enumerate-enumitem'><!-- l. 1081 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow></math>
                has value 0 at all other coordinates: All other elements except for the ones along
                the anti-diagonal lines are <!-- l. 1081 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msup><mrow><mi>ω</mi></mrow><mrow><mn>2</mn><mi>i</mi></mrow></msup><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo> <mn>1</mn>
 </mrow><mrow><mi>ω</mi> <mo class='MathClass-bin' stretchy='false'>−</mo> <mn>1</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>
                (by Geometric Sum).</dd></dl>
          <!-- l. 1084 --><p class='noindent'>We provide <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/bfv_j_matrix_inverse_proof.py'><span class='underline'>the Python script</span></a> that empirically demonstrates this.
</p>
          </li></ul>
<!-- l. 1091 --><p class='indent'>   Therefore, <!-- l. 1091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> and
<!-- l. 1091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> are valid encoding &amp; decoding
matrices that transform <!-- l. 1091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
                                                                                         
                                                                                         
into <!-- l. 1091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 1093 --><p class='indent'>   <!-- l. 1093 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1095 --><p class='indent'>   Now, let’s think about what will be the structure of
<!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> (i.e., the first-half
elements of <!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
being rotated <!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left in a wrapping manner among them and the second-half elements of it also being
rotated <!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left in a wrapping manner among them). Remember that
<!-- l. 1095 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> is as
follows:
</p><!-- l. 1097 --><p class='indent'>   <!-- l. 1097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1102 --><p class='indent'>      <!-- l. 1102 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1104 --><p class='indent'>   <!-- l. 1104 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1106 --><p class='indent'>   Thus, the state of <!-- l. 1106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> which
is equivalent to rotating <!-- l. 1106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
by <!-- l. 1106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left for the first-half and second-half element groups will be the following:
</p><!-- l. 1108 --><p class='indent'>   <!-- l. 1108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 1110 --><p class='indent'>      <!-- l. 1110 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1112 --><p class='indent'>   <!-- l. 1112 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1114 --><p class='indent'>   Notice that the above computation of <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> is
equivalent to vertically rotating the upper <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>
rows of <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
by <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions upward (in a wrapping manner among them), rotating the lower
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> rows of
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> by
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions upward (in a wrapping manner among them), and multiplying the resulting matrix with
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>.
However, it is not desirable to directly modify the decoding matrix
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> like this in
practice, because then the decoding matrix loses its consistency. Therefore, instead of directly modifying
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>, we will
modify <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
to <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math> (i.e.,
modify <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>) such that the relation
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math> holds. Let’s extract
the upper-half rows of <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
and denote this <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>×</mo><mi>n</mi></mrow></math>
matrix as <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math>.
Then, <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math>
is equivalent to a Vandermonde matrix (Definition A-10.2 in <a href='VariousTypesofMatrix.html#various-types-of-matrix'><span class='ts1-lmr10-x-x-109'>§</span>A-10.2<!-- tex4ht:ref: subsec:vandermonde  --></a>) in the form of
                                                                                         
                                                                                         
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. Similarly, let’s extract
the lower-half rows of <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
and denote this <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>×</mo><mi>n</mi></mrow></math>
matrix as <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math>.
Then, <!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math>
is equivalent to a Vandermonde matrix (Definition A-10.2 in <a href='VariousTypesofMatrix.html#various-types-of-matrix'><span class='ts1-lmr10-x-x-109'>§</span>A-10.2<!-- tex4ht:ref: subsec:vandermonde  --></a>) in the form of
<!-- l. 1114 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 1116 --><p class='indent'>   Now, let’s vertically rotate the rows of <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math>
by <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math> positions upward and
denote it as <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></math>; and vertically
rotate the rows of <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup></math> by
<!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math> positions upward and denote
it as <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></math>. And let’s denote the
<!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional vector comprising
the first-half elements of <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>
as <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></math>, and the
<!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional vector comprising
the second-half elements of <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>
as <!-- l. 1116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup></math>. Then, computing
(i.e., decoding) <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math> is
equivalent to modifying <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> (whose coefficient
vector is <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>) and then
computing (i.e., decoding) <!-- l. 1117 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>.
This is because:
</p><!-- l. 1119 --><p class='indent'>   <!-- l. 1119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
</p><!-- l. 1121 --><p class='indent'>   <!-- l. 1121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>h</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>0</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1123 --><p class='indent'>   <!-- l. 1123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1125 --><p class='indent'>   <!-- l. 1125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1128 --><p class='indent'>   <span style='color:#FF0000;'># This is equivalent to evaluating the polynomial
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at the following
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> distinct
<!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of
unity: <!-- l. 1128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math></span>
</p><!-- l. 1130 --><p class='indent'>   <!-- l. 1130 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1132 --><p class='indent'>   <!-- l. 1132 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1134 --><p class='indent'>   <!-- l. 1134 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>0</mn></mrow></msup>
        </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>1</mn></mrow></msup>
        </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>2</mn></mrow></msup>
        </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
               </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1136 --><p class='indent'>   <!-- l. 1136 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup>
   </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup>
        </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msup>
        </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
               </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math> <span style='color:#FF0000;'> # note
that <!-- l. 1136 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>5</mn></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math></span>
</p><!-- l. 1138 --><p class='indent'>   <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1140 --><p class='indent'>   <!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 1142 --><p class='indent'>   <!-- l. 1142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1144 --><p class='indent'>   <!-- l. 1144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1146 --><p class='indent'>   <!-- l. 1146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math> <span style='color:#FF0000;'>  # where
                                                                                         
                                                                                         
<!-- l. 1146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> contains the
<!-- l. 1146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> coefficients of
the polynomial <!-- l. 1146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</span>
</p><!-- l. 1149 --><p class='indent'>   <!-- l. 1149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1151 --><p class='indent'>   Similarly, computing (i.e., decoding) <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
is equivalent to modifying <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>M</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> (whose coefficient
vector is <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>) and then
computing (i.e., decoding) <!-- l. 1151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>.
This is because,
</p><!-- l. 1153 --><p class='indent'>   <!-- l. 1153 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
</p><!-- l. 1155 --><p class='indent'>   <!-- l. 1155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1158 --><p class='indent'>   <!-- l. 1158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 1160 --><p class='indent'>      <!-- l. 1160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>+</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1162 --><p class='indent'>   <!-- l. 1162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1164 --><p class='indent'>   <!-- l. 1164 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1167 --><p class='indent'>   <span style='color:#FF0000;'># This is equivalent to evaluating the polynomial
<!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> at the following
<!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> distinct
<!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th roots of
unity: <!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math></span>
</p><!-- l. 1169 --><p class='indent'>   <!-- l. 1169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1171 --><p class='indent'>   <!-- l. 1171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1173 --><p class='indent'>   <!-- l. 1173 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>0</mn></mrow></msup>
           </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>1</mn></mrow></msup>
           </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>2</mn></mrow></msup>
           </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
                  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1175 --><p class='indent'>   <!-- l. 1175 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup>
     </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup>
          </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msup>
          </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
                 </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math> <span style='color:#FF0000;'> # note
that <!-- l. 1175 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>5</mn></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math></span>
</p><!-- l. 1177 --><p class='indent'>   <!-- l. 1177 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1179 --><p class='indent'>   <!-- l. 1179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
</p><!-- l. 1181 --><p class='indent'>   <!-- l. 1181 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1183 --><p class='indent'>   <!-- l. 1183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1185 --><p class='indent'>   <!-- l. 1185 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>
</p><!-- l. 1188 --><p class='indent'>   <!-- l. 1188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1190 --><p class='indent'>   The above derivations demonstrate that <!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>1</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>,
and <!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mover accent='true'><mrow><mi>H</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mn>2</mn></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>.
Combining these two findings, we reach the conclusion that
<!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></mrow></math>: rotating the first-half
elements of the input vector <!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> by
<!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math> positions to the left and the
second-half elements of it by <!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions also to the left is equivalent to updating the plaintext polynomial
<!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and then decoding it with
the decoding matrix <!-- l. 1190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>.
</p><!-- l. 1250 --><p class='indent'>   However, now a new problem is that we cannot directly update the plaintext
                                                                                         
                                                                                         
<!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
because <!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is encrypted as an RLWE ciphertext. Therefore, we need to instead update the RLWE ciphertext components
<!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to <span class='rm-lmri-10x-x-109'>indirectly</span>
by updating <!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to <!-- l. 1250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. We
will explain this in the next subsection.
   
</p>
   <h5 class='subsubsectionHead' id='updating-the-plaintext-polynomial-by-updating-the-ciphertext-polynomials'><span class='titlemark'>D-2.9.2   </span> <a id='x120-161000D-2.9.2'></a>Updating the Plaintext Polynomial by Updating the Ciphertext Polynomials</h5>
<!-- l. 1255 --><p class='noindent'>Given an RLWE ciphertext <!-- l. 1255 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
our goal is to update <!-- l. 1255 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
<!-- l. 1255 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> such that decrypting it
gives the input vector <!-- l. 1255 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>.
That is, the following relation should hold:
</p><!-- l. 1257 --><p class='indent'>   <!-- l. 1257 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
</p><!-- l. 1259 --><p class='indent'>   <!-- l. 1259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1261 --><p class='indent'>   Remember that in the RLWE cryptosystem (<a href='RLWECryptosystem1.html#rlwe-cryptosystem1'><span class='ts1-lmr10-x-x-109'>§</span>B-3<!-- tex4ht:ref: subsec:vandermonde  --></a>)’s alternative version (<a href='AnAlternativeVersionofGLWE.html#an-alternative-version-of-glwe'><span class='ts1-lmr10-x-x-109'>§</span>B-4.4<!-- tex4ht:ref: subsec:vandermonde  --></a>), the plaintext and
ciphertext pair have the following relation:
</p><!-- l. 1263 --><p class='indent'>   <!-- l. 1263 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≈</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1265 --><p class='indent'>   <!-- l. 1265 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1267 --><p class='indent'>   If we apply <!-- l. 1267 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
in the above relation, we can derive the following relation:
</p><!-- l. 1269 --><p class='indent'>   <!-- l. 1269 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≈</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1271 --><p class='indent'>   <!-- l. 1271 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1273 --><p class='indent'>   This relation implies that if we decrypt the ciphertext
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> with
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as the secret key,
then we get <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Therefore, <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is the RLWE ciphertext we are looking for, because decrypting it and then decoding its plaintext
<!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> will give us the
input vector <!-- l. 1273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>.
</p><!-- l. 1275 --><p class='indent'>   We can easily convert <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
into <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
applying <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math> to
<!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math> for each of
the <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
<!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
polynomials. However, after that, notice that the decryption key of the RLWE ciphertext
<!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> has been
changed from <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to
                                                                                         
                                                                                         
<!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. Thus, we need to additionally
switch the ciphertext <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math>’s
key from <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, which is
equivalent to converting <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
into <!-- l. 1275 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>C</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>.
For this, we will apply the BFV key switching technique (Summary D-2.8) learned in <a href='HomomorphicKeySwitching1.html#homomorphic-key-switching1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.8<!-- tex4ht:ref: subsec:bfv-key-switching  --></a> as
follows:
</p><!-- l. 1277 --><p class='indent'>   <!-- l. 1277 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1279 --><p class='noindent'><!-- l. 1279 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow>
<mtable class='subarray-c' columnalign='center' rowlines='' rowspacing='0' style=''><mtr><mtd><mstyle class='text'><mtext>the result of</mtext></mstyle>
</mtd></mtr><mtr><mtd><mstyle class='text'><mtext>plaintext-to-ciphertext addition</mtext></mstyle>
</mtd></mtr>                                                                                         </mtable></mrow></munder> <mo class='MathClass-rel' stretchy='false'>=</mo><munder class='msub'><mrow><munder accentunder='false'><mrow> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow>
<mtable class='subarray-c' columnalign='center' rowlines='' rowspacing='0' style=''><mtr><mtd><mstyle class='text'><mtext>the plaintext </mtext></mstyle><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>
</mtd></mtr><mtr><mtd><mstyle class='text'><mtext>(trivial ciphertext)</mtext></mstyle> </mtd></mtr>                                                                                                        </mtable></mrow></munder><mo class='MathClass-bin' stretchy='false'>+</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><munder class='msub'><mrow><munder accentunder='false'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow>
<mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow>
<mtable class='subarray-c' columnalign='center' rowlines='none' rowspacing='0' style=''><mtr><mtd><mtable class='subarray-c' columnalign='center' rowlines='' rowspacing='0' style=''><mtr><mtd><mstyle class='text'><mtext>an RLWE ciphertext encrypting </mtext><mstyle class='math'><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext></mtext></mstyle>
</mtd></mtr><mtr><mtd><mstyle class='text'><mtext>which is key-switched from </mtext><mstyle class='math'><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext></mtext></mstyle> </mtd></mtr>                                                                     </mtable> 
</mtd></mtr>                                                                                                                            </mtable></mrow></munder></mrow></math>
   
</p>
   <h5 class='subsubsectionHead' id='summary2'><span class='titlemark'>D-2.9.3   </span> <a id='x120-162000D-2.9.3'></a>Summary</h5>
<!-- l. 1286 --><p class='noindent'>We summarize the procedure of rotating the BFV input vectors as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-87'>     
<div class='tcolorbox-title'>
<!-- l. 1347 --><p class='indent'>   <!-- l. 1347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-2.9</span><!-- l. 1347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>BFV’s Homomorphic Rotation of Input Vector
                                                                                         
                                                                                         
Slots</span></p></div> 
<div class='tcolorbox-content'><!-- l. 1290 --><p class='noindent'>To support input vector slot rotation, we update the original encoding matrix in <span class='rm-lmss-10x-x-109'>Encoding</span><sub><span class='rm-lmss-10x-x-109'>1</span></sub>
as follows:
</p><!-- l. 1292 --><p class='noindent'><!-- l. 1292 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1294 --><p class='noindent'><!-- l. 1294 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>         <mi>⋮</mi>         </mtd><mtd class='array-td' columnalign='center'>         <mi>⋮</mi>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr><!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1302 --><p class='noindent'><!-- l. 1302 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1304 --><p class='noindent'><!-- l. 1304 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1307 --><p class='noindent'>, and update the original decoding matrix in <span class='rm-lmss-10x-x-109'>Decoding</span><sub><span class='rm-lmss-10x-x-109'>2</span></sub> as follows:
</p><!-- l. 1309 --><p class='noindent'><!-- l. 1309 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1322 --><p class='noindent'><!-- l. 1322 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1324 --><p class='noindent'><!-- l. 1324 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1327 --><p class='noindent'>, where <!-- l. 1327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is the <span class='rm-lmri-10x-x-109'>rotation helper formula</span>: <!-- l. 1327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>,
  <!-- l. 1327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math>
</p><!-- l. 1329 --><p class='noindent'><!-- l. 1329 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1331 --><p class='noindent'>Suppose we have an RLWE ciphertext and a key-switching key as follows:
</p><!-- l. 1333 --><p class='noindent'><!-- l. 1333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
  <!-- l. 1333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1335 --><p class='noindent'><!-- l. 1335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1337 --><p class='noindent'>Then, the procedure of rotating the first-half elements of the ciphertext’s original input vector
<!-- l. 1337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
by
<!-- l. 1337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them) and the second-half elements of
<!-- l. 1337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
by
<!-- l. 1337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>h</mi></math>
positions to the left (in a wrapping manner among them) is as follows:
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'>Update <!-- l. 1340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    <!-- l. 1340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    to <!-- l. 1340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    <!-- l. 1340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Perform         the         following         key         switching         (<a href='HomomorphicKeySwitching2.html#homomorphic-key-switching2'><span class='ts1-lmr10-x-x-109'>§</span>D-3.8<!-- tex4ht:ref: subsec:bfv-rotation  --></a>)         from
    <!-- l. 1341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    to <!-- l. 1341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>:
    <!-- l. 1343 --><p class='noindent'><!-- l. 1343 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-bin' stretchy='false'>+</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖣𝖾𝖼𝗈𝗆𝗉</mtext></mstyle></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></mrow></math></p></dd></dl>
 
</div> 
</div>
                                                                                         
                                                                                         
   
   <h5 class='subsubsectionHead' id='encoding-example'><span class='titlemark'>D-2.9.4   </span> <a id='x120-163000D-2.9.4'></a>Encoding Example</h5>
<!-- l. 1353 --><p class='noindent'>Suppose we have the following setup:
</p><!-- l. 1355 --><p class='indent'>   <!-- l. 1355 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>μ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>17</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>2</mn></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>
</p><!-- l. 1357 --><p class='indent'>   <!-- l. 1357 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1359 --><p class='indent'>   <!-- l. 1359 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>17</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1361 --><p class='indent'>   <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1363 --><p class='indent'>   The roots of <!-- l. 1363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
are <!-- l. 1363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, as
demonstrated as follows:
</p><!-- l. 1365 --><p class='indent'>   <!-- l. 1365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>2</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>16</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1367 --><p class='indent'>   <!-- l. 1367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1369 --><p class='indent'>   Definition A-8.1 (in <a href='Definitions4.html#definitions4'><span class='ts1-lmr10-x-x-109'>§</span>A-8.1<!-- tex4ht:ref: subsec:cyclotomic-def  --></a>) states that the roots of the
<!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>-th cyclotomic polynomial
are the primitive <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>-th
roots of unity. And Definition A-7.1 (in <a href='Definitions3.html#definitions3'><span class='ts1-lmr10-x-x-109'>§</span>A-7.1<!-- tex4ht:ref: subsec:roots-def  --></a>) states that the order of the primitive
<!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>-th roots of
unity is <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>.
These definitions apply to both the cyclotomic polynomials over
<!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℂ</mi></mrow></math> (complex numbers) and the
cyclotomic polynomials over <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>
(ring).
</p><!-- l. 1371 --><p class='indent'>   Since <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>are the roots
of the <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th cyclotomic
polynomial <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> over the
ring <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub></math>, they are also the
<!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th primitive roots of
unity of <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub></math>. Therefore,
their order (<a href='Definitions2.html#definitions2'><span class='ts1-lmr10-x-x-109'>§</span>A-4.1<!-- tex4ht:ref: subsec:roots-def  --></a>) is <!-- l. 1371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
as demonstrated as follows:
</p><!-- l. 1373 --><p class='indent'>   <!-- l. 1373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>2</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1375 --><p class='indent'>   <!-- l. 1375 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>2</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>16</mn><mo class='MathClass-rel' stretchy='false'>≢</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1377 --><p class='indent'>   <!-- l. 1377 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1379 --><p class='indent'>   Definition A-8.1 (in <a href='Definitions4.html#definitions4'><span class='ts1-lmr10-x-x-109'>§</span>A-8.1<!-- tex4ht:ref: subsec:cyclotomic-def  --></a>) and Theorem A-8.2 (<a href='Theorems3.html#theorems3'><span class='ts1-lmr10-x-x-109'>§</span>A-8.2<!-- tex4ht:ref: subsec:cyclotomic-theorem  --></a>) also state that for each primitive
<!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>-th root of
unity <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ω</mi></math>,
<!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>k</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝗀𝖼𝖽</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>μ</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow></msub></math> generates all roots of the
<!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>μ</mi></math>-th cyclotomic polynomial.
Notice that in the case of the <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
cyclotomic polynomial <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>,
its roots <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
generate all <!-- l. 1379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity as follows:
                                                                                         
                                                                                         
</p><!-- l. 1381 --><p class='indent'>   <!-- l. 1381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>2</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo><mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>8</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo><mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><msup><mrow><mn>5</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo><mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>{</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>}</mo><mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-close' stretchy='false'>}</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1383 --><p class='indent'>   <!-- l. 1383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1385 --><p class='indent'>   Among <!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> as the
roots of <!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>, let’s choose
<!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>9</mn></mrow></math> as the base root to construct
the encoding matrix <!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math>
and the decoding matrix <!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
as follows:
</p><!-- l. 1387 --><p class='indent'>   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math> <span style='color:#FF0000;'> #
where <!-- l. 1392 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>8</mn></mrow></math></span>
</p><!-- l. 1394 --><p class='indent'>   <!-- l. 1394 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mn>1</mn>    </mtd><mtd class='array-td' columnalign='center'>    <mn>1</mn>    </mtd><mtd class='array-td' columnalign='center'>    <mn>1</mn>    </mtd><mtd class='array-td' columnalign='center'>    <mn>1</mn>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mn>9</mn></mrow><mrow><mn>5</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mn>9</mn></mrow><mrow><mn>1</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mn>9</mn></mrow><mrow><mn>3</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mn>9</mn></mrow><mrow><mn>7</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mn>9</mn></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                   </mrow><mo fence='true' form='postfix'>]</mo></mrow>  <mo class='MathClass-rel' stretchy='false'>≡</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1406 --><p class='indent'>   <!-- l. 1406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1408 --><p class='indent'>   <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow>  <mo class='MathClass-rel' stretchy='false'>≡</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1420 --><p class='indent'>   <!-- l. 1420 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1422 --><p class='indent'>   Notice that Theorem A-11.5 (in <a href='VandermondeMatrixwithRootsofCyclotomicPolynomialoverRingsmathbbZp.html#vandermonde-matrix-with-roots-of-cyclotomic-polynomial-over-rings-zp'><span class='ts1-lmr10-x-x-109'>§</span>A-11.5<!-- tex4ht:ref: subsec:vandermonde-euler-integer-ring  --></a>) is demonstrated as follows:
</p><!-- l. 1424 --><p class='indent'>   <!-- l. 1424 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1441 --><p class='indent'>   <!-- l. 1441 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1443 --><p class='indent'>   Now suppose that we encode the following two input vectors (i.e., input vector slots) in
<!-- l. 1443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub></math>:
</p><!-- l. 1445 --><p class='indent'>   <!-- l. 1445 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1447 --><p class='indent'>   <!-- l. 1447 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1449 --><p class='indent'>   <!-- l. 1449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1451 --><p class='indent'>   <!-- l. 1451 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1453 --><p class='indent'>   These two vectors are encoded as follows:
</p><!-- l. 1455 --><p class='indent'>   <!-- l. 1455 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1457 --><p class='indent'>   <!-- l. 1457 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>11</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1474 --><p class='indent'>   <!-- l. 1474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1476 --><p class='indent'>   <!-- l. 1476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                             </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>4</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>6</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                         </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1493 --><p class='indent'>   <!-- l. 1493 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1495 --><p class='indent'>   <!-- l. 1495 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1497 --><p class='indent'>   <!-- l. 1497 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>12</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>11</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>12</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>24</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>22</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>24</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> <span style='color:#FF0000;'>  #
where <!-- l. 1497 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math></span>
</p><!-- l. 1499 --><p class='indent'>   <!-- l. 1499 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>5</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>14</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>6</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>10</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>28</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>12</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1501 --><p class='indent'>   <!-- l. 1501 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>40</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>32</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>52</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>14</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1503 --><p class='indent'>   <!-- l. 1503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1505 --><p class='indent'>   Note that the coefficients of the scaled polynomials
<!-- l. 1505 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
                                                                                         
                                                                                         
<!-- l. 1505 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> are still within the range
of the ciphertext domain <!-- l. 1505 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math>
(which must hold throughout all homomorphic computations to preserve correctness).
</p><!-- l. 1507 --><p class='indent'>   We decode <!-- l. 1507 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
and <!-- l. 1507 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as
follows:
</p><!-- l. 1509 --><p class='indent'>   <!-- l. 1509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub>
    </mrow><mrow><mi mathvariant='normal'>Δ</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>24</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>22</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>24</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo>
        </mrow><mrow><mn>2</mn>        </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>11</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1511 --><p class='indent'>   <!-- l. 1511 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub>
    </mrow><mrow><mi mathvariant='normal'>Δ</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>28</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo>
        </mrow><mrow><mn>2</mn>         </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1513 --><p class='indent'>   <!-- l. 1513 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub>
      </mrow><mrow><mi mathvariant='normal'>Δ</mi>    </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>40</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>52</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-close' stretchy='false'>)</mo>
        </mrow><mrow><mn>2</mn>         </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>20</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>26</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1515 --><p class='indent'>   <!-- l. 1515 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1518 --><p class='indent'>   <!-- l. 1518 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>11</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-close' stretchy='false'>)</mo>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1527 --><p class='indent'>   <!-- l. 1527 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1529 --><p class='indent'>   <!-- l. 1529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>5</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>6</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-close' stretchy='false'>)</mo>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1536 --><p class='indent'>   <!-- l. 1536 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>20</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>16</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>26</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>7</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                        </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1543 --><p class='indent'>   <!-- l. 1543 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1545 --><p class='indent'>   The decoded <!-- l. 1545 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo></mrow></math>
and <!-- l. 1545 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn></mrow></msub></math>
match the expected values.
   
</p>
   <h5 class='subsubsectionHead' id='rotation-example'><span class='titlemark'>D-2.9.5   </span> <a id='x120-164000D-2.9.5'></a>Rotation Example</h5>
<!-- l. 1553 --><p class='noindent'>Suppose we have the following setup:
</p><!-- l. 1555 --><p class='indent'>   <!-- l. 1555 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>μ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>17</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>2</mn></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>
</p><!-- l. 1557 --><p class='indent'>   <!-- l. 1557 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1559 --><p class='indent'>   <!-- l. 1559 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>17</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1561 --><p class='indent'>   <!-- l. 1561 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1563 --><p class='indent'>   The roots of <!-- l. 1563 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
are <!-- l. 1563 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>X</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>11</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, as
demonstrated as follows:
</p><!-- l. 1565 --><p class='indent'>   <!-- l. 1565 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mn>3</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>5</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>6</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mn>7</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>0</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>1</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>2</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><msup><mrow><mn>4</mn></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>16</mn> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1568 --><p class='indent'>   <!-- l. 1568 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1570 --><p class='indent'>   Among <!-- l. 1570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>11</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> as the
roots of <!-- l. 1570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>, let’s choose
<!-- l. 1570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn></mrow></math> as the base root to construct
the encoding matrix <!-- l. 1570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math>
and the decoding matrix <!-- l. 1570 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
                                                                                         
                                                                                         
as follows:
</p><!-- l. 1572 --><p class='indent'>   <!-- l. 1572 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>      </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1583 --><p class='indent'>   <!-- l. 1583 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                </mrow><mo fence='true' form='postfix'>]</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1594 --><p class='indent'>   <!-- l. 1594 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1596 --><p class='indent'>   <!-- l. 1596 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>4</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>5</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>6</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>7</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1607 --><p class='indent'>   <!-- l. 1607 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo> <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>17</mn></mrow></math>
</p><!-- l. 1618 --><p class='indent'>   <!-- l. 1618 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1620 --><p class='indent'>   <!-- l. 1620 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1622 --><p class='indent'>   Notice that Theorem A-11.5 (in <a href='VandermondeMatrixwithRootsofCyclotomicPolynomialoverRingsmathbbZp.html#vandermonde-matrix-with-roots-of-cyclotomic-polynomial-over-rings-zp'><span class='ts1-lmr10-x-x-109'>§</span>A-11.5<!-- tex4ht:ref: subsec:vandermonde-euler-integer-ring  --></a>) is demonstrated as follows:
</p><!-- l. 1624 --><p class='indent'>   <!-- l. 1624 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 1644 --><p class='indent'>   <!-- l. 1644 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>n</mi><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1655 --><p class='indent'>   <!-- l. 1655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1657 --><p class='indent'>   Now suppose that we encode the following input vector (i.e., input vector slots) in
<!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>17</mn></mrow></msub></math>:
</p><!-- l. 1659 --><p class='indent'>   <!-- l. 1659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1661 --><p class='indent'>   By rotating this vector by 3 positions to the left (i.e., the first-half slots and the second-half slots
separately wrapping around within their own group), we get a new vector:
</p><!-- l. 1663 --><p class='indent'>   <!-- l. 1663 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>r</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1665 --><p class='indent'>   <!-- l. 1665 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1667 --><p class='indent'>   <!-- l. 1667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> is
encoded as follows:
                                                                                         
                                                                                         
</p><!-- l. 1669 --><p class='indent'>   <!-- l. 1669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1671 --><p class='indent'>   <!-- l. 1671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>
</p><!-- l. 1673 --><p class='indent'>   <!-- l. 1673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>1</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>0</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>4</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>6</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>8</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                         </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 1702 --><p class='indent'>   <!-- l. 1702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>9</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>17</mn></mrow></math>
</p><!-- l. 1705 --><p class='indent'>   <!-- l. 1705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1707 --><p class='indent'>   <!-- l. 1707 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>13</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>10</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>5</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>9</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>12</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>7</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1709 --><p class='indent'>   <!-- l. 1709 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>26</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>32</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>20</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>10</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>18</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>24</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>14</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> <span style='color:#FF0000;'>  #
where <!-- l. 1709 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math></span>
</p><!-- l. 1711 --><p class='indent'>   <!-- l. 1711 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1714 --><p class='indent'>   <!-- l. 1714 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>26</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>24</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>20</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>18</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>10</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>q</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1716 --><p class='indent'>   <!-- l. 1716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1718 --><p class='indent'>   Note that the coefficients of the scaled polynomials
<!-- l. 1718 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> are still within the range
of the ciphertext domain <!-- l. 1718 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math>
(which must hold throughout all homomorphic computations to preserve correctness).
</p><!-- l. 1720 --><p class='indent'>   We decode <!-- l. 1720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 1722 --><p class='indent'>   <!-- l. 1722 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msub>
      </mrow><mrow><mi mathvariant='normal'>Δ</mi>    </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>26</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>24</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>20</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>18</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-close' stretchy='false'>)</mo>
                     </mrow><mrow><mn>2</mn>                     </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>10</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>18</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>10</mn><mo class='MathClass-close' stretchy='false'>)</mo>
<mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1724 --><p class='indent'>   <!-- l. 1724 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1727 --><p class='indent'>   <!-- l. 1727 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>9</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>8</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>13</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>2</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>6</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>12</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>7</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>7</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>3</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mn>11</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>2</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>5</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>4</mn>  </mtd><mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd><mtd class='array-td' columnalign='center'>  <mn>8</mn>  </mtd><mtd class='array-td' columnalign='center'>  <mn>3</mn>  </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>10</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>15</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>14</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>4</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>6</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>9</mn> </mtd> <mtd class='array-td' columnalign='center'> <mn>5</mn></mtd></mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                 </mrow><mo fence='true' form='postfix'>]</mo></mrow><mo class='MathClass-bin' stretchy='false'>⋅</mo><mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>13</mn>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>12</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>10</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <mn>18</mn>   </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn></mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn> </mtd></mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>10</mn></mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                      </mrow><mo fence='true' form='postfix'>]</mo></mrow></mrow></math>
</p><!-- l. 1746 --><p class='indent'>   <!-- l. 1746 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mn>17</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1748 --><p class='indent'>   <!-- l. 1748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>r</mi></mrow></msub></mrow></math>
</p><!-- l. 1750 --><p class='indent'>   <!-- l. 1750 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1752 --><p class='indent'>   The decoded <!-- l. 1752 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msub></math> matches the
expected rotated input vector <!-- l. 1752 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>r</mi></mrow></msub></math>.
</p><!-- l. 1755 --><p class='indent'>   <!-- l. 1755 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1757 --><p class='indent'>   In practice, we do not directly update <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
because we would not have access to the plaintext polynomial
<!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> unless we have the
secret key <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. Therefore,
we instead update <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
to <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi>A</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
which is equivalent to homomorphically rotating the encrypted input vector slots. Then, decrypting
<!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>h</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup></math> and decoding it
would output <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi>r</mi></mrow></msub></math>.
</p><!-- l. 1759 --><p class='indent'>   <!-- l. 1759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1764 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Source Code: </span>Examples of BFV’s batch encoding and homomorphic input vector rotation can be
                                                                                         
                                                                                         
executed by running <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/bfv.py'><span class='underline'>this Python script</span></a>.
                                                                                         
                                                                                         
</p>
   <!-- l. 1768 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicKeySwitching1.html'>prev</a>][<a href='BFVScheme.html#HomomorphicRotationofInputVectorSlots.html'>parent</a>][<a href='ApplicationMatrixMultiplication.html'>next</a>]</p></div>
    
</body> 
</html>