<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 1621 --><div class='crosslinks'><p class='noindent'>[<a href='SparselyPackingCiphertexts.html'>prev</a>][<a href='CKKSScheme.html#ModulusBootstrapping.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-bootstrapping'><span class='titlemark'>D-3.13   </span> <a id='x136-197000D-3.13'></a>Modulus Bootstrapping</h4>
<!-- l. 1625 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference: </span><a href='https://eprint.iacr.org/2018/153.pdf'>Bootstrapping for Approximate Homomorphic Encryption</a>Â <span class='cite'>[<a href='refname.html#Xckks'>18</a>]</span>
</p><!-- l. 1630 --><p class='indent'>   During CKKSâ€™s ciphertext-to-ciphertext multiplication, each ciphertext is associated with a particular
multiplicative level and it decreases by 1 upon each ciphertext-to-ciphertext multiplication (by its internal
modulus rescaling operation). Reaching multiplicative level 0 is equivalent to reaching the end of a
ciphertextâ€™s modulus chain and no more ciphertext-to-ciphertext multiplication can be performed. To
continue with further ciphertext-to-ciphertext multiplication, CKKS provides a special operation
called <span class='rm-lmri-10x-x-109'>bootstrapping</span>, which is a process of resetting the ciphertextâ€™s end-of-chain modulus
<!-- l. 1630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to the initial maximum
modulus <!-- l. 1630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> (which is
either <!-- l. 1630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>L</mi></mrow></msup></mrow></math> in the vanilla
rescaling scheme, or <!-- l. 1630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>m</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>L</mi></mrow></munderover><msub><mrow><mi>w</mi></mrow><mrow><mi>m</mi></mrow></msub></mrow></math>
in the case of using CRT, as explained in <a href='HomomorphicCiphertexttoCiphertextMultiplication1.html#rescaling1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.5.4<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>).
</p><!-- l. 1633 --><p class='indent'>   Suppose we have a ciphertext <!-- l. 1633 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
with multiplicative depth 0. If we decrypt a ciphertext whose multiplicative level is 0 (i.e., the ciphertextâ€™s modulus is
<!-- l. 1633 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>), then decrypting it
<span class='rm-lmri-10x-x-109'>without </span>reduction modulo <!-- l. 1633 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
would output:
</p><!-- l. 1635 --><p class='indent'>   <!-- l. 1635 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle></mrow></math>
</p><!-- l. 1637 --><p class='indent'>   <!-- l. 1637 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>K</mi></mrow></math> <span style='color:#FF0000;'> #
since <!-- l. 1637 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math></span>
</p><!-- l. 1639 --><p class='indent'>   , where <!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>K</mi></mrow></math> accounts for
wrap-around modulo <!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> valuesâ€“
each coefficient of polynomial <!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>
is some multiple of <!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
CKKSâ€™s bootstrapping procedure is equivalent to <span class='rm-lmri-10x-x-109'>safely </span>transforming a ciphertextâ€™s modulus from
<!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
<!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> (where
<!-- l. 1639 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>).
   
</p>
   <h5 class='subsubsectionHead' id='highlevel-idea2'><span class='titlemark'>D-3.13.1   </span> <a id='x136-198000D-3.13.1'></a>High-level Idea</h5>
<!-- l. 1646 --><p class='noindent'>As the first step of bootstrapping, we forcibly change the modulus of the ciphertext
<!-- l. 1646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> from
<!-- l. 1646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
<!-- l. 1646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>. Then, its decryption
                                                                                         
                                                                                         
with reduction modulo <!-- l. 1646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>
would output:
</p><!-- l. 1648 --><p class='indent'>   <!-- l. 1648 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
</p><!-- l. 1650 --><p class='indent'>   <!-- l. 1650 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
</p><!-- l. 1652 --><p class='indent'>   <!-- l. 1652 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
</p><!-- l. 1654 --><p class='indent'>   Here, we assume that <!-- l. 1654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>
is large enough such that <!-- l. 1654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
This is true given <!-- l. 1654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math> has small
coefficients which are either <!-- l. 1654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
and thus the coefficients of <!-- l. 1654 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi></mrow></math>
would not grow much.
</p><!-- l. 1657 --><p class='indent'>   In the <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> term, notice that
because of the <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> term which
is not modulo-reduced by <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
anymore, the ciphertextâ€™s decrypted plaintext polynomialâ€™s each
<!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th term would get a
corrupted coefficient <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> instead
of <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>. So, we now need to
eliminate the garbage term <!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
in each coefficient and distill the pure plaintext coefficient
<!-- l. 1657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1663 --><p class='noindent' id='sine-function-fx-def-genfrac-def-def-def-genfrac-def-genfrac-def-genfrac-def-genfrac-def-genfrac-q-left-def-genfrac-def-def-def-genfrac-def-genfrac-def-genfrac-def-genfrac-def-genfrac-xqright-such-that-fdelta-mi-ei-qki-delta-mi-ei-provided-delta-mi-ei-q-httpseprintiacrorgpdfsource'><img alt='PIC' src='figures/modulo-reduction-sine.png' /> <a id='x136-198001r16'></a></p>
<figcaption class='caption'><span class='id'>FigureÂ 16: </span><span class='content'>Sine function <!-- l. 1664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
such that <!-- l. 1664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
(provided <!-- l. 1664 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>)
<a href='https://eprint.iacr.org/2018/153.pdf'>(Source)</a>                                                                                  </span></figcaption><!-- tex4ht:label?: x136-198001r16  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 1669 --><p class='indent'>   To do so, we will take an approximated approach by using a sine function described in <a href='#sine-function-fx-def-genfrac-def-def-def-genfrac-def-genfrac-def-genfrac-def-genfrac-def-genfrac-q-left-def-genfrac-def-def-def-genfrac-def-genfrac-def-genfrac-def-genfrac-def-genfrac-xqright-such-that-fdelta-mi-ei-qki-delta-mi-ei-provided-delta-mi-ei-q-httpseprintiacrorgpdfsource'>FigureÂ 16<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>, which has a
period of <!-- l. 1669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> with
the amplitude <!-- l. 1669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle></math>.
This sine function has the following two useful properties:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>When <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is evaluated at <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
   values near the multiple of <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>,
   the result approximates to that of a line function <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math>.
   This is because the derivative (slope) of <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>x</mi></mrow></math>
   is <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>y</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>x</mi></mrow></math>,
   and if <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
   is a multiple of <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>Ï€</mi></mrow></math>,
   the slope is: <!-- l. 1672 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>y</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mn>2</mn><mi>Ï€</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>The evaluation of <!-- l. 1673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   eliminates the multiples of <!-- l. 1673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   from the input (i.e., modulo reduction <!-- l. 1673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>)</dd></dl>
<!-- l. 1676 --><p class='indent'>   <!-- l. 1676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1678 --><p class='indent'>   Combining these two properties, given input <!-- l. 1678 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>,
</p><!-- l. 1680 --><p class='indent'>   <!-- l. 1680 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo>
             </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>                 </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo>
         </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>            </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
</p><!-- l. 1682 --><p class='indent'>   <!-- l. 1682 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1685 --><p class='indent'>   , provided <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> is very
close to 0 relative to <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
(i.e., <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>).
This is true, because by construction of the CKKS scheme, the plaintext modulus (even with scaling it up
by <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Î”</mi></math>),
is significantly smaller than the ciphertext modulus. Therefore, to remove
<!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> from
<!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>, we can update each
coefficient of the polynomial <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>
by evaluating it with the <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
sine function. However, we cannot directly update the coefficients of the polynomial, because
the CKKS scheme (the RLWE scheme in general) only supports the input vectorâ€™s slot-wise
<!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math> operations.
Therefore, to update the polynomial coefficients, we need to express the update logic in terms of slot-wise input
vector arithmetic <!-- l. 1685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>.
Considering all these, CKKSâ€™s overall bootstrapping procedure is described in <a href='#highlevel-description-of-ckkss-bootstrapping-procedure'>TableÂ 6<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>.
</p>
   <div class='table'>
                                                                                         
                                                                                         
<!-- l. 1688 --><p class='indent'>   </p><figure class='float' id='x136-198004r6'><span id='highlevel-description-of-ckkss-bootstrapping-procedure'></span>
                                                                                         
                                                                                         
<div class='tabular'> <table class='tabular' id='TBL-114' rules='groups'><colgroup id='TBL-114-1g'><col id='TBL-114-1' /><col id='TBL-114-2' /></colgroup><tr class='hline'><td></td><td></td></tr><tr id='TBL-114-1-'><td class='td11' id='TBL-114-1-1' style='text-align:left; white-space:nowrap;'> 1  </td><td class='td11' id='TBL-114-1-2' style='text-align:left; white-space:nowrap;'> <span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise:</span></span> Given ciphertext <!-- l. 1690 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>, we forcibly modify its modulus from <!-- l. 1690 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to <!-- l. 1690 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>.  </td>
</tr><tr id='TBL-114-2-'><td class='td11' id='TBL-114-2-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-2-2' style='text-align:left; white-space:nowrap;'> Then, it ends up encrypting <!-- l. 1691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>k</mi></mrow></math> instead of <!-- l. 1691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>.                                                                                                                                                                           </td>
</tr><tr id='TBL-114-3-'><td class='td11' id='TBL-114-3-1' style='text-align:left; white-space:nowrap;'> 2   </td><td class='td11' id='TBL-114-3-2' style='text-align:left; white-space:nowrap;'> <span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot:</span></span> Based on step 1â€™s ciphertext <!-- l. 1692 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>, we generate a new ciphertext                                                                                                                                                                                                                                                                 </td>
</tr><tr id='TBL-114-4-'><td class='td11' id='TBL-114-4-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-4-2' style='text-align:left; white-space:nowrap;'> that encrypts an input vector whose its each <!-- l. 1693 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th slot stores <!-- l. 1693 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.                                                                                                                                                 </td>
</tr><tr id='TBL-114-5-'><td class='td11' id='TBL-114-5-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-5-2' style='text-align:left; white-space:nowrap;'> This is equivalent to moving the coefficients of polynomial <!-- l. 1694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> to                                                                                                                                                                                                                                                                                </td>
</tr><tr id='TBL-114-6-'><td class='td11' id='TBL-114-6-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-6-2' style='text-align:left; white-space:nowrap;'> the input vector slots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td>
</tr><tr id='TBL-114-7-'><td class='td11' id='TBL-114-7-1' style='text-align:left; white-space:nowrap;'> 3   </td><td class='td11' id='TBL-114-7-2' style='text-align:left; white-space:nowrap;'> <span class='underline'><span class='rm-lmssbx-10x-x-109'>EvalExp:</span></span> We convert the sine function into an approximated polynomial by using                                                                                                                                                                                                                                                                                                                                                                                       </td>
</tr><tr id='TBL-114-8-'><td class='td11' id='TBL-114-8-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-8-2' style='text-align:left; white-space:nowrap;'> the Taylor series, as well as other optimizations such as                                                                                                                                                                                                                                                                                                                                                                                                                         </td>
</tr><tr id='TBL-114-9-'><td class='td11' id='TBL-114-9-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-9-2' style='text-align:left; white-space:nowrap;'> Eulerâ€™s formula (<!-- l. 1698 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœƒ</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœƒ</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>). Then, we generate a CKKS plaintext that encodes                                                                                                                                                                                                                                                                      </td>
</tr><tr id='TBL-114-10-'><td class='td11' id='TBL-114-10-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-10-2' style='text-align:left; white-space:nowrap;'> this approximated sine function, and then use this to homomorphically evaluate                                                                                                                                                                                                                                                                                                                                                                                         </td>
</tr><tr id='TBL-114-11-'><td class='td11' id='TBL-114-11-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-11-2' style='text-align:left; white-space:nowrap;'> step 2â€™s encrypted vector elements (to homomorphically remove every <!-- l. 1700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.                                                                                                                                                                                                                                                                    </td>
</tr><tr id='TBL-114-12-'><td class='td11' id='TBL-114-12-1' style='text-align:left; white-space:nowrap;'> 4   </td><td class='td11' id='TBL-114-12-2' style='text-align:left; white-space:nowrap;'> <span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff:</span></span> Based on the resulting ciphertext from step 3, we generate a new ciphertext                                                                                                                                                                                                                                                                                                                                                                            </td>
</tr><tr id='TBL-114-13-'><td class='td11' id='TBL-114-13-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-13-2' style='text-align:left; white-space:nowrap;'> whose encrypted polynomialâ€™s each <!-- l. 1702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th coefficient is (approximately) <!-- l. 1702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.                                                                                                                                     </td>
</tr><tr id='TBL-114-14-'><td class='td11' id='TBL-114-14-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-14-2' style='text-align:left; white-space:nowrap;'> This is equivalent to moving the <!-- l. 1703 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>-eliminated values stored in the input vector slots in                                                                                                                                                                                                                                                 </td>
</tr><tr id='TBL-114-15-'><td class='td11' id='TBL-114-15-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-15-2' style='text-align:left; white-space:nowrap;'> step 3 back to the positions of the polynomial coefficients. The final ciphertext is                                                                                                                                                                                                                                                                                                                                                                                        </td>
</tr><tr id='TBL-114-16-'><td class='td11' id='TBL-114-16-1' style='text-align:left; white-space:nowrap;'>    </td><td class='td11' id='TBL-114-16-2' style='text-align:left; white-space:nowrap;'> our goal ciphertext that (approximately) encrypts <!-- l. 1705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math> under modulus <!-- l. 1705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>.                                                                                                                                        </td>
</tr><tr class='hline'><td></td><td></td></tr></table>                                                                                                                                                                                                                                                                                                                                                   </div>

<figcaption class='caption'><span class='id'>TableÂ 6: </span><span class='content'>High-level Description of CKKSâ€™s Bootstrapping Procedure
</span></figcaption><!-- tex4ht:label?: x136-198004r6  -->
                                                                                         
                                                                                         
   </figure>
   </div>
   
   <h5 class='subsubsectionHead' id='mathematical-expansion-of-the-highlevel-idea'><span class='titlemark'>D-3.13.2   </span> <a id='x136-199000D-3.13.2'></a>Mathematical Expansion of the High-level Idea</h5>
<!-- l. 1716 --><p class='noindent'>We will mathematically walk through how the bootstrapping procedure (<a href='#highlevel-description-of-ckkss-bootstrapping-procedure'>TableÂ 6<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>) correctly updates the modulus of the
input ciphertext from <!-- l. 1716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
to <!-- l. 1716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>.
</p><!-- l. 1718 --><p class='indent'>   For ease of understanding, we will first explain how we would do modulus
bootstrapping for a ciphertext with multiplicative level 0 (i.e., its modulus is
<!-- l. 1718 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>) in case we have access
to the secret key <!-- l. 1718 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Using this key, we can decrypt the ciphertext as follows:
</p><!-- l. 1720 --><p class='indent'>   <!-- l. 1720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle></mrow></math> <span style='color:#FF0000;'> #
where <!-- l. 1720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></span>
</p><!-- l. 1722 --><p class='indent'>   <!-- l. 1722 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
</p><!-- l. 1724 --><p class='indent'>   <!-- l. 1724 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> <span style='color:#FF0000;'># where
<!-- l. 1724 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> accounts for any potential
wrap-around modulo <!-- l. 1724 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
values</span>
</p><!-- l. 1726 --><p class='indent'>   Our initial goal is to bootstrap the modulus of the ciphertext from
<!-- l. 1726 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
<!-- l. 1726 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> by
using only the following three tools:
</p>
   <ul class='itemize1'>
   <li class='itemize'>Secret key <!-- l. 1729 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   </li>
   <li class='itemize'>Batch-encoding (<!-- l. 1730 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>)
   and decoding (<!-- l. 1730 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Ïƒ</mi></math>)
   formulas
   </li>
   <li class='itemize'>Batched slot-wise <!-- l. 1731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>
   operation of input vectors based on their batch-encoded polynomials</li></ul>
<!-- l. 1734 --><p class='indent'>   <!-- l. 1734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1736 --><p class='indent'>   After explaining the above, we will then explain how to achieve the same bootstrapping without having access to
the secret key <!-- l. 1736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
</p><!-- l. 1739 --><p class='indent'>   <!-- l. 1739 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1741 --><p class='noindent'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span></span><span class='rm-lmssbx-10x-x-109'>: </span>This step forcibly changes the ciphertextâ€™s modulus from
<!-- l. 1741 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
                                                                                         
                                                                                         
<!-- l. 1741 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> and
then decrypts the ciphertext as follows:
</p><!-- l. 1743 --><p class='indent'>   <!-- l. 1743 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
</p><!-- l. 1745 --><p class='indent'>   Notice that the ciphertextâ€™s decrypted plaintext polynomialâ€™s each
<!-- l. 1745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th coefficient gets corrupted
to <!-- l. 1745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>. So, we now need to
eliminate the garbage term <!-- l. 1745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
in each coefficient and distill the pure plaintext coefficient
<!-- l. 1745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>.
</p><!-- l. 1747 --><p class='indent'>   <!-- l. 1747 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1749 --><p class='noindent'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmssbx-10x-x-109'>: </span>This step generates a new plaintext polynomial whose each
<!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th input vector slot stores
the corrupted coefficient <!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
The trick of doing this is to apply CKKSâ€™s batch-encoding mapping
<!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math> (which represents
the transformation <!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math>
as explained in <a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>) to the input vector slots that encode the polynomial
<!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>. Let
<!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math> be the input vector that
corresponds to polynomial <!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>.
Then, <!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math> and
<!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> satisfy the following relation
over the encoding mapping <!-- l. 1749 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>:
</p><!-- l. 1751 --><p class='indent'>   <!-- l. 1751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math> <span style='color:#FF0000;'> # i.e.,
polynomial <!-- l. 1751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math></span>
</p><!-- l. 1753 --><p class='indent'>   This implies that if we <span class='rm-lmri-10x-x-109'>homomorphically </span>apply the
<!-- l. 1753 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math> transformation to the elements
of the input vector <!-- l. 1753 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math>, then
the resulting input vector <!-- l. 1753 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>
will store <!-- l. 1753 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math>â€™s
encoded polynomial coefficient values as follows:
</p><!-- l. 1755 --><p class='indent'>   <!-- l. 1755 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1757 --><p class='indent'>   <span style='color:#FF0000;'> # where <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-bin' stretchy='false'>âˆ˜</mo></math>represents a linear
transformation operation comprising <!-- l. 1757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math></span>
</p><!-- l. 1759 --><p class='indent'>   <!-- l. 1759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1764 --><p class='indent'>   However, remember that at the end of the <span class='rm-lmss-10x-x-109'>ModRaise </span>step, we get the decrypted (but corrupted by
<!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>k</mi></mrow></math>) polynomial
<!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> and we are not allowed to
decode it into <!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math>. Therefore, we
will instead <span class='rm-lmri-10x-x-109'>encode </span>the matrix <!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>
in the encoding transformation <!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>
(<!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math>) into its
equivalent polynomials (treating a matrix as a combination of vectors) and then perform batched slot-wise
<!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math> operation between
                                                                                         
                                                                                         
<!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math> and the polynomial
version of <!-- l. 1764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>.
We express this polynomial-based computation as follows:
</p><!-- l. 1766 --><p class='indent'>   <!-- l. 1766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> <span style='color:#FF0000;'> #
<!-- l. 1767 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math> is the polynomial-encoded
version of the <!-- l. 1767 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>
transformation</span>
</p><!-- l. 1769 --><p class='indent'>   Then, the resulting polynomial <!-- l. 1769 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub></math>â€™s
corresponding input vector slots (i.e., the decoded version of
<!-- l. 1769 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub></math>) will
store <!-- l. 1769 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
In other words, the above computation effectively <span class='rm-lmri-10x-x-109'>moves </span>the coefficients of
<!-- l. 1769 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math> to the
input vector slots of a new plaintext polynomial.
</p><!-- l. 1771 --><p class='indent'>   However, remember that in CKKS, an input vector can store only up to
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> slots, whereas we need
to store a total of <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
coefficients of <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math>
in the input vector slots. Therefore, we technically need to create 2 pieces of
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub></math> as
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>1</mn></mrow></msub></math> and
<!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>2</mn></mrow></msub></math>, where the
input vector of <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>1</mn></mrow></msub></math>
stores <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, and the
input vector of <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>2</mn></mrow></msub></math>
stores <!-- l. 1771 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 1773 --><p class='indent'>   <!-- l. 1773 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1775 --><p class='noindent'><span class='underline'><span class='rm-lmssbx-10x-x-109'>EvalExp</span></span><span class='rm-lmssbx-10x-x-109'>: </span>Our next step is to update <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>â€™s
each element <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> to
<!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> by evaluating it with the sine
function <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. Since the output of the
<span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step is polynomial <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub></math>
(technically <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>1</mn></mrow></msub></math>
and <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi><mn>2</mn></mrow></msub></math>),
we need to apply the evaluation transformation in an encoded form. First, we approximate
<!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as a linear combination
comprising only <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>
operations by using the Taylor series and Eulerâ€™s formula (will be explained later). Then, we encode (i.e.,
<!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Ïƒ</mi></math>)
the approximated formula into a polynomial form, and we denote it as
<!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow></msub></math>. Finally, we
apply the <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow></msub></math>
transformation to <!-- l. 1776 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub></math>
as follows:
</p><!-- l. 1778 --><p class='indent'>   <!-- l. 1778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>s</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> <span style='color:#FF0000;'> # Applying the sine functionâ€™s
                                                                                         
                                                                                         
linear transformation to <!-- l. 1778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>â€™s
each slot storing <!-- l. 1778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math></span>
</p><!-- l. 1780 --><p class='indent'>   <!-- l. 1780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>t</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>Ïƒ</mi><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>t</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>Ïƒ</mi><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msubsup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
</p><!-- l. 1782 --><p class='indent'>   <!-- l. 1782 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1784 --><p class='indent'>   After the linear transformation by the sine function, notice that each
<!-- l. 1784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> term gets eliminated
from <!-- l. 1784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>â€™s slots (i.e. modulo
reduction by <!-- l. 1784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>) and
the resulting vector <!-- l. 1784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>t</mi></mrow></msub></math>
stores only the <!-- l. 1784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
terms.
</p><!-- l. 1796 --><p class='indent'>   <!-- l. 1796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1798 --><p class='noindent'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmssbx-10x-x-109'>: </span>Now  that  we  have  a  polynomial
<!-- l. 1799 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>t</mi></mrow></msub></math> whose corresponding input vector
<!-- l. 1799 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>t</mi></mrow></msub></math>â€™s slots store garbage-removed
coefficients of (i.e., <!-- l. 1799 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>)
our initial plaintext polynomial, our next step is to put these coefficients stored in
<!-- l. 1799 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>t</mi></mrow></msub></math> back to
the polynomial. This is an exact reverse operation of <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>as follows:
</p><!-- l. 1801 --><p class='indent'>   <!-- l. 1801 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msup><mrow><mi>M</mi></mrow><mrow><mi>t</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></math> <span style='color:#FF0000;'> #
<!-- l. 1802 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math> is a polynomial-encoded form
of the batch-decoding formula <!-- l. 1802 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow></math>
(<a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>)</span>
</p><!-- l. 1804 --><p class='indent'>   The result is polynomial <!-- l. 1804 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>b</mi></mrow></msub></math> whose
coefficients are garbage-eliminated (i.e., <!-- l. 1804 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>-free)
versions of <!-- l. 1804 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math>. Finally,
we re-encrypt <!-- l. 1804 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>b</mi></mrow></msub></math>
as <!-- l. 1804 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as
the final modulus-bootstrapped ciphertext.
</p><!-- l. 1807 --><p class='indent'>   <!-- l. 1807 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1809 --><p class='noindent'><span class='underline'><span class='rm-lmssbx-10x-x-109'>Bootstrapping Without a Secret Key</span></span><span class='rm-lmssbx-10x-x-109'>: </span>So far, we have assumed that we have access to the secret key
<!-- l. 1809 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>. With
decryption and re-encryption enabled, the above bootstrapping steps described are mathematically
equivalent to computing the following:
</p><!-- l. 1812 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>INPUT</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   <span style='color:#FF0000;'> # where <!-- l. 1812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></span>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1814 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>Decryption</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1817 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1819 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd><dt class='enumerate-enumitem'>
                                                                                         
                                                                                         
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>EvalExp</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1821 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1823 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>Re-encryption</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 1825 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext class='textbf' mathvariant='bold'>(</mtext></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mstyle class='text'><mtext class='textbf' mathvariant='bold'>)</mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </dd></dl>
<!-- l. 1829 --><p class='indent'>   <!-- l. 1829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1831 --><p class='indent'>   However, the ultimate goal of CKKS bootstrapping is to reset the modulus of a ciphertext from
<!-- l. 1831 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> to
<!-- l. 1831 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> without having
access to <!-- l. 1831 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
</p><!-- l. 1833 --><p class='indent'>   Meanwhile, one important insight is that CKKSâ€™s <span class='rm-lmss-10x-x-109'>ModRaise </span>procedure on the ciphertext
<!-- l. 1833 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> from
<!-- l. 1833 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
effectively transforms the ciphertext into a new one which is an encryption of
<!-- l. 1833 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>. Before <span class='rm-lmss-10x-x-109'>ModRaise</span>,
ciphertext <!-- l. 1833 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>â€™s
decryption relation is as follows:
</p><!-- l. 1835 --><p class='indent'>   <!-- l. 1835 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>
</p><!-- l. 1837 --><p class='indent'>   <!-- l. 1837 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1839 --><p class='indent'>   After <span class='rm-lmss-10x-x-109'>ModRaise </span>to <!-- l. 1839 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
its decryption relation is as follows:
</p><!-- l. 1841 --><p class='indent'>   <!-- l. 1841 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> <span style='color:#FF0000;'>#
because <!-- l. 1841 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math></span>
</p><!-- l. 1843 --><p class='indent'>   <!-- l. 1843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1845 --><p class='indent'>   Therefore, the <span class='rm-lmri-10x-x-109'>mod-raised </span>ciphertext <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
with noise <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>.
Thus, CKKSâ€™s <span class='rm-lmri-10x-x-109'>homomorphic </span>bootstrapping strategy is to run the subsequent
<span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, and <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>steps <span class='rm-lmss-10x-x-109'>homomorphically </span>based on the ciphertext
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
Running these 3 steps consumes a few multiplicative levels due to the ciphertext-to-ciphertext
multiplication operations when homomorphically multiplying the coefficient-to-slot and
slot-to-coefficient transformation matrices and homomorphically computing powers of
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>X</mi></math> (i.e.,
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>k</mi></mrow></msup></math>) during
sine approximation. Therefore, upon completion of these 3 steps, the ciphertext modulus reduces from
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math> (where
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>l</mi></math> is some integer
such that <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>l</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>L</mi></mrow></math>).
</p><!-- l. 1910 --><p class='indent'>   Note that the result of homomorphic bootstrapping is equal to the explicit bootstrapping based on
decryption &amp; re-encryption (if we ignore the small differences in the final ciphertext modulus and the
noise). In the following subsections, we will explain the algebraic details of <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp </span>and
<span class='rm-lmss-10x-x-109'>SlotToCoeff </span>steps.
   
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='details-coefftoslot'><span class='titlemark'>D-3.13.3   </span> <a id='x136-200000D-3.13.3'></a>Details: <span class='rm-lmss-10x-x-109'>CoeffToSlot</span></h5>
<!-- l. 1915 --><p class='noindent'>Homomorphically moving the coefficients of <!-- l. 1915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math>
(i.e., <!-- l. 1915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
for <!-- l. 1915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>) to
a new ciphertextâ€™s input vector slots is mathematically equivalent to homomorphically computing
<!-- l. 1915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>,
which is equivalent to applying the encoding formula to the input vector slot values of
<!-- l. 1915 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>.
</p><!-- l. 1919 --><p class='indent'>   As explained in SummaryÂ D-3.9 (in <a href='HomomorphicRotationofInputVectorSlots1.html#homomorphic-rotation-of-input-vector-slots1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.9<!-- tex4ht:ref: subsec:ckks-rotation  --></a>), the encoding formula for converting an input vector into a list of polynomial
coefficients is <!-- l. 1919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math>,
where <!-- l. 1919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> is a basis of
the <!-- l. 1919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
vector space crafted as follows:
</p><!-- l. 1921 --><p class='indent'>   <!-- l. 1921 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1923 --><p class='noindent'><!-- l. 1923 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>        </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>         <mi>â‹®</mi>         </mtd><mtd class='array-td' columnalign='center'>         <mi>â‹®</mi>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd></mtr> <!-- *\c@MaxMatrixCols c --></mtable>          </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 1931 --><p class='indent'>   <!-- l. 1931 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1933 --><p class='indent'>   <span style='color:#FF0000;'> # where the rotation helper function <!-- l. 1933 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
</p><!-- l. 1935 --><p class='indent'>   <!-- l. 1935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1937 --><p class='indent'>   Therefore, given the input ciphertext <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼</mtext></mstyle></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
whose plaintext polynomial <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math> contains
corrupted coefficients, computing <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>Ïƒ</mi></mrow><mrow><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup><mstyle class='text'><mtext>Â </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼</mtext></mstyle></mrow></msub></mrow></math>
is equivalent to computing <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle>
        </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></math>.
However, one problem here is that each CKKS ciphertext encodes only
<!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> input vector slots, whereas our goal
is to move <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> (corrupted) coefficients
of the plaintext polynomial <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math>
encrypted in <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></math>. Therefore, we will
instead generate 2 ciphertexts, <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ1</mtext></mstyle></mrow></msub></math>
and <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ2</mtext></mstyle></mrow></msub></math>, such that
each <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ1</mtext></mstyle></mrow></msub></math>â€™s input
vector slots store <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>0</mn><mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>i</mi><mo class='MathClass-rel' stretchy='false'>&lt;</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></msub></math>
and <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ2</mtext></mstyle></mrow></msub></math>â€™s input vector
slots store <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>i</mi><mo class='MathClass-rel' stretchy='false'>&lt;</mo><mi>n</mi></mrow></msub></math>.
</p><!-- l. 1939 --><p class='indent'>   We split the <!-- l. 1939 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mi>n</mi></mrow></math>
matrix <!-- l. 1939 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> into
four <!-- l. 1939 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>
matrices as follows:
</p>
   <ul class='itemize1'>
                                                                                         
                                                                                         
   <li class='itemize'><!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>11</mn></mrow></msub></math>:
   a matrix comprising the upper left-half section of <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>
   </li>
   <li class='itemize'><!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>12</mn></mrow></msub></math>:
   a matrix comprising the upper right-half section of <!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>
   </li>
   <li class='itemize'><!-- l. 1944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub></math>:
   a matrix comprising the lower left-half section of <!-- l. 1944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>
   </li>
   <li class='itemize'><!-- l. 1945 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>22</mn></mrow></msub></math>:
   a matrix comprising the lower right-half section of <!-- l. 1945 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math></li></ul>
<!-- l. 1948 --><p class='indent'>   <!-- l. 1948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1950 --><p class='indent'>   Then, we can compute <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ1</mtext></mstyle></mrow></msub></math>
and <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ2</mtext></mstyle></mrow></msub></math> as
follows:
</p><!-- l. 1952 --><p class='indent'>   <!-- l. 1952 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ1</mtext></mstyle></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>11</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><mover accent='false' class='mml-overline'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow><mo accent='true'>Â¯</mo></mover></mstyle>
                         </mrow><mrow><mi>n</mi>                     </mrow></mfrac></mstyle></mrow></math>
</p><!-- l. 1954 --><p class='indent'>   <!-- l. 1954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ2</mtext></mstyle></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>22</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><mover accent='false' class='mml-overline'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow><mo accent='true'>Â¯</mo></mover></mstyle>
                         </mrow><mrow><mi>n</mi>                     </mrow></mfrac></mstyle></mrow></math>
</p><!-- l. 1956 --><p class='indent'>   Each homomorphic matrix-vector multiplication (e.g.,
<!-- l. 1956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow></math>) can be
done in an efficient manner that reduces the number of homomorphic rotations (<a href='ApplicationMatrixMultiplication.html#application-matrix-multiplication'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.10<!-- tex4ht:ref: subsec:ckks-rotation  --></a>).
<!-- l. 1956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='italic'><mover accent='false' class='mml-overline'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow><mo accent='true'>Â¯</mo></mover></mstyle></math> can be
computed by applying homomorphic conjugation to <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>c</span></sub> (<a href='HomomorphicConjugation.html#homomorphic-conjugation'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.11<!-- tex4ht:ref: subsec:ckks-rotation  --></a>).
   
</p>
   <h5 class='subsubsectionHead' id='details-evalexp'><span class='titlemark'>D-3.13.4   </span> <a id='x136-201000D-3.13.4'></a>Details: <span class='rm-lmss-10x-x-109'>EvalExp</span></h5>
<!-- l. 1963 --><p class='noindent'>We will use the sine function <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
to approximately eliminate <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
from <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> by computing
<!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>. This approximation
works if <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> is
very close to <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>
relative to <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> (i.e.,
<!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>). Still, the
elimination of <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> is
approximate (i.e., <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>),
because <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is
<!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi>x</mi></mrow></math> nearby
                                                                                         
                                                                                         
<!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>, not
exactly <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math>.
</p><!-- l. 1965 --><p class='indent'>   One issue is that we need to evaluate <!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
homomorphically based on <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s1</span></sub> and <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s2</span></sub> as inputs (i.e.,
<!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ—Œ1</mtext></mrow></msub></mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
<!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ—Œ2</mtext></mrow></msub></mtext></mstyle><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>), but FHE
supports only <!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>
operations, whereas the sine graph cannot be formulated by only
<!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>. Therefore, we will
approximate the sine function <!-- l. 1965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
by using the Taylor series (<a href='TaylorSeries.html#taylor-series'><span class='ts1-lmr10-x-x-109'>Â§</span>A-14<!-- tex4ht:ref: subsec:ckks-rotation  --></a>):
</p><!-- l. 1967 --><p class='indent'>   <!-- l. 1967 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>f</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo>
  </mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>!</mo>  </mrow></mfrac></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>f</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo>
  </mrow><mrow><mn>2</mn><mo class='MathClass-punc' stretchy='false'>!</mo>  </mrow></mfrac></mstyle><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>f</mi></mrow><mrow><mi>â€´</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo>
  </mrow><mrow><mn>3</mn><mo class='MathClass-punc' stretchy='false'>!</mo>  </mrow></mfrac></mstyle><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>d</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>âˆ</mi></mrow></munderover><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>f</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>d</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo>
   </mrow><mrow><mi>d</mi><mo class='MathClass-punc' stretchy='false'>!</mo>    </mrow></mfrac></mstyle><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>a</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>d</mi></mrow></msup></mrow></math>
</p><!-- l. 1969 --><p class='indent'>   <!-- l. 1969 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1971 --><p class='indent'>   If we approximate <!-- l. 1971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
around <!-- l. 1971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
then the approximated polynomial is as follows:
</p><!-- l. 1973 --><p class='indent'>   <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mn>0</mn></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mstyle><mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mn>0</mn></mrow><mo fence='true' form='postfix'>)</mo></mrow>
     </mrow><mrow><mn>1</mn><mo class='MathClass-punc' stretchy='false'>!</mo>      </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>x</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mn>0</mn></mrow><mo fence='true' form='postfix'>)</mo></mrow>
       </mrow><mrow><mn>2</mn><mo class='MathClass-punc' stretchy='false'>!</mo>       </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
</p><!-- l. 1975 --><p class='indent'>   <!-- l. 1975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>âˆ</mi></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>j</mi></mrow></msup>
</mrow><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mi>j</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>!</mo></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mrow><mrow><mn>2</mn><mi>j</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 1977 --><p class='indent'>   <!-- l. 1977 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>h</mi></mrow></munderover> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>j</mi></mrow></msup>
</mrow><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mi>j</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>!</mo></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mrow><mrow><mn>2</mn><mi>j</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1979 --><p class='indent'>   <!-- l. 1979 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1981 --><p class='indent'>   , where <!-- l. 1981 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is a <!-- l. 1981 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mi>h</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial.
</p><!-- l. 1983 --><p class='indent'>   Remember that in the RLWE cryptosystem, <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ´ğ‘†</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>,
or <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ´ğ‘†</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> with some polynomial
<!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math> representing the wrapping
around values of modulo <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
Since the secret key <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math> is an
<!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial whose
coefficients are small (i.e., <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>),
the coefficients of <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math>
will have some <span class='rm-lmri-10x-x-109'>reasonably small </span>upper bound, which decreases with the sparsity of
<!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math> (i.e., the frequency of 0 coefficients
in <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>). Therefore, the degree of our
approximated <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> only needs to be
high enough to accurately evaluate <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>y</mi></math>
values between <!-- l. 1983 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><msub><mrow><mi>ğ‘˜</mi></mrow><mrow><mi mathvariant='italic'>ğ‘šğ‘ğ‘¥</mi></mrow></msub></mstyle> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><msub><mrow><mi>ğ‘˜</mi></mrow><mrow><mi mathvariant='italic'>ğ‘šğ‘ğ‘¥</mi></mrow></msub></mstyle></mrow></math>.
The required minimum degree of our approximated Taylor polynomial
<!-- l. 1984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> increases with
<!-- l. 1984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle mathvariant='italic'><msub><mrow><mi>ğ‘˜</mi></mrow><mrow><mi mathvariant='italic'>ğ‘šğ‘ğ‘¥</mi></mrow></msub></mstyle></mrow></math> (i.e., the upper
bound of <!-- l. 1984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>).
                                                                                         
                                                                                         
Our one issue is that the computation overhead for homomorphic evaluation of a polynomial
generally increases exponentially with the degree of the polynomial, which will slow down
bootstrapping. To reduce this computation cost, we will leverage Eulerâ€™s formula (<a href='EulersFormula.html#eulers-formula'><span class='ts1-lmr10-x-x-109'>Â§</span>A-11<!-- tex4ht:ref: subsec:ckks-rotation  --></a>) and its square
arithmetic:
</p>
   <table class='equation-star'><tr><td>
<!-- l. 1986 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'>
<mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi><mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mn>2</mn><mi>ğœƒ</mi></mrow></msup>           <mspace class='quad' width='1em'></mspace></mtd></mtr>   <!-- @{}l@{\quad }l@{} --></mtable>                                                                     </mrow><mo fence='true' form='postfix'></mo></mrow> </mrow>
</math></td></tr></table>
<!-- l. 1993 --><p class='indent'>   By substituting <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœƒ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow></math>, we will use Eulerâ€™s
formula. We will also approximate <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></math>
with the Taylor series, but instead of directly approximating
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></math>, we will first approximate
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac> </mrow></msup></math> for some large
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></math>. After that, we will
iteratively square <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac> </mrow></msup></math> a total
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>r</mi></math> times. Then, we get an
approximation of <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac> </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup>
   </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></mrow></math>. The reason why
we start with the approximation of <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac> </mrow></msup></math>
instead of <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></math>
is that its approximation requires a small degree of polynomial, as
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>ğœƒ</mi>
</mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></math>
(i.e., the input to the complex exponential function) is small provided
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup></math> is sufficiently large.
Specifically, we learned that <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
(<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>) is upper-bounded
by <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle mathvariant='italic'><msub><mrow><mi>ğ‘˜</mi></mrow><mrow><mi mathvariant='italic'>ğ‘šğ‘ğ‘¥</mi></mrow></msub></mstyle></mrow></math>, thus
<!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœƒ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow></math> is upper-bounded
by <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>Ï€</mi><mstyle mathvariant='italic'><msub><mrow><mi>ğ‘˜</mi></mrow><mrow><mi mathvariant='italic'>ğ‘šğ‘ğ‘¥</mi></mrow></msub></mstyle>
    </mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup>    </mrow></mfrac></mstyle></math>. As the targeted
range of <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> for
approximation in <!-- l. 1993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is small, we need a small degree of Taylor series polynomial.
</p><!-- l. 1995 --><p class='indent'>   Using the Taylor series with degree <!-- l. 1995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
                                                                                         
                                                                                         
around <!-- l. 1995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>, we can
approximate <!-- l. 1995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘–ğ‘¥</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac> </mrow></msup></math>
as:
</p><!-- l. 1997 --><p class='indent'>   <!-- l. 1997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>e</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘–ğ‘¥</mi></mrow>
<mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac> </mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo></mrow><mrow><mi>d</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></munderover><mstyle displaystyle='true'><mfrac><mrow> <mn>1</mn>
</mrow><mrow><mi>d</mi><mo class='MathClass-punc' stretchy='false'>!</mo></mrow></mfrac></mstyle><msup><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘–ğ‘¥</mi>
</mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> </mrow><mrow><mi>d</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>e</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 1999 --><p class='indent'>   <!-- l. 1999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2001 --><p class='indent'>   Then, we iteratively square <!-- l. 2001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>e</mi></mrow></msub></math>
total <!-- l. 2001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>r</mi></math>
times to get:
</p><!-- l. 2003 --><p class='indent'>   <!-- l. 2003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>e</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup>
   </mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>e</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><msup><mrow><mn>2</mn></mrow><mrow><mi>r</mi></mrow></msup>
   </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></mrow></math>
</p><!-- l. 2005 --><p class='indent'>   <!-- l. 2005 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2007 --><p class='indent'>   Then, based on Eulerâ€™s formula <!-- l. 2007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi></mrow></math>,
we can derive the following relations:
</p><!-- l. 2009 --><p class='indent'>   <!-- l. 2009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2011 --><p class='indent'>   <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='false' class='mml-overline'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup></mrow><mo accent='true'>Â¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='false' class='mml-overline'><mrow><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi></mrow><mo accent='true'>Â¯</mo></mover></mrow></math>
</p><!-- l. 2013 --><p class='indent'>   <!-- l. 2013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi></mrow></math>
</p><!-- l. 2015 --><p class='indent'>   <!-- l. 2015 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mstyle><mi class='loglike'>cos</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>i</mi><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mi>ğœƒ</mi></mrow></math>
</p><!-- l. 2017 --><p class='indent'>   <!-- l. 2017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 2019 --><p class='indent'>   <!-- l. 2019 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>ğœƒ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>ğœƒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 2021 --><p class='indent'>   <!-- l. 2021 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2023 --><p class='indent'>   Substituting <!-- l. 2023 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœƒ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow></math>,
we finally get:
</p><!-- l. 2025 --><p class='indent'>   <!-- l. 2025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 2027 --><p class='indent'>   <!-- l. 2027 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2029 --><p class='indent'>   Using the final relation above, the <span class='rm-lmss-10x-x-109'>EvalExp </span>step homomorphically evaluates the approximation of
<!-- l. 2029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>
</mrow><mrow><mn>2</mn><mi>Ï€</mi></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math> where
<!-- l. 2029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> as
follows:
</p><!-- l. 2032 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Homomorphically approximately compute <!-- l. 2032 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Homomorphically approximately compute <!-- l. 2033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='false' class='mml-overline'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo accent='true'>Â¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup></mrow></math>
   by applying homomorphic conjugation. (<a href='HomomorphicConjugation.html#homomorphic-conjugation'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.11<!-- tex4ht:ref: subsec:ckks-rotation  --></a>) to <!-- l. 2033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Homomorphically compute <!-- l. 2034 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mover accent='false' class='mml-overline'><mrow><mover accent='true'><mrow><mi>f</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo accent='true'>Â¯</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mfrac><mrow><mn>2</mn><mi mathvariant='italic'>ğœ‹ğ‘¥</mi></mrow>
 <mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac>  </mrow></msup></mrow></math>,
   and then multiply the result by <!-- l. 2034 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi>
 </mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
   encoded as CKKS plaintext.</dd></dl>
<!-- l. 2037 --><p class='indent'>   <!-- l. 2037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2039 --><p class='indent'>   The result of <span class='rm-lmss-10x-x-109'>EvalExp </span>is two ciphertexts whose input vector slots store the bootstrapped coefficients of
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>c</mi></mrow></msub></math>, which are
modulo-reduced <!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
from <!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> to
                                                                                         
                                                                                         
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub></mrow></math>. Note
that <!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub></math> is
a bootstrapping error introduced by the following three factors: (1) the intrinsic homomorphic
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>
computation noises of the <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, and <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>steps; (2) the
<span class='rm-lmss-10x-x-109'>EvalExp </span>stepâ€™s Taylor polynomial approximation error of the exponential function
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></math>;
(3) the <span class='rm-lmss-10x-x-109'>EvalExp </span>stepâ€™s sine graph error, since the graph is not exactly
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math> around
<!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>, but
only <!-- l. 2039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi>x</mi></mrow></math>.
</p><!-- l. 2041 --><p class='indent'>   Note that since the output of the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step was split into 2 ciphertexts (<span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s1</span></sub> and <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s2</span></sub>), the
output of the <span class='rm-lmss-10x-x-109'>EvalExp </span>step is also in 2 ciphertexts: (<span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b1</span></sub> and <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b2</span></sub>). The input vector slots of <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b1</span></sub> store
<!-- l. 2041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mfrac><mrow><mi>n</mi></mrow> 
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math>, whereas the input vector
slots of <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b2</span></sub> store <!-- l. 2041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math>.
   
</p>
   <h5 class='subsubsectionHead' id='details-slottocoeff'><span class='titlemark'>D-3.13.5   </span> <a id='x136-202000D-3.13.5'></a>Details: <span class='rm-lmss-10x-x-109'>SlotToCoeff</span></h5>
<!-- l. 2047 --><p class='noindent'>This step is an exact inverse of the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step, which is moving the bootstrapped (i.e. modulo-reduced
<!-- l. 2047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>) coefficients
of <!-- l. 2047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>v</mi></mrow></msub></math>
stored in the input vector slots back to the final plaintext polynomial
<!-- l. 2047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>M</mi></mrow><mrow><mi>f</mi></mrow></msub></math>.
Remember that the decoding formula from a polynomial to an input vector (<a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!-- tex4ht:ref: subsec:ckks-rotation  --></a>) is
<!-- l. 2047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi>
 </mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow></math>,
where:
</p><!-- l. 2052 --><p class='indent'>   <!-- l. 2052 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>â‹®</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>â‹®</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2064 --><p class='indent'>   <!-- l. 2064 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2066 --><p class='indent'>   <!-- l. 2066 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2068 --><p class='indent'>   We denote <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>11</mn></mrow></msub></math>,
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>12</mn></mrow></msub></math>,
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub></math>, and
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>22</mn></mrow></msub></math> as
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>Ã—</mo><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></mrow></math>
matrices corresponding to the upper-left, upper-right, lower-left, and lower-right sections of
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>. Then,
homomorphically applying the decoding formula results in the final bootstrapped ciphertext <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>final</span></sub> modulo
                                                                                         
                                                                                         
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math> whose plaintext polynomial
is garbage-eliminated from <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
to <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>E</mi></mrow><mrow><mi>b</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
(where <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>E</mi></mrow><mrow><mi>b</mi></mrow></msub></math>
is the bootstrapping error polynomial). Note that the ciphertext modulus changed from
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math> because we
consumed some multiplicative levels for computing ciphertext-to-ciphertext multiplications during polynomial
evaluation (i.e., <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>k</mi></mrow></msup></math>).
We can derive <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>final</span></sub> by homomorphically applying the decoding transformation
<!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mi>T</mi> </mrow></msub></math> to the
results of the <span class='rm-lmss-10x-x-109'>EvalExp </span>step (<span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b1</span></sub> and <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>b2</span></sub>) as follows:
</p><!-- l. 2070 --><p class='indent'>   <!-- l. 2070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¿ğ—‚ğ—‡ğ–ºğ—…</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>E</mi></mrow><mrow><mi>b</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>11</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–»1</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–»2</mtext></mrow></msub></mtext></mstyle></mrow></math>
</p><!-- l. 2072 --><p class='indent'>   Note that we do not use <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub></math> and
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>22</mn></mrow></msub></math>, because we only need to derive
the <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> input vector slots whose
decoding would result in the <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
coefficients <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math> of
the final <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial. Once we generate a new ciphertext <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>final</span></sub> whose
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> input vector
slots store <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘ğ‘–</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup></math>,
then its latter <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
conjugate slots get automatically filled with the conjugates of the first
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> slot
values.
   
</p>
   <h5 class='subsubsectionHead' id='reducing-the-bootstrapping-overhead-by-sparsely-packing-ciphertext'><span class='titlemark'>D-3.13.6   </span> <a id='x136-203000D-3.13.6'></a>Reducing the Bootstrapping Overhead by Sparsely Packing Ciphertext</h5>
<!-- l. 2085 --><p class='noindent'>In many cases, the application of CKKS may use only a small number of input vector slots (e.g.,
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>) out of
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> slots. Suppose
that such <!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> is some
number that divides <!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
Then, we can do a series of homomorphic rotations and multiplications to make the input vector slots store
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math> repetitions of the
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>-slot values. Specifically,
we can do this in total <!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
rounds of rotations and additions: initially, we zero-mask between the
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>-th slot and the
                                                                                         
                                                                                         
<!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>-th slots and save as <span class='rm-lmss-10x-x-109'>ct</span>,
and then in each <!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
round we compute <!-- l. 2085 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ—ˆğ—ğ–ºğ—ğ–¾</mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mn>2</mn></mrow><mrow><mi>i</mi></mrow></msup><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>.
</p><!-- l. 2087 --><p class='indent'>   Then, we apply the optimization of sparsely packing ciphertext in SummaryÂ <a href='SparselyPackingCiphertexts.html#sparsely-packing-ciphertexts'>D-3.12<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a> (<a href='SparselyPackingCiphertexts.html#sparsely-packing-ciphertexts'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.12<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>): if an
<!-- l. 2087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional input vector is
structured as <!-- l. 2087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math> consecutive
repetitions of the first <!-- l. 2087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math> slot values,
then its encoded polynomial <!-- l. 2087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„¤</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
has the structure such that all its coefficients whose degree term is not a multiple of
<!-- l. 2087 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math> are
zero as follows:
</p><!-- l. 2089 --><p class='indent'>   <!-- l. 2089 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac> </mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>.
</p><!-- l. 2091 --><p class='indent'>   Remember that in the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step (<a href='#details-coefftoslot'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.3<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>), we use the formula
<!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math> to move the
<!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>k</mi></mrow></math>-contaminated
polynomialâ€™s coefficients to the input vector slots. But by the principle of sparsely packed ciphertext, we know that all
the slots of <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></math> which are
not a multiple of <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
slots would store a zero coefficient. This means that we will get the same computation result even if we only compute the
<!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
       </mrow><mrow><mi>n</mi>       </mrow></mfrac></mstyle></mrow></math> formula with the rows of
<!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> whose row index is a multiple of
<!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>. Mathematically, we can update
the encoding formula to <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub>
      </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>     </mrow></mfrac></mstyle></mrow></math> where
the <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>Ã—</mo> <mfrac><mrow><mi>n</mi></mrow> 
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></math> matrix <mtext style='transform:rotate(-180deg)'>E</mtext> is an elimination
of all those columns from <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> whose
column index is not a multiple of <!-- l. 2091 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>:
</p><!-- l. 2093 --><p class='indent'><!-- l. 2093 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''><mtr class='array-row'><mtd class='array-td' columnalign='center'>           <mn>1</mn>           </mtd><mtd class='array-td' columnalign='center'>           <mn>1</mn>           </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>         <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>           <mn>1</mn>           </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>            </mtd><mtd class='array-td' columnalign='center'>            <mn>1</mn>            </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>      <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>      </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>     <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>      </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'>             <mi>â‹®</mi>         </mtd><mtd class='array-td' columnalign='center'>         <mi>â‹®</mi>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'>         <mi>â‹®</mi>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>          <mi>â‹®</mi>          </mtd><mtd class='array-td' columnalign='center'>          <mi>â‹®</mi>          </mtd>
</mtr><mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mi>â‹®</mi> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>1</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mn>0</mn><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>n</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi> </mrow> </msup> </mrow> </mfrac><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>     <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                                                     </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2101 --><p class='indent'>   <!-- l. 2101 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2103 --><p class='indent'>   Remember that in the original <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step (<a href='#details-coefftoslot'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.3<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>), we had to split <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s</span></sub>
into <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s1</span></sub> and <span class='rm-lmss-10x-x-109'>ct</span><sub><span class='rm-lmss-10x-x-109'>s2</span></sub> because in CKKS each input vector can store a maximum of
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> slots but we need
to move a total of <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
coefficient values to the input vector slots for bootstrapping. On the other hand, the computation
result of the above updated encoding formula (using a sparsely packed ciphertext) is
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>, having only
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></math> coefficient slots instead
of <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> coefficient slots,
and each slot index <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>
                                                                                         
                                                                                         
in <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>s</mi></mrow></msub></math>
corresponds to the encoded polynomialâ€™s coefficient with degree term
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math> (we do not
compute any other coefficient terms, because we know that they are 0 anyway, so no need to bootstrap them). And
notice that <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo> <mfrac><mrow><mi>n</mi></mrow> 
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>,
because <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> divides
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>. Therefore, without
computing two ciphertexts <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ1</mtext></mstyle></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>11</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><mover accent='false' class='mml-overline'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow><mo accent='true'>Â¯</mo></mover></mstyle></mrow></math> and
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle></mrow><mrow>
<mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ—Œ2</mtext></mstyle></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>21</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>]</mo></mrow><mrow><mn>22</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='italic'><mover accent='false' class='mml-overline'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle></mrow><mo accent='true'>Â¯</mo></mover></mstyle></mrow></math> separately, we can directly
compute <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—<msub><mrow></mrow><mrow><mtext>ğ–¼</mtext></mrow></msub></mtext></mstyle>
       </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>     </mrow></mfrac></mstyle></mrow></math>, because all coefficients
for bootstrapping fit in <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
slots. Therefore, the number of homomorphic computations and memory requirement for the <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>
step can be reduced by half. And the same is true for the <span class='rm-lmss-10x-x-109'>EvalExp </span>step (<a href='#details-evalexp'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.4<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>).
</p><!-- l. 2105 --><p class='indent'>   Similarly, as for the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step (<a href='#details-slottocoeff'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.5<!-- tex4ht:ref: subsec:ckks-sparse-packing  --></a>), we update the decoding formula
<!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi>
 </mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow></math> to
<!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><msup><mrow></mrow><mrow><mi>â€²</mi>
 </mrow></msup></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle></mrow><mrow><mi>T</mi> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></mrow></math>. This again
reduces the number of homomorphic computations and memory requirements for the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step by half.
Notice that <!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle></mrow><mrow><mi>T</mi> </mrow></msup></math>
is a matrix where those columns whose column index is not a multiple of
<!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math> are zero. This zero-enforcement
to the columns of <!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle></mrow><mrow><mi>T</mi> </mrow></msup></math> still outputs the
same computation result, because <!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow><mrow><mi>c</mi></mrow></msub></math>
is a vector such that those slots whose slot index is not a multiple of
<!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
are zero, which makes the computation result with their corresponding columns of
<!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mstyle class='text'><mstyle><mtext style='transform:rotate(-180deg)'>E</mtext></mstyle></mstyle></mrow><mrow><mi>T</mi> </mrow></msup></math> (i.e., the columns whose
index is not a multiple of <!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>)
zero, anyway.
   
</p>
   <h5 class='subsubsectionHead' id='summary5'><span class='titlemark'>D-3.13.7   </span> <a id='x136-204000D-3.13.7'></a>Summary</h5>
<!-- l. 2112 --><p class='noindent'>We summarize the CKKS bootstrapping procedure as follows.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-101'>     
<div class='tcolorbox-title'>
<!-- l. 2183 --><p class='indent'>   <!-- l. 2183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>SummaryÂ D-3.13.7</span><!-- l. 2183 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>CKKS Bootstrapping</span></p></div> 
<div class='tcolorbox-content'>   <dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>INPUT</span></span><span class='rm-lmssbx-10x-x-109'>: </span><!-- l. 2119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     <span style='color:#FF0000;'> # where <!-- l. 2119 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math></span>
    <!-- l. 2121 --><p class='noindent'><!-- l. 2121 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2123 --><p class='noindent'>, which satisfies the decryption relation: <!-- l. 2123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     </p><!-- l. 2125 --><p class='noindent'><!-- l. 2125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
     </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span></span><span class='rm-lmssbx-10x-x-109'>: </span>View the polynomials <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>A</mi></math>
   and <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>B</mi></math>
   as        plaintext        polynomials        whose        each        coefficient        is        in
    <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â„¤</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></msub></math>
     (i.e., <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>).
    This     change     of     viewpoint     automatically     changes     the     ciphertext     as
    <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    The <span class='rm-lmss-10x-x-109'>ModRaise </span>step does not require any actual computation.
    <!-- l. 2129 --><p class='noindent'><!-- l. 2129 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmssbx-10x-x-109'>:</span>
   <!-- l. 2147 --><p class='noindent'>Move the coefficients of the encrypted plaintext
    <!-- l. 2147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>
   to the input vector slots by homomorphically multiplying
    <!-- l. 2147 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> to
    it follows:
    </p><!-- l. 2149 --><p class='noindent'><!-- l. 2149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>Z</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
    </p><!-- l. 2151 --><p class='noindent'><!-- l. 2151 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
4.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>EvalExp</span></span><span class='rm-lmssbx-10x-x-109'>:</span>
   <!-- l. 2155 --><p class='noindent'>Remove the wrap-around garbage value <!-- l. 2155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math>
   in <!-- l. 2155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mi>K</mi></mrow></math> by homomorphically
    evaluating the polynomial <!-- l. 2155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow></msub></math>
    which approximates a sine function with period
    <!-- l. 2155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math> as
    follows:
    </p><!-- l. 2157 --><p class='noindent'><!-- l. 2157 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>Z</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>Ïƒ</mi></mrow><mrow><mi>f</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>Z</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
    </p><!-- l. 2159 --><p class='noindent'><!-- l. 2159 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2161 --><p class='noindent'>This step is equivalent to <span class='rm-lmri-10x-x-109'>homomorphically </span>performing modulo reduction by
    <!-- l. 2161 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
     to the input value. This step reduces the ciphertext modulus from
    <!-- l. 2161 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math> as
    it consumes multiplicative levels when homomorphically evaluating the polynomial
    approximation of the sine function.
    </p><!-- l. 2163 --><p class='noindent'><!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
5.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmssbx-10x-x-109'>:</span>
   <!-- l. 2167 --><p class='noindent'>Move the modulo-<!-- l. 2167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-reduced
    plaintext value <!-- l. 2167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>
   stored in the input vector slots back to the plaintext coefficient positions by homomorphically multiplying the
    encoding matrix <!-- l. 2167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>
   as follows:
    </p><!-- l. 2169 --><p class='noindent'><!-- l. 2169 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>Z</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
    </p><!-- l. 2171 --><p class='noindent'><!-- l. 2171 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math></p></dd></dl>
<!-- l. 2179 --><p class='noindent'><!-- l. 2179 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2181 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Limitation: </span>The noise slowly grows over each bootstrapping due to the bootstrapping error and
will eventually overflow the message and the ciphertext modulus.
</p>
 
</div> 
</div>                                                                   
                                                                                         
<!-- l. 2186 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Comparison between BFV and CKKS Bootstrapping: </span>In the case of
CKKSâ€™s bootstrapping, it does not reduce the magnitude of the old noise
<!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>
and keeps it the same as before, because the sine approximation function converts
<!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math> into
<!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>.
However, as the ciphertext modulus gets increased from
<!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>, the noise-to-ciphertext-modulus
ratio decreases, since <!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>E</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><mstyle displaystyle='true'><mfrac><mrow><mi>E</mi>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></mfrac></mstyle></mrow></math>.
On the other hand, the bootstrapping procedure introduces a new bootstrapping noise, which can be
viewed as a fixed amount. However, this fixed amount of new noise accumulates over each bootstrapping.
Therefore, after a very large number of bootstrappings, the noise will eventually overflow the message and
even the ciphertext modulus.
</p><!-- l. 2188 --><p class='indent'>   In the case of BFVâ€™s bootstrapping, it reduces the noise, but does not change the ciphertext modulus.
However, there is no need to reset the ciphertext modulus, because BFV does not have a
leveled ciphertext modulus chain, and BFVâ€™s ciphertext-to-ciphertext multiplication does not
consume ciphertext modulus. Furthermore, since BFVâ€™s bootstrapping directly removes the noise,
the noise is guaranteed to be kept under a certain threshold even after an infinite number of
bootstrappings.
</p><!-- l. 2190 --><p class='indent'>   Another important difference is that CKKSâ€™s bootstrapping does not require homomorphic decryption,
primarily because it maintains the plaintextâ€™s scaling factor to be the same across the entire bootstrapping
procedure. On the other hand, BFVâ€™s bootstrapping needs to change the plaintextâ€™s scaling factor to run the
digit extraction algorithm. Therefore, homomorphic decryption is required to change the plaintext scaling factor
(<!-- l. 2190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>) while preserving the same
ciphertext modulus (<!-- l. 2190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>).
   
</p>
   <h5 class='subsubsectionHead' id='reducing-the-bootstrapping-noise'><span class='titlemark'>D-3.13.8   </span> <a id='x136-205000D-3.13.8'></a>Reducing the Bootstrapping Noise</h5>
<!-- l. 2199 --><p class='noindent'>As explained in <a href='#details-evalexp'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.4<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a>, the bootstrapping procedure generates three types of noises:
</p>
   <ul class='itemize1'>
   <li class='itemize'><span class='underline'>Type-1 Noise</span>: the intrinsic homomorphic <!-- l. 2203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math>
   computation noises of the <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, <span class='rm-lmss-10x-x-109'>EvalExp</span>, and <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>steps
   </li>
   <li class='itemize'><span class='underline'>Type-2 Noise</span>: the <span class='rm-lmss-10x-x-109'>EvalExp </span>stepâ€™s approximation error of the exponential function <!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>e</mi></mrow><mrow><mi mathvariant='italic'>ğ‘–ğœƒ</mi></mrow></msup></math>
   </li>
   <li class='itemize'><span class='underline'>Type-3 Noise</span>: the <span class='rm-lmss-10x-x-109'>EvalExp </span>stepâ€™s sine graph error (i.e., not exactly <!-- l. 2205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math>
   around <!-- l. 2205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>x</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   but only <!-- l. 2205 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mi>x</mi></mrow></math>)</li></ul>
                                                                                         
                                                                                         
<!-- l. 2210 --><p class='indent'>   <!-- l. 2210 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2213 --><p class='indent'>   The Type-1 noise is inevitable by the design of FHE. The Type-2 noise can be either avoided or
unavoidable depending on the tradeoff setup between the bootstrapping accuracy and efficiency. Unlike
these two types of noises, the Type-3 noise can be effectively reduced by newer bootstrapping
techniques.
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 2217 --><p class='noindent' id='arcsine-graph-for-smaller-approximation-error-httpswwwgooglecomsearchscaesvccbdebesxsrfadlywikkaffcafvjcehjsoeqftaowqarcsinsinxsourcelnmsfbsaeqnmdmkhoysbchazhzscwualwleusitemypftxsfzgzcfxnmxytvjvqrehpyicpzjthxkelijctcpfbyuloafvqmwkvjfntzsbnwccjlnswfnwwijckabjsdpgkprhqvkhpyoywxmhtccvrdbcrranmjzczrttkwfwtmiesaxvedahukewjzyqtejaxxbhlybhxdiveqpqjegqidxabcshidbiwbihdprsource'><img alt='PIC' src='figures/arc-sine.png' /> <a id='x136-205001r17'></a></p>
<figcaption class='caption'><span class='id'>FigureÂ 17: </span><span class='content'>Arc-sine graph for smaller approximation error <a href='https://www.google.com/search?sca_esv=c744cb070de47b7e&amp;sxsrf=ADLYWIKKaF93fcAFvJC4ehJso1E5qFTaow:1732546684173&amp;q=arcsin(sin(x))&amp;source=lnms&amp;fbs=AEQNm0DmKhoYsBCHazhZSCWuALW8l8eUs1i3TeMYPF4tXSfZ95GzcfXnm5XYTvJV_9Qreh2py964ICpZJthXkELijctC8pFBYULoa3-fvQmwK0VJF0ntzsbN_W2CCJL9N57SWFNwWI58jCKaBJSdPgkprHQVK8H1PYOYWXMHTCCV-rDbC44rR6ANM870jZCZRtTKwFWtMIe2&amp;sa=X&amp;ved=2ahUKEwjZy6qt3_eJAxXbhlYBHXD2IvEQ0pQJegQIDxAB&amp;cshid=1732546705369143&amp;biw=1280&amp;bih=635&amp;dpr=1.5'>(Source)</a>                            </span></figcaption><!-- tex4ht:label?: x136-205001r17  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 2222 --><p class='indent'>   <!-- l. 2222 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2224 --><p class='noindent'><!-- l. 2224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi class='loglike'>ğšğ«ğœğ¬ğ¢ğ§</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mstyle><mi class='loglike'>ğ¬ğ¢ğ§</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğ±</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Approximation (</span><a href='https://dl.acm.org/doi/10.1007/978-3-030-77870-5_22'><span class='rm-lmbx-10x-x-109'>EUROCRYPT 2021</span></a><span class='rm-lmbx-10x-x-109'>Â </span><span class='cite'><span class='rm-lmbx-10x-x-109'>[</span><a href='refname.html#Xcryptoeprint_2020_552'><span class='rm-lmbx-10x-x-109'>19</span></a><span class='rm-lmbx-10x-x-109'>]</span></span><span class='rm-lmbx-10x-x-109'>): </span>Using the
<!-- l. 2224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>arcsin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mstyle><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo></mstyle><!-- nolimits --><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> function
instead of the <!-- l. 2224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>â¡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --><mi>x</mi></mrow></math>
function can reduce the Type-3 noise, because its line is not curved but straight, as shown in <a href='#arcsine-graph-for-smaller-approximation-error-httpswwwgooglecomsearchscaesvccbdebesxsrfadlywikkaffcafvjcehjsoeqftaowqarcsinsinxsourcelnmsfbsaeqnmdmkhoysbchazhzscwualwleusitemypftxsfzgzcfxnmxytvjvqrehpyicpzjthxkelijctcpfbyuloafvqmwkvjfntzsbnwccjlnswfnwwijckabjsdpgkprhqvkhpyoywxmhtccvrdbcrranmjzczrttkwfwtmiesaxvedahukewjzyqtejaxxbhlybhxdiveqpqjegqidxabcshidbiwbihdprsource'>FigureÂ 17<!-- tex4ht:ref: subsubsec:ckks-bootstrapping-summary  --></a> (comprising
a series of <!-- l. 2224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math>
and <!-- l. 2224 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>x</mi></mrow></math>
segments). This technique also uses the Remez algorithm that evenly distributes the approximation error
over a specified region. However, one downside of this technique is that it consumes 3 multiplicative
levels.
</p><!-- l. 2226 --><p class='indent'>   <!-- l. 2226 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2228 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Meta-BTS (</span><a href='https://dl.acm.org/doi/10.1145/3548606.3560696'><span class='rm-lmbx-10x-x-109'>CCS 2022</span></a><span class='rm-lmbx-10x-x-109'>Â </span><span class='cite'><span class='rm-lmbx-10x-x-109'>[</span><a href='refname.html#Xcryptoeprint_2022_1167'><span class='rm-lmbx-10x-x-109'>20</span></a><span class='rm-lmbx-10x-x-109'>]</span></span><span class='rm-lmbx-10x-x-109'>): </span>This is thus far the most computationally efficient and accurate
bootstrapping technique, whose procedure is as follows:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Perform the regular bootstrapping based on the sine graph to the input ciphertext.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Rescale step 1â€™s bootstrapped ciphertext to modulus <!-- l. 2231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Subtract step 2â€™s ciphertext from the initial un-bootstrapped ciphertext (where both ciphertexts
   are modulo <!-- l. 2232 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>),
   whose result is a modulo <!-- l. 2232 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   ciphertext storing the bootstrapping error.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Bootstrap the output ciphertext of step 3 (storing the bootstrapping error) to modulus <!-- l. 2233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>.
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>Subtract step 4â€™s ciphertext from step 1â€™s ciphertext (where both ciphertexts are modulo <!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>),
   which gives a new modulo <!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
   ciphertext with a reduced bootstrapping error.</dd></dl>
<!-- l. 2237 --><p class='indent'>   <!-- l. 2237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2239 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Limitation in Noise Handling: </span>The above bootstrapping techniques can reduce the Type-3 noise,
because the bootstrapping error is smaller than the plaintext message and a smaller input
<!-- l. 2239 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
value to the approximating sine function outputs a value closer to
<!-- l. 2239 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>x</mi></mrow></math>.
Running this algorithm multiple times, the Type-3 noise becomes exponentially smaller, because the size
of the target plaintext (i.e., the extracted bootstrapping error as the output of step 3 above) is much
smaller than before. Meanwhile, Type-1 and Type-2 noises do not decrease over multiple bootstrapping
rounds, relatively keeping their same level, because each round generates new Type-1 and Type-2
noises.
                                                                                         
                                                                                         
</p>
   <!-- l. 628 --><div class='crosslinks'><p class='noindent'>[<a href='SparselyPackingCiphertexts.html'>prev</a>][<a href='CKKSScheme.html#ModulusBootstrapping.html'>parent</a>]</p></div>
    
</body> 
</html>