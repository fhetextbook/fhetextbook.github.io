<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 617 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots2.html'>prev</a>][<a href='BGVScheme.html#ModulusBootstrapping1.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-bootstrapping1'><span class='titlemark'>D-4.11   </span> <a id='x151-218000D-4.11'></a>Modulus Bootstrapping</h4>
<!-- l. 620 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference: </span><a href='https://eprint.iacr.org/2022/1363.pdf'>Bootstrapping for BGV and BFV Revisited</a>Â <span class='cite'>[<a href='refname.html#Xcryptoeprint_2022_1363'>14</a>]</span>
</p><!-- l. 623 --><p class='indent'>   BGVâ€™s bootstrapping shares some common aspects with both BFV and CKKSâ€™s bootstrapping. The
goal of BGVâ€™s bootstrapping is the same as that of CKKS, but the internal technique is closer to
that of BFV. Like CKKS, BGVâ€™s bootstrapping resets the depleted ciphertext modulus from
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> (strictly speaking,
from <!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math> such that
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>l</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>L</mi></mrow></math> because the bootstrapping
operations between step 2<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo></mrow></math>6
have consumed multiplicative levels). This modulus transition effectively not only resets the multiplicative
level but also reduces the noise-to-ciphertext modulus ratio. To achieve this goal, one might think that BGVâ€™s
bootstrapping can take the same <span class='rm-lmss-10x-x-109'>ModRaise </span>approach used by CKKSâ€™s bootstrapping. However, this is not
a directly applicable solution because CKKS uses the sine approximation technique to eliminate the
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-multiple
overflows after the mod-raise. On the other hand, BGV is an exact encryption scheme that
does not allow the approximation of plaintext values. Therefore, BGV uses BFVâ€™s digit
extraction approach to eliminate its modulus overflows. To use digit extraction, as in the
case of BFV, BGV also has to modify the plaintext modulus to a specially prepared one,
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>. To
configure both the plaintext modulus and the ciphertext modulus to the desired values (i.e.,
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> and
<!-- l. 623 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>), BGV
employs the homomorphic decryption technique, as BFV does.
</p><!-- l. 626 --><p class='indent'>   The technical details of BGVâ€™s bootstrapping are as follows.
</p><!-- l. 628 --><p class='indent'>   <!-- l. 628 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 630 --><p class='indent'>   Suppose that we have an RLWE ciphertext <!-- l. 630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>,
where <!-- l. 630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Î”</mi><mi>E</mi></mrow></math>,
 <!-- l. 630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> (a prime),
and <!-- l. 630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> is
the ciphertext modulus of the current multiplicative level.
</p><!-- l. 632 --><p class='indent'>   <!-- l. 632 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 635 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span> <span class='rm-lmbx-10x-x-109'>from </span><!-- l. 636 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   BFVâ€™s bootstrapping initially switches the ciphertext modulus from <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>
   where <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math>.
   On the other hand, BGVâ€™s bootstrapping switches the ciphertext modulus to <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   that is a special modulus satisfying the relation: <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   and <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
                                                                                         
                                                                                         
   (where <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   will be explained in the next step). In order for a modulus switch from <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (i.e., the special modulus) to be possible, the prime factor(s) comprising <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   have to be congruent with <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo>â€¦</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
   so that we can do a modulus switch from <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (based on the technique learned in <a href='ModulusSwitch.html#modulus-switch1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-4.7<!-- tex4ht:ref: subsec:bgv-rotation  --></a>). Eventually, this stepâ€™s modulus switch transforms the
   ciphertext <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
   to <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   during which the plaintext modulus (i.e., noiseâ€™s scaling factor) stays the same.
   <!-- l. 638 --><p class='noindent'><!-- l. 638 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Ciphertext Coefficient Multiplication by </span><!-- l. 640 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math></span><span class='rm-lmbx-10x-x-109'>:</span>
   The constant <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>
   is multiplied to each coefficient of the ciphertext polynomials, updating the ciphertext to <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   where <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   and <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   This operation updates the original decryption relation <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ‘ğ¸</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   to <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (where <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-rel' stretchy='false'>|</mo><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>âˆ</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>).
   Notice that the plaintext modulus (i.e., noiseâ€™s scaling factor) has been changed from <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   When choosing <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>,
   BGV enforces the following additional constraint: <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   and <!-- l. 641 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   <!-- l. 643 --><p class='noindent'><!-- l. 643 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span></span><span class='rm-lmbx-10x-x-109'>: </span>We mod-raise <!-- l. 645 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   to <!-- l. 645 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   where <!-- l. 645 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   The mod-raised ciphertextâ€™s decryption relation is as follows:
   <!-- l. 647 --><p class='noindent'><!-- l. 647 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </p><!-- l. 649 --><p class='noindent'><!-- l. 649 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 651 --><p class='noindent'>Note that <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   is the <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>-multiple
   overflow and does not get reduced modulo <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>,
   because <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   We saw the same situation in the CKKS bootstrappingâ€™s <span class='rm-lmss-10x-x-109'>ModRaise </span>(<a href='ModulusBootstrapping.html#highlevel-idea2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.1<!-- tex4ht:ref: subsec:bgv-rotation  --></a>) which resets the
   ciphertext modulus from <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   at the cost of incurring a <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   overflow, which is to be removed by <span class='rm-lmss-10x-x-109'>EvalExp</span>â€™s homomorphic (approximate) sine graph evaluation
   (<a href='ModulusBootstrapping.html#details-evalexp'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.4<!-- tex4ht:ref: subsec:bgv-rotation  --></a>). Likewise, BGVâ€™s mod-raised ciphertext <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   is <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   an encryption of <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   In the later step, we will use digit extraction to homomorphically eliminate <!-- l. 651 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   like we did in BFVâ€™s bootstrapping. The reason BGVâ€™s bootstrapping uses digit extraction
   instead of approximated sine evaluation is that BGV is an exact encryption scheme like BFV
                                                                                         
                                                                                         
   (not an approximate scheme like CKKS).
   </p><!-- l. 653 --><p class='noindent'><!-- l. 653 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmbx-10x-x-109'>: </span>This step works the same way as CKKS and BFVâ€™s <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step: move the
   coefficients of polynomial <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>
   to the input vector slots of a new ciphertext. We denote polynomial <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>,
   and each <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
   coefficient of <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
   as <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>.
   For the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step, we homomorphically compute <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>.
   Then, each input vector slot of the resulting ciphertext ends up storing each <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   of the polynomial <!-- l. 655 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>.
   <!-- l. 657 --><p class='noindent'><!-- l. 657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Digit Extraction</span></span><span class='rm-lmbx-10x-x-109'>: </span>At this point, each input vector slot contains each coefficient of <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>,
   which is <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></mrow></math>.
   Recall that we designed the lowest multiplicative levelâ€™s ciphertext modulus <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   and the homomorphic multiplication factor <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   such that <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   or <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
   for some positive integer <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>.
   Therefore, the following holds:
   <!-- l. 661 --><p class='noindent'><!-- l. 661 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></mrow></math>
   </p><!-- l. 663 --><p class='noindent'><!-- l. 663 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 663 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   applying <!-- l. 663 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math></span>
   </p><!-- l. 665 --><p class='noindent'><!-- l. 665 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 665 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   rearranging the terms</span>
   </p><!-- l. 667 --><p class='noindent'><!-- l. 667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ğœ€</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ğœ€</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math></span>
   </p><!-- l. 669 --><p class='noindent'><!-- l. 669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!-- l. 671 --><p class='noindent'><!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 673 --><p class='noindent'>To eliminate <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></math>
   from the above (where <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>),
   we use the same digit extraction polynomial <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
   as in the BFV bootstrapping (<a href='NoiseBootstrapping1.html#digit-extraction'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.5<!-- tex4ht:ref: subsec:bgv-rotation  --></a>) :
   </p><!-- l. 675 --><p class='noindent'><!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>,
    and <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub></math>
   can be any integer,  and <!-- l. 675 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>ğœ€</mi></mrow></math></span>
   </p><!-- l. 677 --><p class='noindent'><!-- l. 677 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 679 --><p class='noindent'><!-- l. 679 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 681 --><p class='noindent'><!-- l. 681 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 683 --><p class='noindent'>We evaluate the digit extraction polynomial <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math>
   for <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   recursively a total of <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   times. This operation finally zeros out and right-shifts the least significant (base-<!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   digits of <!-- l. 683 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   as follows:
   </p><!-- l. 685 --><p class='noindent'><!-- l. 685 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 687 --><p class='noindent'><!-- l. 687 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   </p><!-- l. 689 --><p class='noindent'><!-- l. 689 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 691 --><p class='noindent'>, where <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is some multiple of <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   to account for the original <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>-multiple
   overflow term plus additional <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>-multiple
   overflows generated during the digit extraction. Note that the digit extraction step reduces the
   ciphertext modulus from <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   (where <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   is an integer smaller than <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>L</mi></math>),
   because the homomorphic evaluation of the polynomial <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math>
   requires some ciphertext-to-ciphertext multiplications, which consume some multiplicative levels.
   The output of the digit extraction step is <!-- l. 691 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   stored in each input vector slot.
   </p><!-- l. 693 --><p class='noindent'><!-- l. 693 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 695 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Handling the Divisions by </span><!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math></span><span class='rm-lmbx-10x-x-109'>:</span>
   Unlike in BFV (<a href='NoiseBootstrapping1.html#digit-extraction'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.5<!-- tex4ht:ref: subsec:bgv-rotation  --></a>), we cannot use scaling factor re-interpretation because the scaling
   factor setup of BGV is different from that of BFV. In BGVâ€™s digit extraction, each round should
   explicitly homomorphically multiply the slot values by <!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>i</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub></mrow></math>,
   where <!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>i</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   is the ciphertext modulus at the <!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
   round of digit extraction. Given <!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   is the ciphertext at the 1st round of digit extraction just before inverse-<!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   division, the actual division-by-<!-- l. 695 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   is equivalent to performing the ciphertext-to-plaintext multiplication (<a href='CiphertexttoPlaintextMultiplication.html#ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.6<!-- tex4ht:ref: subsec:bgv-rotation  --></a>) as follows:
   </p><!-- l. 697 --><p class='noindent'><!-- l. 697 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¤ğ—‡ğ–¼ğ—ˆğ–½ğ–¾</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 699 --><p class='noindent'><!-- l. 699 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 699 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   since <!-- l. 699 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¤ğ—‡ğ–¼ğ—ˆğ–½ğ–¾</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>
   </span>
   </p><!-- l. 701 --><p class='noindent'><!-- l. 701 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 703 --><p class='noindent'><!-- l. 703 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 705 --><p class='noindent'>Therefore, by multiplying the coefficients of two BGV ciphertext polynomials <!-- l. 705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   and <!-- l. 705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   by <!-- l. 705 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub></mrow></math>,
   we obtain the following effect:
                                                                                         
                                                                                         
   </p><!-- l. 707 --><p class='noindent'><!-- l. 707 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow>
<mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 709 --><p class='noindent'><!-- l. 709 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mrow><mi>p</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 712 --><p class='noindent'><!-- l. 712 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 714 --><p class='noindent'><!-- l. 714 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 716 --><p class='noindent'>Verbally speaking, the above inverse-<!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   multiplication to all polynomial coefficients of <!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   has the following two effects: (2) scales down the plaintext and the noise by <!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>;
   and (2) reduces the modulus garbage term <!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   to <!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>
   (i.e., right-shift by 1 base-<!-- l. 716 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit).
   </p><!-- l. 718 --><p class='noindent'><!-- l. 718 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 720 --><p class='noindent'>BGVâ€™s digit extraction procedure is equivalent to recursively evaluating <!-- l. 720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math>
   with the input <!-- l. 720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   by decreasing <!-- l. 720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>
   by 1 at each round (total <!-- l. 720 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   rounds) as follows:
   </p><!-- l. 722 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 722 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 724 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>1st Round: </span><!-- l. 724 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 726 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>2nd Round: </span><!-- l. 726 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 728 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>3rd Round: </span><!-- l. 728 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>4</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 730 --><p class='noindent'><!-- l. 730 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>â‹®</mi></math>
   </p><!-- l. 732 --><p class='noindent'><!-- l. 732 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
   Round: </span><!-- l. 732 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   </p><!-- l. 734 --><p class='noindent'><!-- l. 734 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 736 --><p class='noindent'>As shown above, the entire digit extraction procedure results in two effects on the values stored in
   the plaintext slots: (1) scales down the message <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi></mrow></math>
   to <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>;
   and (2) zeros out the modulus garbage <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   (i.e., <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>);
   and. The reason why <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup></math>
   gets updated to <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>K</mi><msup><mrow></mrow><mrow><mi>â€³</mi></mrow></msup></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   across rounds is that each <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
   roundâ€™s evaluation of function <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ–</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></math>
   and <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ–</mi></mrow></msub></math>
   is done modulo <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi></mrow></msup></math>,
   which produces new <!-- l. 736 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi></mrow></msup></math>-multiple
   overflow garbage values each time.
   </p><!-- l. 738 --><p class='noindent'><!-- l. 738 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 751 --><p class='noindent'>Beneficially, the <!-- l. 751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   rounds of inverse-<!-- l. 751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
                                                                                         
                                                                                         
   multiplications yields the effect of scaling down the plaintext <!-- l. 751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>,
   and the noise <!-- l. 751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>p</mi></mrow></math>,
   which has the desired noise scaling factor <!-- l. 751 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   for standard BGV ciphertexts.
   </p><!-- l. 757 --><p class='noindent'><!-- l. 757 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmbx-10x-x-109'>: </span>This step works the same way as BFVâ€™s <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step: move <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi></mrow></math>
   stored in the input vector slots back to the polynomial coefficient positions by homomorphically
   multiplying with <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>.
   Upon completing this step, the ciphertext modulus is some value <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></math>
   smaller than <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>,
   because the homomorphic operation of step <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>4</mn> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo><mn>6</mn></mrow></math>
   has consumed a few multiplicative levels. The resulting plaintext coefficients are <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€´</mi></mrow></msubsup><mi>p</mi></mrow></math>,
   where <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>k</mi></mrow><mrow><mi>â€´</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup></mrow></math>
   due to the additional noise generated by homomorphically running the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step. The
   plaintext modulus (i.e., the noise scaling factor) and the noise scaling factor are <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   at this point, the standard one for BGV ciphertexts. We let these polynomials be <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>
   and <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€´</mi></mrow></msup></math>
   each, and the output ciphertext is <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€´</mi></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>.
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='discussion6'><span class='titlemark'>D-4.11.1   </span> <a id='x151-219000D-4.11.1'></a>Discussion</h5>
<!-- l. 775 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The Reason for Modulus Switch from </span><!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>:
BGV switches the modulus from <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
to eliminate the <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>-multiple
overflows during bootstrapping. After switching the modulus
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> and then <span class='rm-lmss-10x-x-109'>ModRaise</span>, the encrypted
plaintext gets the <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> overflow
term, which can be reduced to <!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
from the plaintext modulusâ€™s perspective due to the special property
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math> (where
<!-- l. 775 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> is the
plaintext modulus).
</p><!-- l. 777 --><p class='indent'>   <!-- l. 777 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 779 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The Choice of </span><!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math><span class='rm-lmbx-10x-x-109'>:</span>
The larger <!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> is, the
greater the (base-<!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
digit-wise gap between <!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi></mrow></math>
and <!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
becomes; thus, the less likely it is that the decryption would fail (i.e., fail to zero out
<!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>). However,
a larger <!-- l. 779 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>
means the digit extraction operation would be more expensive.
                                                                                         
                                                                                         
</p><!-- l. 781 --><p class='indent'>   <!-- l. 781 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 784 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Generalization to </span><!-- l. 784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
Like the case of BFVâ€™s bootstrapping (SummaryÂ D-2.11.6 in <a href='NoiseBootstrapping1.html#summary3'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.6<!-- tex4ht:ref: subsubsec:bfv-bootstrapping-summary  --></a>), we can generalize the plaintext modulus (i.e.,
noise scaling factor) to <!-- l. 784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></math>
where <!-- l. 784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> is a
prime and <!-- l. 784 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>r</mi></math>
can be any positive integer.
   
</p>
   <h5 class='subsubsectionHead' id='comparing-the-bootstrapping-in-bfv-bgv-and-ckks'><span class='titlemark'>D-4.11.2   </span> <a id='x151-220000D-4.11.2'></a>Comparing the Bootstrapping in BFV, BGV, and CKKS</h5>
<!-- l. 795 --><p class='noindent'>Both BFV and BGVâ€™s bootstrapping use digit extraction, but for different purposes. In BFV, digit
extraction is used to eliminate the noise in the lower-bit area. In BGV, digit extraction is used
to eliminate the modulus garbage values in the lower-bit area generated by <span class='rm-lmss-10x-x-109'>ModRaise </span>from
<!-- l. 795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>. In addition,
at each round of BGVâ€™s digit extraction, we explicitly multiply the coefficients of the ciphertext polynomials by
<!-- l. 795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>q</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>i</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></msub></mrow></math>. In BFV, this
explicit inverse-<!-- l. 795 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
multiplication is skipped and we only conceptually re-interpret the scaling factor.
</p><!-- l. 797 --><p class='indent'>   CKKSâ€™s bootstrapping does not involve digit extraction because it has no values to
eliminate in the lower-bit area. Instead, regarding the modulus garbage value <span class='rm-lmss-10x-x-109'>ModRaise </span>from
<!-- l. 797 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>, this is
eliminated by <span class='rm-lmss-10x-x-109'>EvalExp</span>â€™s homomorphic evaluation of an approximate sine function. Although CKKSâ€™s
bootstrapping resets its modulus to a large value, this operation does not decrease the noise-to-message
ratio, and this ratio continuously increases over homomorphic operations.
                                                                                         
                                                                                         
</p>
   <!-- l. 637 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots2.html'>prev</a>][<a href='BGVScheme.html#ModulusBootstrapping1.html'>parent</a>]</p></div>
    
</body> 
</html>