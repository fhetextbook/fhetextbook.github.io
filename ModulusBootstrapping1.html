<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!--  l. 617  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots2.html'>prev</a>][<a href='BGVScheme.html#ModulusBootstrapping1.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-bootstrapping1'><span class='titlemark'>D-4.11   </span> <a id='x148-218000D-4.11'></a>Modulus Bootstrapping</h4>
<!--  l. 620  --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference:  </span><a href='https://eprint.iacr.org/2022/1363.pdf'>Bootstrapping for BGV and BFV Revisited</a>Â <span class='cite'>[<a href='refname.html#Xcryptoeprint_2022_1363'>14</a>]</span>
</p><!--  l. 623  --><p class='indent'>   BGVâ€™s bootstrapping shares some common aspects with both BFV and CKKSâ€™s bootstrapping. The
goal of BGVâ€™s bootstrapping is the same as that of CKKS, but the internal technique is closer to
that of BFV. Like CKKS, BGVâ€™s bootstrapping resets the depleted ciphertext modulus from
<!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> (strictly
speaking, from <!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
such that <!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>l</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>L</mi></mrow></math>
because the bootstrapping operation itself consumes some multiplicative levels). This modulus transition
effectively not only resets the multiplicative level but also reduces the noise-to-ciphertext
modulus ratio. To achieve this goal, one might think that BGVâ€™s bootstrapping can take
the same <span class='rm-lmss-10x-x-109'>ModRaise </span>approach used by CKKSâ€™s bootstrapping. However, this is not a directly
applicable solution, because CKKS uses the sine approximation technique to eliminate the
<!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></math>-overflows
after the mod-raise. On the other hand, BGV is an exact encryption scheme which
does not allow approximation of plaintext values. Therefore, BGV uses BFVâ€™s digit
extraction approach to eliminate its modulus overflows. To use digit extraction, like in the
case of BFV, BGV also has to modify the plaintext modulus to a specially prepared one,
<!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>.
To configure both the plaintext modulus and the ciphertext modulus to desired values (i.e.,
<!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> and
<!--  l. 623  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>), BGV
uses the homomorphic decryption technique like BFV.
</p><!--  l. 627  --><p class='indent'>   The technical details of BGVâ€™s bootstrapping are as follows.
</p><!--  l. 629  --><p class='indent'>   <!--  l. 629  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 631  --><p class='indent'>   Suppose that we have an RLWE ciphertext <!--  l. 631  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>,
where <!--  l. 631  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Î”</mi><mi>E</mi></mrow></math>,
 <!--  l. 631  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> (a prime),
and <!--  l. 631  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math> is
the ciphertext modulus of the current multiplicative level.
</p><!--  l. 633  --><p class='indent'>   <!--  l. 633  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 636  --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span> <span class='rm-lmbx-10x-x-109'>from </span><!--  l. 637  --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   BFVâ€™s bootstrapping initially switches the ciphertext modulus from <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>
   where <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math>.
   On the other hand, BGVâ€™s bootstrapping switches the ciphertext modulus to <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   that is a special modulus satisfying the relation: <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   and <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
                                                                                         
                                                                                         
   (where <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   will be explained in the next step). In order for a modulus switch from <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (i.e., the special modulus) to be possible, the prime factor(s) comprising <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   have to be congruent with <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
   so that we can do <span class='rm-lmss-10x-x-109'>ModRaise </span>from <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   and then a modulus switch from <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (based on the technique learned in <a href='ModulusSwitch.html#modulus-switch1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-4.7<!--  tex4ht:ref: subsec:bgv-rotation   --></a>). Eventually, this stepâ€™s modulus switch transforms the
   ciphertext <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
   to <!--  l. 637  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   during which the plaintext modulus (i.e., noiseâ€™s scaling factor) stays the same.
   <!--  l. 639  --><p class='noindent'><!--  l. 639  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Ciphertext Coefficient Multiplication by </span><!--  l. 641  --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math></span><span class='rm-lmbx-10x-x-109'>:</span>
   The constant <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>
   is multiplied to each coefficient of the ciphertext polynomials, updating the ciphertext to <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   where <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   and <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   This operation updates the original decryption relation <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ‘ğ¸</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   to <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (where <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>K</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>).
   Notice that the plaintext modulus (i.e., noiseâ€™s scaling factor) has been changed from <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   When choosing <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>,
   BGV enforces the following additional constraint: <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   and <!--  l. 642  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   <!--  l. 644  --><p class='noindent'><!--  l. 644  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>ModRaise</span></span><span class='rm-lmbx-10x-x-109'>: </span>We mod-raise <!--  l. 646  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   to <!--  l. 646  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   where <!--  l. 646  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   The mod-raised ciphertextâ€™s decryption relation is as follows:
   <!--  l. 648  --><p class='noindent'><!--  l. 648  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   </p><!--  l. 650  --><p class='noindent'><!--  l. 650  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 652  --><p class='noindent'>Note that <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   is the <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>-multiple
   overflow and does not get reduced modulo <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>,
   because <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   We saw the same situation in the CKKS bootstrappingâ€™s <span class='rm-lmss-10x-x-109'>ModRaise </span>(<a href='ModulusBootstrapping.html#highlevel-idea2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.1<!--  tex4ht:ref: subsec:bgv-rotation   --></a>) which resets the
   ciphertext modulus from <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   at the cost of incurring a <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   overflow, which is to be removed by <span class='rm-lmss-10x-x-109'>EvalExp</span>â€™s homomorphic (approximate) sine graph evaluation
   (<a href='ModulusBootstrapping.html#details-evalexp'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.13.4<!--  tex4ht:ref: subsec:bgv-rotation   --></a>). Likewise, BGVâ€™s mod-raised ciphertext <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
   is <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   an encryption of <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   In the later step, we will use digit extraction to homomorphically eliminate <!--  l. 652  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   like we did in BFVâ€™s bootstrapping. The reason BGVâ€™s bootstrapping uses digit extraction
                                                                                         
                                                                                         
   instead of approximated sine evaluation is that BGV is an exact encryption scheme like BFV
   (not an approximate scheme like CKKS).
   </p><!--  l. 673  --><p class='noindent'><!--  l. 673  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmbx-10x-x-109'>: </span>This step works the same way as CKKS and BFVâ€™s <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step: move the
   coefficients of polynomial <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>
   to the input vector slots of a new ciphertext. We denote polynomial <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>,
   and each <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
   coefficient of <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
   as <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>.
   For the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step, we homomorphically compute <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math>.
   Then, each input vector slot of the resulting ciphertext ends up storing each <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   of the polynomial <!--  l. 675  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>.
   <!--  l. 677  --><p class='noindent'><!--  l. 677  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Digit Extraction</span></span><span class='rm-lmbx-10x-x-109'>: </span>At this point, each input vector slot contains each coefficient of <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>,
   which is <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></mrow></math>.
   Recall that we designed the lowest multiplicative levelâ€™s ciphertext modulus <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   and the homomorphic multiplication factor <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   such that <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   or <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
   for some positive integer <!--  l. 679  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>.
   Therefore, the following holds:
   <!--  l. 681  --><p class='noindent'><!--  l. 681  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></mrow></math>
   </p><!--  l. 683  --><p class='noindent'><!--  l. 683  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor215'># applying <!--  l. 683  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math></span>
   </p><!--  l. 685  --><p class='noindent'><!--  l. 685  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   <span id='textcolor216'># rearranging the terms</span>
   </p><!--  l. 687  --><p class='noindent'><!--  l. 687  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ğœ€</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math>
   <span id='textcolor217'># where <!--  l. 687  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><mi>ğœ€</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>k</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math></span>
   </p><!--  l. 689  --><p class='noindent'><!--  l. 689  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!--  l. 691  --><p class='noindent'><!--  l. 691  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 693  --><p class='noindent'>To eliminate <!--  l. 693  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup></math>
   from the above, we will use the same digit extraction polynomial <!--  l. 693  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
   as in BFV (<a href='NoiseBootstrapping1.html#digit-extraction'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.5<!--  tex4ht:ref: subsec:bgv-rotation   --></a>) :
   </p><!--  l. 695  --><p class='noindent'><!--  l. 695  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!--  FUNCTION APPLICATION  --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   <span id='textcolor218'># where <!--  l. 695  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>,
    and <!--  l. 695  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub></math>
   can be any integer,  and <!--  l. 695  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>w</mi></mrow></math></span>
   </p><!--  l. 697  --><p class='noindent'><!--  l. 697  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!--  l. 699  --><p class='noindent'><!--  l. 699  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>v</mi><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!--  l. 701  --><p class='noindent'><!--  l. 701  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 703  --><p class='noindent'>We evaluate the digit extraction polynomial <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
   for <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   recursively total <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
                                                                                         
                                                                                         
   times, at each coefficient <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   of polynomial <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
   stored at input vector slots. This operation finally zeros out the least significant (base-<!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   digits of <!--  l. 703  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   as follows:
   </p><!--  l. 705  --><p class='noindent'><!--  l. 705  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!--  l. 707  --><p class='noindent'><!--  l. 707  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!--  l. 709  --><p class='noindent'><!--  l. 709  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   </p><!--  l. 711  --><p class='noindent'><!--  l. 711  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 713  --><p class='noindent'>, where <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is some multiple of <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   to account for the original <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>-overflow
   term plus an additional <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>-overflows
   generated during the digit extraction. Note that the digit extraction step reduces the ciphertext
   modulus from <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   (where <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>l</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   is an integer smaller than <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>L</mi></math>),
   because the homomorphic evaluation of the polynomial <!--  l. 713  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
   requires some ciphertext-to-ciphertext multiplications, which consume some multiplicative levels.
   </p><!--  l. 715  --><p class='noindent'><!--  l. 715  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Multiplication by </span><!--  l. 717  --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math></span><span class='rm-lmbx-10x-x-109'>:</span>
   The output of the digit extraction step is <!--  l. 718  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   stored in each input vector slot. We homomorphically multiply <!--  l. 718  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub></mrow></math>
   to it, which is a modulo-<!--  l. 718  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   inverse of <!--  l. 718  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>.
   Note that <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   is guaranteed to exist because <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>â„¤</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub></math>
   is a finite field (i.e., Galois field) whose every element is guaranteed to have its counterpart inverse
   (TheoremÂ A-3.1 in <a href='Definitions1.html#definitions1'><span class='ts1-lmr10-x-x-109'>Â§</span>A-3.1<!--  tex4ht:ref: subsec:field-def   --></a>). Multiplying <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   to <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>i</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is equivalent to an exact division of <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>i</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   by <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>,
   because <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>k</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>i</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is exactly divisible by <!--  l. 719  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>.
   We homomorphically compute the following:
   <!--  l. 721  --><p class='noindent'><!--  l. 721  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>ğ‘šğ‘œğ‘‘</mi><mspace width='0.3em'></mspace><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!--  l. 723  --><p class='noindent'><!--  l. 723  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 725  --><p class='noindent'>Note that the plaintext value <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is also equivalent to <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
   (because <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   divides <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>),
   and is also equivalent to <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   (i.e., the message portion without the noise is <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>).
                                                                                         
                                                                                         
   Therefore, homomorphically multiplying <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub></mrow></math>
   to a ciphertext that encrypts <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   is equivalent to switching the plaintext modulus from <!--  l. 725  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>p</mi></mrow></math>.
   </p><!--  l. 727  --><p class='noindent'><!--  l. 727  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!--  l. 729  --><p class='noindent'>In an alternative design, one can eliminate this step of homomorphic multiplication by <!--  l. 729  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   by re-designing the digit extraction algorithm to gradually shift down the digits by total (base-<!--  l. 729  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!--  l. 729  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   digits (by multiplying by <!--  l. 729  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub></mrow></math>
   at the end of each round of digit extraction).
   </p><!--  l. 732  --><p class='noindent'><!--  l. 732  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmbx-10x-x-109'>: </span>This step works the same way as BFVâ€™s <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step: move <!--  l. 735  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><mi>p</mi></mrow></math>
   stored in the input vector slots back to the polynomial coefficient positions by homomorphically
   multiplying with <!--  l. 735  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>.
   <!--  l. 737  --><p class='noindent'>Meanwhile, the coefficient domain is in modulo <!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>.
   From modulo-<!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>â€™s
   perspective, the result of step 5 is <!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   It is guaranteed that <!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>,
   because <!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
   Therefore, result of <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>is a set of polynomial coefficients whose noise is within the noise
   budget of <!--  l. 737  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></math>.
   </p><!--  l. 739  --><p class='noindent'><!--  l. 739  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
8. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>Noise Term Re-interpretation</span></span><span class='rm-lmbx-10x-x-109'>: </span>The output of the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step is <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   which also contains some noise term <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>p</mi></mrow></math>
   generated during the homomorphic operations of step <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo><mn>6</mn></mrow></math>.
   Therefore, we can view the <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>p</mi></mrow></math>
   term  in  the  plaintext  as  part  of  the  noise  of  the  ciphertext.  In  other  words,  we  can  view
   <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   with some noise term <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>p</mi></mrow></math>
   as a ciphertext <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   with the noise term <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mi>p</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>p</mi></mrow></math>.
   This step does not require any additional computation. The size of the coefficients of <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup></math>
   is upper-bounded because the operations of the <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit extraction, and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>
   steps are fixed. With a proper setup of the cryptographic parameters of BGV, we can guarantee
   that the noise-to-ciphertext modulus ratio always gets decreased after BGVâ€™s bootstrapping (i.e.,
   <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>|</mo><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-rel' stretchy='false'>|</mo><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>âˆ</mi></mrow></msub>
    </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub>       </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€³</mi></mrow></msup><mo class='MathClass-rel' stretchy='false'>|</mo><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>âˆ</mi></mrow></msub>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>|</mo><mi>E</mi><mo class='MathClass-rel' stretchy='false'>|</mo><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>âˆ</mi></mrow></msub>
  </mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>  </mrow></mfrac></mstyle></mrow></math>,
   where <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>|</mo><mi>P</mi><mo class='MathClass-rel' stretchy='false'>|</mo><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>âˆ</mi></mrow></msub></mrow></math>
   denotes the maximum absolute coefficient value of polynomial <!--  l. 741  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>P</mi></math>).
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='the-reason-for-modulus-switch-from-ql-q'><span class='titlemark'>D-4.11.1   </span> <a id='x148-219000D-4.11.1'></a>The Reason for Modulus Switch from
                                                                                         
                                                                                         
<!--  l. 747  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></h5>
<!--  l. 749  --><p class='noindent'>BGV switches the modulus from <!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
to eliminate the <!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>-multiple
overflows during bootstrapping. After switching the modulus
<!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> and then <span class='rm-lmss-10x-x-109'>ModRaise</span>, the encrypted
plaintext gets the <!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> overflow
term, which can be reduced to <!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
from the plaintext modulusâ€™s perspective due to the special property
<!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math> (where
<!--  l. 749  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> is the
plaintext modulus).
   
</p>
   <h5 class='subsubsectionHead' id='modraise-instead-of-homomorphic-decryption'><span class='titlemark'>D-4.11.2   </span> <a id='x148-220000D-4.11.2'></a><span class='rm-lmss-10x-x-109'>ModRaise </span>instead of Homomorphic Decryption</h5>
<!--  l. 754  --><p class='noindent'>In the case of BFVâ€™s bootstrapping, we need homomorphic decryption (<a href='NoiseBootstrapping1.html#homomorphic-decryption'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.3<!--  tex4ht:ref: subsec:field-def   --></a>)
because we need to simultaneously change the ciphertextâ€™s plaintext scaling factor from
<!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â†’</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math> and the ciphertext
modulus from <!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>q</mi></mrow></math>.
On the other hand, in the case of CKKSâ€™s bootstrapping, <span class='rm-lmss-10x-x-109'>ModRaise </span>instead of homomorphic
decryption is sufficient because we only need to change the ciphertext modulus from
<!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math> while keeping the same
plaintext scaling factor <!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mrow></math>.
Similarly, in the case of BGVâ€™s bootstrapping, <span class='rm-lmss-10x-x-109'>ModRaise </span>instead of homomorphic
decryption is sufficient because we only need to change the ciphertext modulus from
<!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>
while keeping the noise scaling factor (i.e., the plaintext modulus)
<!--  l. 754  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   
</p>
   <h5 class='subsubsectionHead' id='the-choice-of-'><span class='titlemark'>D-4.11.3   </span> <a id='x148-221000D-4.11.3'></a>The Choice of <!--  l. 757  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math></h5>
<!--  l. 759  --><p class='noindent'>The larger <!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> is, the
greater the (base-<!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
digit-wise gap between <!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi></mrow></math>
and <!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
becomes, and thus the less likely it is that the decryption would fail (i.e., fail to zero out
<!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>). But a
larger <!--  l. 759  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>
means the digit extraction operation would be more expensive.
   
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='generalization-to-delta-pr'><span class='titlemark'>D-4.11.4   </span> <a id='x148-222000D-4.11.4'></a>Generalization to <!--  l. 761  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math></h5>
<!--  l. 763  --><p class='noindent'>Like the case of BFVâ€™s bootstrapping (SummaryÂ D-2.11.7 in <a href='NoiseBootstrapping1.html#summary3'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.7<!--  tex4ht:ref: subsubsec:bfv-bootstrapping-summary   --></a>), we can generalize the plaintext modulus (i.e.,
noise scaling factor) to <!--  l. 763  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></math>
where <!--  l. 763  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> is a
prime and <!--  l. 763  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>r</mi></math>
can be any positive integer.
                                                                                         
                                                                                         
</p>
   <!--  l. 635  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicRotationofInputVectorSlots2.html'>prev</a>][<a href='BGVScheme.html#ModulusBootstrapping1.html'>parent</a>]</p></div>
    
</body> 
</html>