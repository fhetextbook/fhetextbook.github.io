<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Switch</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 276 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication2.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-switch1'><span class='titlemark'>D-4.7   </span>   <a id='x147-214000D-4.7'></a>Modulus Switch</h4>
<!-- l. 279 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 1: </span><a href='https://eprint.iacr.org/2020/1481'>Design and implementation of HElib: a homomorphic encryption library</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch1'>21</a>]</span>
</p><!-- l. 283 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 2: </span><a href='https://eprint.iacr.org/2011/277.pdf'>Fully Homomorphic Encryption without Bootstrapping</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch2'>22</a>]</span>
</p><!-- l. 287 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 3: </span><a href='https://eprint.iacr.org/2012/099.pdf'>Homomorphic Evaluation of the AES Circuit</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch3'>23</a>]</span>
</p><!-- l. 290 --><p class='indent'>   Remember that the requirement of modulus switch is that while we change the ciphertext modulus
from <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> to
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>, it should decrypt to
the same plaintext <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
BGVโs modulus switch is similar to that of the RLWE modulus switch (<a href='RLWEModulusSwitching.html#rlwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>ยง</span>C-4.4<!-- tex4ht:ref: subsec:bgv-moddrop  --></a>),
but there is an additional requirement, because BGV applies the scaling factor
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>ฮ</mi></math> not to
plaintext <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>, but
to noise <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>.
In the case of BFV or CKKS, their decryption process only needs to round off the
noise in the low-digit area. However, in the case of BGV, the plaintext is in the low-digit
area and its decryption process has to remove the noise in the higher-bit area by
modulo-<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
reduction (i.e., the plaintext modulus). More concretely, BGVโs modulus switch from
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo></mrow></math>
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> should satisfy the decryption
relation such that <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>. In
BGVโs modulus switch, <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
does not have to be one of the multiplicative levels of the ciphertext, and
<!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> only needs to satisfy
the relationship: <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
and <!-- l. 290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
BGVโs modulus switch procedure is as follows:
</p><!-- l. 292 --><p class='indent'>   <!-- l. 292 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 295 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>The input ciphertext is <!-- l. 297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   We compute new polynomials <!-- l. 297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></math>
   and <!-- l. 297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></math>
   as follows:
   <!-- l. 299 --><p class='noindent'><!-- l. 299 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>๐๐๐</mi><mspace width='0.3em'></mspace><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 301 --><p class='noindent'><!-- l. 301 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 303 --><p class='noindent'>And we compute the rounding error <!-- l. 303 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
                                                                                         
                                                                                         
   </p><!-- l. 305 --><p class='noindent'><!-- l. 305 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
   </p><!-- l. 307 --><p class='noindent'><!-- l. 307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
   </p><!-- l. 310 --><p class='noindent'><!-- l. 310 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 312 --><p class='noindent'>, which we rewrite as follows:
   </p><!-- l. 314 --><p class='noindent'><!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   we denote <!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   where <!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 316 --><p class='noindent'><!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   we denote <!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>,
   where <!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 318 --><p class='noindent'><!-- l. 318 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>We compute new polynomials <!-- l. 320 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></math>
   and <!-- l. 320 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math>
   as follows:
   <!-- l. 322 --><p class='noindent'><!-- l. 322 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 324 --><p class='noindent'><!-- l. 324 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 326 --><p class='noindent'><!-- l. 326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>We propose the final mod-switched ciphertext <!-- l. 328 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   as follows:
   <!-- l. 330 --><p class='noindent'><!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 332 --><p class='noindent'><!-- l. 332 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 334 --><p class='noindent'>Note that the computation result of <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   alone can exceed the range <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math>,
   because <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>.
   Therefore, our goal is reduce <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   to derive <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>.
   </p><!-- l. 336 --><p class='noindent'><!-- l. 336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>From now on, we will verify that <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a valid ciphertext satisfying BGVโs required decryption relation. First, we can derive the
   relationship among <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   and <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
   <!-- l. 340 --><p class='noindent'><!-- l. 340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 342 --><p class='noindent'><!-- l. 342 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 344 --><p class='noindent'><!-- l. 344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   applying step 1โs result: <!-- l. 344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>,
    <!-- l. 344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math></span>
   </p><!-- l. 346 --><p class='noindent'><!-- l. 346 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   applying step 2โs result: <!-- l. 347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 349 --><p class='noindent'><!-- l. 349 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 351 --><p class='noindent'><!-- l. 351 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 355 --><p class='noindent'><!-- l. 355 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 357 --><p class='noindent'>So, <!-- l. 357 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   But in BGV, <!-- l. 357 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo> <mo class='MathClass-rel' stretchy='false'>โก</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   Thus, the following holds:
   </p><!-- l. 359 --><p class='noindent'><!-- l. 359 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 361 --><p class='noindent'><!-- l. 361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 366 --><p class='noindent'><!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>We can derive the decryption relation of <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   from the decryption relation of <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></math>
   as follows:
   <!-- l. 370 --><p class='noindent'><!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   The BGV decryption relation of <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 372 --><p class='noindent'><!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   where <!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
   represents the modulo-<!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
   reduction</span>
   </p><!-- l. 374 --><p class='noindent'><!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   applying step 4โs result: <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 376 --><p class='noindent'><!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   since in BGV, <!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
   and we chose <!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   such that <!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 378 --><p class='noindent'><!-- l. 378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>Now, if we can prove that <!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (i.e., <!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   reduces <!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>),
   then this sufficiently leads to the following conclusion:
                                                                                         
                                                                                         
   <!-- l. 382 --><p class='noindent'><!-- l. 382 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 384 --><p class='noindent'><!-- l. 384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 386 --><p class='noindent'><!-- l. 386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   i.e., <!-- l. 386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   is a valid ciphertext that decrypts to <!-- l. 386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math></span>
   </p><!-- l. 388 --><p class='noindent'><!-- l. 388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'>We will prove that <!-- l. 410 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   as follows:
   <!-- l. 412 --><p class='noindent'><!-- l. 412 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 415 --><p class='noindent'><!-- l. 415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 417 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>applying step
   1โs result: <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math></span>
   </p><!-- l. 419 --><p class='noindent'><!-- l. 419 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 421 --><p class='noindent'><!-- l. 421 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 423 --><p class='noindent'><!-- l. 423 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 423 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   rearranging the terms</span>
   </p><!-- l. 425 --><p class='noindent'><!-- l. 425 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 425 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>taking out the
   common factor <!-- l. 425 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math></span>
   </p><!-- l. 427 --><p class='noindent'><!-- l. 427 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 427 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>since
   <!-- l. 427 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 429 --><p class='noindent'><!-- l. 429 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 431 --><p class='noindent'>For successful decryption, every coefficient of the resulting polynomial of the above expression has to be within the
   range <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math> (which
   means that <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> has
   successfully reduced <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>). The
   first term <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   can be viewed as the original ciphertext <span class='rm-lmss-10x-x-109'>ct</span>โs noise (with the plaintext message) scaled down by
   <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>, which is guaranteed to
   be within the <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math> range. The
   coefficients of the second term <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi></mrow></math>
   are also small, because <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msubsup><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
   and <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>โ</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>n</mi></mrow></msup></mrow></math>. The coefficients of
   the third term <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math> are also
   small, because <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msubsup><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>. The
                                                                                         
                                                                                         
   coefficients of the last term <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math>
   are also small, because <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   and <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   are <!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow> <mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow>
<mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></mfrac> </mrow></msub></mrow></math>.
   </p><!-- l. 433 --><p class='noindent'><!-- l. 433 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 435 --><p class='noindent'>Therefore, <!-- l. 435 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (provided the above error thresholds hold).
   </p><!-- l. 437 --><p class='noindent'><!-- l. 437 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
8. </dt><dd class='enumerate-enumitem'>Finally, we combine the results of step 6 and 7 as follows:
   <!-- l. 441 --><p class='noindent'><!-- l. 441 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 443 --><p class='noindent'><!-- l. 443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>since
   <!-- l. 443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>, and
   <!-- l. 443 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></span>
   </p><!-- l. 445 --><p class='noindent'><!-- l. 445 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 445 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>by
   applying step 7</span>
   </p><!-- l. 447 --><p class='noindent'><!-- l. 447 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 447 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>by
   applying step 5</span>
   </p><!-- l. 449 --><p class='noindent'><!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 451 --><p class='noindent'>Hence, decrypting <!-- l. 451 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   outputs the message <!-- l. 451 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
</p>
   </dd></dl>
<!-- l. 455 --><p class='indent'>   <!-- l. 455 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 457 --><p class='indent'>   We summarize BGVโs modulus switch as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-113'>     
<div class='tcolorbox-title'>
<!-- l. 493 --><p class='indent'>   <!-- l. 493 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>โจ</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>SummaryยD-4.7</span><!-- l. 493 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>โฉ</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>BGVโs Modulus Switch</span></p></div> 
<div class='tcolorbox-content'><!-- l. 463 --><p class='noindent'>Suppose we have the current ciphertext modulus <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
and new ciphertext modulus <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
where <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
and <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
Therefore, <!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
may       or       may       not       be       one       of       the       ciphertext       moduli
comprising        a        BGV        ciphertextโs        multiplicative        level        moduli
<!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
</p><!-- l. 465 --><p class='noindent'><!-- l. 465 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 467 --><p class='noindent'>BGVโs                             modulus                             switch                             from
<!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
is                              equivalent                              to                              updating
<!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
to
<!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
as follows:
</p><!-- l. 470 --><p class='noindent'><!-- l. 470 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo><msubsup><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>โจ</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>โฉ</mo></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></math>
</p><!-- l. 472 --><p class='noindent'><!-- l. 472 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 474 --><p class='noindent'><!-- l. 474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>
<!-- l. 474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
where
<!-- l. 474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 476 --><p class='noindent'><!-- l. 476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>
<!-- l. 476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
where
<!-- l. 476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 479 --><p class='noindent'><!-- l. 479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 481 --><p class='noindent'><!-- l. 481 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 483 --><p class='noindent'><!-- l. 483 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 485 --><p class='noindent'><!-- l. 485 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 487 --><p class='noindent'><!-- l. 487 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
</p><!-- l. 489 --><p class='noindent'><!-- l. 489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 491 --><p class='noindent'>BGVโs modulus switch is used for ciphertext-to-ciphertext multiplication (will be covered
in  <a href='CiphertexttoCiphertextMultiplication2.html#ciphertexttociphertext-multiplication2'><span class='ts1-lmr10-x-x-109'>ยง</span>D-4.8<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>).  Meanwhile,  After  BGVโs  modulus  switch  (i.e.,  the  noise  scaling  factor),
<!-- l. 491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>ฮ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi></mrow></math>
stays the same as before. The secret key <!-- l. 491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
also   stays   the   same   as   before.   The   noise   gets   scaled   down   roughly   by
<!-- l. 491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>,
but this does not decrease the noise-to-ciphertext modulus ratio. The noise-to-ciphertext
modulus ratio can be reduced by modulus bootstrapping (will be covered in <a href='ModulusBootstrapping1.html#modulus-bootstrapping1'><span class='ts1-lmr10-x-x-109'>ยง</span>D-4.11<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>).
</p>
 
</div> 
</div>
   
                                                                                         
                                                                                         
   <h5 class='subsubsectionHead' id='difference-between-modulus-switch-and-moddrop1'><span class='titlemark'>D-4.7.1   </span>   <a id='x147-215000D-4.7.1'></a>Difference between Modulus Switch and <span class='rm-lmss-10x-x-109'>ModDrop</span></h5>
<!-- l. 500 --><p class='noindent'>In the case of CKKS (<a href='CiphertexttoCiphertextMultiplication1.html#rescaling1'><span class='ts1-lmr10-x-x-109'>ยง</span>D-3.5.4<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>), the difference between modulus switch and
<span class='rm-lmss-10x-x-109'>ModDrop </span>is that the former scales down the plaintextโs scaling factor by
<!-- l. 500 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>does not affect the plaintextโs scaling factor.
</p><!-- l. 502 --><p class='indent'>   Similarly, in the case of BGV, modulus switch (rescaling) and <span class='rm-lmss-10x-x-109'>ModDrop </span>from
<!-- l. 502 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></math> both lower a BGV
ciphertextโs modulus from <!-- l. 502 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></math>.
However, the key difference is that rescaling also decreases the noiseโs scaling factor by
<!-- l. 502 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>keeps the noiseโs scaling factor the same as it is. Therefore, rescaling
is used only during ciphertext-to-ciphertext multiplication (to be explained in <a href='CiphertexttoCiphertextMultiplication2.html#ciphertexttociphertext-multiplication2'><span class='ts1-lmr10-x-x-109'>ยง</span>D-4.8<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>)
when scaling down the noiseโs scaling factor in the intermediate ciphertext from
<!-- l. 502 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>ฮ</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>โ</mo><mi mathvariant='normal'>ฮ</mi></mrow></math>.
Meanwhile, <span class='rm-lmss-10x-x-109'>ModDrop </span>is used to reduce the modulo computation time during an applicationโs routine when
it becomes certain that the ciphertext will not undergo any additional ciphertext-to-ciphertext
multiplication (i.e., no need to further decrease the ciphertextโs modulus).
</p><!-- l. 504 --><p class='indent'>   The main difference in modulus switch between CKKS and BGV is that the former decreases the plaintextโs scaling
factor by approximately <!-- l. 504 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></math>,
whereas the latter decreases the noiseโs scaling factor by approximately
<!-- l. 504 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></math>.
</p><!-- l. 506 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Source Code: </span>Examples of BGV modulus switch can be executed by running <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/bgv.py'><span class='underline'>this Python script</span></a>.
                                                                                         
                                                                                         
</p>
   <!-- l. 509 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication2.html'>next</a>]</p></div>
    
</body> 
</html>