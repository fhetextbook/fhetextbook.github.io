<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Switch</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 272 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication1.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-switch1'><span class='titlemark'>D-4.7   </span> <a id='x144-213000D-4.7'></a>Modulus Switch</h4>
<!-- l. 275 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 1: </span><a href='https://eprint.iacr.org/2020/1481'>Design and implementation of HElib: a homomorphic encryption library</a> <span class='cite'>[<a href='refname.html#Xbgv-modswitch1'>21</a>]</span>
</p><!-- l. 279 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 2: </span><a href='https://eprint.iacr.org/2011/277.pdf'>Fully Homomorphic Encryption without Bootstrapping</a> <span class='cite'>[<a href='refname.html#Xbgv-modswitch2'>22</a>]</span>
</p><!-- l. 283 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 3: </span><a href='https://eprint.iacr.org/2012/099.pdf'>Homomorphic Evaluation of the AES Circuit</a> <span class='cite'>[<a href='refname.html#Xbgv-modswitch3'>23</a>]</span>
</p><!-- l. 286 --><p class='indent'>   Remember that the requirement of modulus switch is that while we change the ciphertext modulus
from <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> to
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>, it should decrypt to
the same plaintext <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
BGV’s modulus switch is similar to that of the RLWE modulus switch (<a href='RLWEModulusSwitching.html#rlwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>§</span>C-4.4<!-- tex4ht:ref: subsec:bgv-mult-plain  --></a>),
but there is an additional requirement, because BGV applies the scaling factor
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math> not to
plaintext <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>, but
to noise <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>.
In the case of BFV or CKKS, their decryption process only needs to round off the
noise in the low-digit area. However, in the case of BGV, the plaintext is in the low-digit
area and its decryption process has to remove the noise in the higher-bit area by
modulo-<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
reduction (i.e., the plaintext modulus). More concretely, BGV’s modulus switch from
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>→</mo></mrow></math>
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> should satisfy the decryption
relation such that <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>. In
BGV’s modulus switch, <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
does not have to be one of the multiplicative levels of the ciphertext, and
<!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> only needs to satisfy
the relationship: <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
and <!-- l. 286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
BGV’s modulus switch procedure is as follows:
</p><!-- l. 288 --><p class='indent'>   <!-- l. 288 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 291 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>The input ciphertext is <!-- l. 293 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   We compute new polynomials <!-- l. 293 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   and <!-- l. 293 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   as follows:
   <!-- l. 295 --><p class='noindent'><!-- l. 295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 297 --><p class='noindent'><!-- l. 297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 299 --><p class='noindent'>And we compute the rounding error <!-- l. 299 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
                                                                                         
                                                                                         
   </p><!-- l. 301 --><p class='noindent'><!-- l. 301 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   </p><!-- l. 303 --><p class='noindent'><!-- l. 303 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   </p><!-- l. 306 --><p class='noindent'><!-- l. 306 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 308 --><p class='noindent'>, which we rewrite as follows:
   </p><!-- l. 310 --><p class='noindent'><!-- l. 310 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'># we denote <!-- l. 310 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   where <!-- l. 310 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 312 --><p class='noindent'><!-- l. 312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'># we denote <!-- l. 312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>,
   where <!-- l. 312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 314 --><p class='noindent'><!-- l. 314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>We compute new polynomials <!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></math>
   and <!-- l. 316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math>
   as follows:
   <!-- l. 318 --><p class='noindent'><!-- l. 318 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 320 --><p class='noindent'><!-- l. 320 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 322 --><p class='noindent'><!-- l. 322 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>We compute the final mod-switched ciphertext <!-- l. 324 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   as follows:
   <!-- l. 326 --><p class='noindent'><!-- l. 326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 328 --><p class='noindent'><!-- l. 328 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 330 --><p class='noindent'>Note that the computation result of <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   alone can exceed the range <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math>,
   because <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>.
   Therefore, we need to reduce <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   to derive <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 330 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>.
   </p><!-- l. 332 --><p class='noindent'><!-- l. 332 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>From now on, we will verify that <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a valid ciphertext satisfying BGV’s required decryption relation. First, we can derive the
   relationship among <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   and <!-- l. 334 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
   <!-- l. 336 --><p class='noindent'><!-- l. 336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 338 --><p class='noindent'><!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> # applying step 1’s result: <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow></math>,
    <!-- l. 338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow></math></span>
                                                                                         
                                                                                         
   </p><!-- l. 340 --><p class='noindent'><!-- l. 340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> # applying step 2’s result: <!-- l. 341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 343 --><p class='noindent'><!-- l. 343 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 345 --><p class='noindent'><!-- l. 345 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 349 --><p class='noindent'><!-- l. 349 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 351 --><p class='noindent'>So, <!-- l. 351 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   But in BGV, <!-- l. 351 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   Thus, the following holds:
   </p><!-- l. 353 --><p class='noindent'><!-- l. 353 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>𝑚𝑜𝑑</mi><mspace width='0.3em'></mspace><mi>t</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 359 --><p class='noindent'><!-- l. 359 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>We can derive the decryption relation of <!-- l. 361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   from the decryption relation of <!-- l. 361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></math>
   as follows:
   <!-- l. 363 --><p class='noindent'><!-- l. 363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> # The BGV
   decryption relation of <!-- l. 363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 365 --><p class='noindent'><!-- l. 365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> # where
   <!-- l. 365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math> represents
   the modulo-<!-- l. 365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
   reduction</span>
   </p><!-- l. 367 --><p class='noindent'><!-- l. 367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> # applying
   step 4’s result: <!-- l. 367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>≡</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 369 --><p class='noindent'><!-- l. 369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> # since in
   BGV, <!-- l. 369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>, and
   we chose <!-- l. 369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   such that <!-- l. 369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 371 --><p class='noindent'><!-- l. 371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 373 --><p class='noindent'>Now, if we can prove that <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (i.e., <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   reduces <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo-<!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>), then this sufficiently
   leads to the conclusion that <!-- l. 373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>.
   </p><!-- l. 375 --><p class='noindent'><!-- l. 375 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>The following is also true:
   <!-- l. 379 --><p class='noindent'><!-- l. 379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 381 --><p class='noindent'><!-- l. 381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 383 --><p class='noindent'><span style='color:#FF0000;'># where <!-- l. 383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   <!-- l. 383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></span>
   </p><!-- l. 385 --><p class='noindent'><!-- l. 385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 387 --><p class='noindent'><!-- l. 387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> <span style='color:#FF0000;'> # applying
   step 3: <!-- l. 387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
    <!-- l. 387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></span>
                                                                                         
                                                                                         
   </p><!-- l. 389 --><p class='noindent'><!-- l. 389 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 391 --><p class='noindent'>Therefore, proving <!-- l. 391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> is
   equivalent to proving <!-- l. 391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   </p><!-- l. 393 --><p class='noindent'><!-- l. 393 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'>We will prove that <!-- l. 396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   as follows:
   <!-- l. 398 --><p class='noindent'><!-- l. 398 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 401 --><p class='noindent'><!-- l. 401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 403 --><p class='noindent'><span style='color:#FF0000;'> # applying step 1’s result: <!-- l. 403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math></span>
   </p><!-- l. 405 --><p class='noindent'><!-- l. 405 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 407 --><p class='noindent'><!-- l. 407 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 409 --><p class='noindent'><!-- l. 409 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'> #
   rearranging the terms</span>
   </p><!-- l. 411 --><p class='noindent'><!-- l. 411 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'> # taking out the
   common factor <!-- l. 411 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math></span>
   </p><!-- l. 413 --><p class='noindent'><!-- l. 413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'> # since
   <!-- l. 413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 415 --><p class='noindent'><!-- l. 415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 417 --><p class='noindent'>For successful decryption, every coefficient of the resulting polynomial of the above expression has to be within the
   range <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math> (which
   means that <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> has
   successfully reduced <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>). The
   first term <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   can be viewed as the original ciphertext <span class='rm-lmss-10x-x-109'>ct</span>’s noise (with the plaintext message) scaled down by
   <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>. The coefficients of the
   second term <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi></mrow></math> are also
   small, because <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math> and
   <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></math>. The coefficients of the
   third term <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math> are also small,
   because <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>. The coefficients
   of the last term <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math> are
   also small, because <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   and <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   are <!-- l. 417 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow> <mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow>
<mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></mfrac> </mrow></msub></mrow></math>.
   </p><!-- l. 419 --><p class='noindent'><!-- l. 419 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p><!-- l. 421 --><p class='noindent'>Therefore, <!-- l. 421 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (provided the above error thresholds hold).
   </p><!-- l. 423 --><p class='noindent'><!-- l. 423 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
8. </dt><dd class='enumerate-enumitem'>Finally, we combine the results of step 6 and 7 as follows:
   <!-- l. 427 --><p class='noindent'><!-- l. 427 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 429 --><p class='noindent'><!-- l. 429 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> #
   by applying step 6</span>
   </p><!-- l. 431 --><p class='noindent'><!-- l. 431 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'> #
   by applying step 7</span>
   </p><!-- l. 433 --><p class='noindent'><!-- l. 433 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>
   </p><!-- l. 435 --><p class='noindent'><!-- l. 435 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 437 --><p class='noindent'>This means that decrypting <!-- l. 437 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   outputs the message <!-- l. 437 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
</p>
   </dd></dl>
<!-- l. 441 --><p class='indent'>   <!-- l. 441 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 443 --><p class='indent'>   We summarize BGV’s modulus switch as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-109'>     
<div class='tcolorbox-title'>
<!-- l. 479 --><p class='indent'>   <!-- l. 479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-4.7</span><!-- l. 479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>BGV’s Modulus Switch</span></p></div> 
<div class='tcolorbox-content'><!-- l. 449 --><p class='noindent'>Suppose we have the current ciphertext modulus <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
and new ciphertext modulus <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
where <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
and <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
Therefore, <!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
may       or       may       not       be       one       of       the       ciphertext       moduli
comprising        a        BGV        ciphertext’s        multiplicative        level        moduli
<!-- l. 449 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
</p><!-- l. 451 --><p class='noindent'><!-- l. 451 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 453 --><p class='noindent'>BGV’s                             modulus                             switch                             from
<!-- l. 453 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
is                              equivalent                              to                              updating
<!-- l. 453 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
to
<!-- l. 453 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
as follows:
</p><!-- l. 456 --><p class='noindent'><!-- l. 456 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo><msubsup><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></math>
</p><!-- l. 458 --><p class='noindent'><!-- l. 458 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 460 --><p class='noindent'><!-- l. 460 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>                                        #                                                       where
<!-- l. 460 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 462 --><p class='noindent'><!-- l. 462 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>                                        #                                                       where
<!-- l. 462 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 465 --><p class='noindent'><!-- l. 465 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 467 --><p class='noindent'><!-- l. 467 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 469 --><p class='noindent'><!-- l. 469 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>𝜖</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 471 --><p class='noindent'><!-- l. 471 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 473 --><p class='noindent'><!-- l. 473 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
</p><!-- l. 475 --><p class='noindent'><!-- l. 475 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 477 --><p class='noindent'>After       the       modulus       switch       (i.e.,       the       noise       scaling       factor),
<!-- l. 477 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi></mrow></math>
stays the same as before. The secret key <!-- l. 477 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
also   stays   the   same   as   before.   The   noise   gets   scaled   down   roughly   by
<!-- l. 477 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>,
but this does not decrease the noise-to-ciphertext modulus ratio.
</p>
 
</div> 
</div>
   
   <h5 class='subsubsectionHead' id='difference-between-modulus-switch-and-moddrop1'><span class='titlemark'>D-4.7.1   </span> <a id='x144-214000D-4.7.1'></a>Difference between Modulus Switch and <span class='rm-lmss-10x-x-109'>ModDrop</span></h5>
<!-- l. 486 --><p class='noindent'>In the case of CKKS (<a href='HomomorphicCiphertexttoCiphertextMultiplication1.html#rescaling1'><span class='ts1-lmr10-x-x-109'>§</span>D-3.5.4<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>), the difference between modulus switch and
<span class='rm-lmss-10x-x-109'>ModDrop </span>is that the former scales down the plaintext’s scaling factor by
                                                                                         
                                                                                         
<!-- l. 486 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≈</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>does not affect the plaintext’s scaling factor.
</p><!-- l. 488 --><p class='indent'>   Similarly, in the case of BGV, modulus switch (rescaling) and <span class='rm-lmss-10x-x-109'>ModDrop </span>from
<!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math> both lower a BGV
ciphertext’s modulus from <!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>.
However, the key difference is that rescaling also decreases the noise’s scaling factor by
<!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>≈</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>keeps the noise’s scaling factor the same as it is. Therefore, rescaling
is used only during ciphertext-to-ciphertext multiplication (to be explained in <a href='CiphertexttoCiphertextMultiplication1.html#ciphertexttociphertext-multiplication1'><span class='ts1-lmr10-x-x-109'>§</span>D-4.8<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>)
when scaling down the plaintext’s scaling factor in the intermediate ciphertext from
<!-- l. 488 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>→</mo><mi mathvariant='normal'>Δ</mi></mrow></math>.
Meanwhile, <span class='rm-lmss-10x-x-109'>ModDrop </span>is used to reduce the modulo computation time during an application’s routine when
it becomes certain that the ciphertext will not undergo any additional ciphertext-to-ciphertext
multiplication (i.e., no need to further decrease the ciphertext’s modulus).
</p><!-- l. 490 --><p class='indent'>   The main difference in modulus switch between CKKS and BGV is that the former decreases the plaintext’s scaling
factor by approximately <!-- l. 490 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></mfrac></mstyle></math>,
whereas the latter decreases the noise’s scaling factor by approximately
<!-- l. 490 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></mfrac></mstyle></math>.
</p><!-- l. 492 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Source Code: </span>Examples of BGV modulus switch can be executed by running <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/bgv.py'><span class='underline'>this Python script</span></a>.
                                                                                         
                                                                                         
</p>
   <!-- l. 495 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication1.html'>next</a>]</p></div>
    
</body> 
</html>