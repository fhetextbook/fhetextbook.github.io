<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Modulus Switch</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 273 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication2.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='modulus-switch1'><span class='titlemark'>D-4.7   </span>   <a id='x147-214000D-4.7'></a>Modulus Switch</h4>
<!-- l. 276 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 1: </span><a href='https://eprint.iacr.org/2020/1481'>Design and implementation of HElib: a homomorphic encryption library</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch1'>21</a>]</span>
</p><!-- l. 280 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 2: </span><a href='https://eprint.iacr.org/2011/277.pdf'>Fully Homomorphic Encryption without Bootstrapping</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch2'>22</a>]</span>
</p><!-- l. 284 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 3: </span><a href='https://eprint.iacr.org/2012/099.pdf'>Homomorphic Evaluation of the AES Circuit</a>ย<span class='cite'>[<a href='refname.html#Xbgv-modswitch3'>23</a>]</span>
</p><!-- l. 287 --><p class='indent'>   Remember that the requirement of modulus switch is that while we change the ciphertext modulus
from <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> to
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>, it should decrypt to
the same plaintext <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
BGVโs modulus switch is similar to that of the RLWE modulus switch (<a href='RLWEModulusSwitching.html#rlwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>ยง</span>C-4.4<!-- tex4ht:ref: subsec:bgv-mult-plain  --></a>),
but there is an additional requirement, because BGV applies the scaling factor
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>ฮ</mi></math> not to
plaintext <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>, but
to noise <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>.
In the case of BFV or CKKS, their decryption process only needs to round off the
noise in the low-digit area. However, in the case of BGV, the plaintext is in the low-digit
area and its decryption process has to remove the noise in the higher-bit area by
modulo-<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
reduction (i.e., the plaintext modulus). More concretely, BGVโs modulus switch from
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo></mrow></math>
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> should satisfy the decryption
relation such that <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>. In
BGVโs modulus switch, <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
does not have to be one of the multiplicative levels of the ciphertext, and
<!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> only needs to satisfy
the relationship: <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
and <!-- l. 287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
BGVโs modulus switch procedure is as follows:
</p><!-- l. 289 --><p class='indent'>   <!-- l. 289 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 292 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>The input ciphertext is <!-- l. 294 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
   We compute new polynomials <!-- l. 294 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></math>
   and <!-- l. 294 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></math>
   as follows:
   <!-- l. 296 --><p class='noindent'><!-- l. 296 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>๐๐๐</mi><mspace width='0.3em'></mspace><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 298 --><p class='noindent'><!-- l. 298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 300 --><p class='noindent'>And we compute the rounding error <!-- l. 300 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
                                                                                         
                                                                                         
   </p><!-- l. 302 --><p class='noindent'><!-- l. 302 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
   </p><!-- l. 304 --><p class='noindent'><!-- l. 304 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
   </p><!-- l. 307 --><p class='noindent'><!-- l. 307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 309 --><p class='noindent'>, which we rewrite as follows:
   </p><!-- l. 311 --><p class='noindent'><!-- l. 311 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 311 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   we denote <!-- l. 311 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   where <!-- l. 311 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 313 --><p class='noindent'><!-- l. 313 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 313 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   we denote <!-- l. 313 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>,
   where <!-- l. 313 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
   </p><!-- l. 315 --><p class='noindent'><!-- l. 315 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>We compute new polynomials <!-- l. 317 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></math>
   and <!-- l. 317 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math>
   as follows:
   <!-- l. 319 --><p class='noindent'><!-- l. 319 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 321 --><p class='noindent'><!-- l. 321 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 323 --><p class='noindent'><!-- l. 323 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>We compute the final mod-switched ciphertext <!-- l. 325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   as follows:
   <!-- l. 327 --><p class='noindent'><!-- l. 327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 329 --><p class='noindent'><!-- l. 329 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 331 --><p class='noindent'>Note that the computation result of <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   alone can exceed the range <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math>,
   because <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>.
   Therefore, we need to reduce <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>
   and <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   to derive <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
   and <!-- l. 331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>.
   </p><!-- l. 333 --><p class='noindent'><!-- l. 333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>From now on, we will verify that <!-- l. 335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is a valid ciphertext satisfying BGVโs required decryption relation. First, we can derive the
   relationship among <!-- l. 335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   <!-- l. 335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub></mrow></math>,
   and <!-- l. 335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   as follows:
   <!-- l. 337 --><p class='noindent'><!-- l. 337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 339 --><p class='noindent'><!-- l. 339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
                                                                                         
                                                                                         
   <span style='color:#FF0000;'> <!-- l. 339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   applying step 1โs result: <!-- l. 339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math>,
    <!-- l. 339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup></mrow></math></span>
   </p><!-- l. 341 --><p class='noindent'><!-- l. 341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 342 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   applying step 2โs result: <!-- l. 342 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 342 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 344 --><p class='noindent'><!-- l. 344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 346 --><p class='noindent'><!-- l. 346 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 350 --><p class='noindent'><!-- l. 350 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 352 --><p class='noindent'>So, <!-- l. 352 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   But in BGV, <!-- l. 352 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>.
   Thus, the following holds:
   </p><!-- l. 354 --><p class='noindent'><!-- l. 354 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.3em'></mspace><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='italic'>๐๐๐</mi><mspace width='0.3em'></mspace><mi>t</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 360 --><p class='noindent'><!-- l. 360 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>We can derive the decryption relation of <!-- l. 362 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   from the decryption relation of <!-- l. 362 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></math>
   as follows:
   <!-- l. 364 --><p class='noindent'><!-- l. 364 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 364 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>The BGV decryption
   relation of <!-- l. 364 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 366 --><p class='noindent'><!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>where
   <!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math> represents
   the modulo-<!-- l. 366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
   reduction</span>
   </p><!-- l. 368 --><p class='noindent'><!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>applying step
   4โs result: <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>,
    <!-- l. 368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>โก</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 370 --><p class='noindent'><!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>since in
   BGV, <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>, and
   we chose <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   such that <!-- l. 370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math></span>
   </p><!-- l. 372 --><p class='noindent'><!-- l. 372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 374 --><p class='noindent'>Now, if we can prove that <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (i.e., <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   reduces <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo-<!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>), then this sufficiently
   leads to the conclusion that <!-- l. 374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>.
   </p><!-- l. 376 --><p class='noindent'><!-- l. 376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>The following is also true:
                                                                                         
                                                                                         
   <!-- l. 380 --><p class='noindent'><!-- l. 380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 382 --><p class='noindent'><!-- l. 382 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 384 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>where
   <!-- l. 384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
   <!-- l. 384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></span>
   </p><!-- l. 386 --><p class='noindent'><!-- l. 386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 388 --><p class='noindent'><!-- l. 388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>applying
   step 3: <!-- l. 388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>,
    <!-- l. 388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math></span>
   </p><!-- l. 390 --><p class='noindent'><!-- l. 390 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 392 --><p class='noindent'>Therefore, proving <!-- l. 392 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> is
   equivalent to proving <!-- l. 392 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>.
   </p><!-- l. 394 --><p class='noindent'><!-- l. 394 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'>We will prove that <!-- l. 397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   as follows:
   <!-- l. 399 --><p class='noindent'><!-- l. 399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 402 --><p class='noindent'><!-- l. 402 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 404 --><p class='noindent'><span style='color:#FF0000;'> <!-- l. 404 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>applying step
   1โs result: <!-- l. 404 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>ย</mtext></mstyle><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math></span>
   </p><!-- l. 406 --><p class='noindent'><!-- l. 406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 408 --><p class='noindent'><!-- l. 408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 410 --><p class='noindent'><!-- l. 410 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 410 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
   rearranging the terms</span>
   </p><!-- l. 412 --><p class='noindent'><!-- l. 412 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 412 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>taking out the
   common factor <!-- l. 412 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math></span>
   </p><!-- l. 414 --><p class='noindent'><!-- l. 414 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 414 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>since
   <!-- l. 414 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math></span>
   </p><!-- l. 416 --><p class='noindent'><!-- l. 416 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 418 --><p class='noindent'>For successful decryption, every coefficient of the resulting polynomial of the above expression has to be within the
   range <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>โค</mi></mrow><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></math> (which
   means that <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> has
   successfully reduced <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></mrow></math>
   modulo <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>). The
   first term <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   can be viewed as the original ciphertext <span class='rm-lmss-10x-x-109'>ct</span>โs noise (with the plaintext message) scaled down by
   <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>. The coefficients of the
                                                                                         
                                                                                         
   second term <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi></mrow></math> are also
   small, because <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math> and
   <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>S</mi> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></math>. The coefficients of the
   third term <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub></math> are also small,
   because <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>. The coefficients
   of the last term <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
     </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>        </mrow></mfrac></mstyle></mrow></math> are
   also small, because <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   and <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup>
 </mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>
   are <!-- l. 418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow> <mfrac><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow>
<mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></mfrac> </mrow></msub></mrow></math>.
   </p><!-- l. 420 --><p class='noindent'><!-- l. 420 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 422 --><p class='noindent'>Therefore, <!-- l. 422 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>K</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   (provided the above error thresholds hold).
   </p><!-- l. 424 --><p class='noindent'><!-- l. 424 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
8. </dt><dd class='enumerate-enumitem'>Finally, we combine the results of step 6 and 7 as follows:
   <!-- l. 428 --><p class='noindent'><!-- l. 428 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
   </p><!-- l. 430 --><p class='noindent'><!-- l. 430 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 430 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>by
   applying step 6</span>
   </p><!-- l. 432 --><p class='noindent'><!-- l. 432 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math> <span style='color:#FF0000;'>
   <!-- l. 432 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>by
   applying step 7</span>
   </p><!-- l. 434 --><p class='noindent'><!-- l. 434 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>M</mi></mrow></math>
   </p><!-- l. 436 --><p class='noindent'><!-- l. 436 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 438 --><p class='noindent'>This means that decrypting <!-- l. 438 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   outputs the message <!-- l. 438 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>.
</p>
   </dd></dl>
<!-- l. 442 --><p class='indent'>   <!-- l. 442 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 444 --><p class='indent'>   We summarize BGVโs modulus switch as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-113'>     
<div class='tcolorbox-title'>
<!-- l. 480 --><p class='indent'>   <!-- l. 480 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>โจ</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>SummaryยD-4.7</span><!-- l. 480 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>โฉ</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>BGVโs Modulus Switch</span></p></div> 
<div class='tcolorbox-content'><!-- l. 450 --><p class='noindent'>Suppose we have the current ciphertext modulus <!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></math>
and new ciphertext modulus <!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
where <!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โก</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>โก</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
and <!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>.
Therefore, <!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
may       or       may       not       be       one       of       the       ciphertext       moduli
comprising        a        BGV        ciphertextโs        multiplicative        level        moduli
<!-- l. 450 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>โฏ</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>L</mi></mrow></msub></mrow></math>.
</p><!-- l. 452 --><p class='noindent'><!-- l. 452 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 454 --><p class='noindent'>BGVโs                             modulus                             switch                             from
<!-- l. 454 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
is                              equivalent                              to                              updating
<!-- l. 454 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></math>
to
<!-- l. 454 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
as follows:
</p><!-- l. 457 --><p class='noindent'><!-- l. 457 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>โ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>โ</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>โ</mo><msubsup><mrow><mstyle mathvariant='script'><mi>R</mi></mstyle></mrow><mrow><mo class='MathClass-open' stretchy='false'>โจ</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>โฉ</mo></mrow><mrow><mn>2</mn></mrow></msubsup></mrow></math>
</p><!-- l. 459 --><p class='noindent'><!-- l. 459 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 461 --><p class='noindent'><!-- l. 461 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>
<!-- l. 461 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
where
<!-- l. 461 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 463 --><p class='noindent'><!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>โ</mo><mi>B</mi> <mo class='MathClass-bin' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>โ</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'>
<!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>โน</mo></math>
where
<!-- l. 463 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>โ</mo> <msub><mrow><mi>โค</mi></mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub></mrow></msub></mrow></math></span>
</p><!-- l. 466 --><p class='noindent'><!-- l. 466 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 468 --><p class='noindent'><!-- l. 468 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 470 --><p class='noindent'><!-- l. 470 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>โ</mo><msubsup><mrow><mi>๐</mi></mrow><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>t</mi></mrow></math>
</p><!-- l. 472 --><p class='noindent'><!-- l. 472 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 474 --><p class='noindent'><!-- l. 474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>๐ผ๐</mtext></mstyle></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>A</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>B</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>A</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>โฒ</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>H</mi></mrow><mrow><mi>B</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
</p><!-- l. 476 --><p class='noindent'><!-- l. 476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 478 --><p class='noindent'>After       the       modulus       switch       (i.e.,       the       noise       scaling       factor),
<!-- l. 478 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>ฮ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi></mrow></math>
stays the same as before. The secret key <!-- l. 478 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
also   stays   the   same   as   before.   The   noise   gets   scaled   down   roughly   by
<!-- l. 478 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mover accent='true'><mrow><mi>q</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> </mrow></mfrac></mstyle></math>,
but this does not decrease the noise-to-ciphertext modulus ratio.
</p>
 
</div> 
</div>
   
                                                                                         
                                                                                         
   <h5 class='subsubsectionHead' id='difference-between-modulus-switch-and-moddrop1'><span class='titlemark'>D-4.7.1   </span>   <a id='x147-215000D-4.7.1'></a>Difference between Modulus Switch and <span class='rm-lmss-10x-x-109'>ModDrop</span></h5>
<!-- l. 487 --><p class='noindent'>In the case of CKKS (<a href='CiphertexttoCiphertextMultiplication1.html#rescaling1'><span class='ts1-lmr10-x-x-109'>ยง</span>D-3.5.4<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>), the difference between modulus switch and
<span class='rm-lmss-10x-x-109'>ModDrop </span>is that the former scales down the plaintextโs scaling factor by
<!-- l. 487 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>does not affect the plaintextโs scaling factor.
</p><!-- l. 489 --><p class='indent'>   Similarly, in the case of BGV, modulus switch (rescaling) and <span class='rm-lmss-10x-x-109'>ModDrop </span>from
<!-- l. 489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></math> both lower a BGV
ciphertextโs modulus from <!-- l. 489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>โ</mo><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></math>.
However, the key difference is that rescaling also decreases the noiseโs scaling factor by
<!-- l. 489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle displaystyle='true'><mfrac><mrow> <msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi></mrow></msub>
</mrow><mrow><msub><mrow><mi>q</mi></mrow><mrow><mi>l</mi><mo class='MathClass-bin' stretchy='false'>โ</mo><mn>1</mn></mrow></msub></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>โ</mo><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></mrow></math>,
whereas <span class='rm-lmss-10x-x-109'>ModDrop </span>keeps the noiseโs scaling factor the same as it is. Therefore, rescaling
is used only during ciphertext-to-ciphertext multiplication (to be explained in <a href='CiphertexttoCiphertextMultiplication2.html#ciphertexttociphertext-multiplication2'><span class='ts1-lmr10-x-x-109'>ยง</span>D-4.8<!-- tex4ht:ref: subsec:bgv-modulus-switch  --></a>)
when scaling down the plaintextโs scaling factor in the intermediate ciphertext from
<!-- l. 489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>ฮ</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>โ</mo><mi mathvariant='normal'>ฮ</mi></mrow></math>.
Meanwhile, <span class='rm-lmss-10x-x-109'>ModDrop </span>is used to reduce the modulo computation time during an applicationโs routine when
it becomes certain that the ciphertext will not undergo any additional ciphertext-to-ciphertext
multiplication (i.e., no need to further decrease the ciphertextโs modulus).
</p><!-- l. 491 --><p class='indent'>   The main difference in modulus switch between CKKS and BGV is that the former decreases the plaintextโs scaling
factor by approximately <!-- l. 491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></math>,
whereas the latter decreases the noiseโs scaling factor by approximately
<!-- l. 491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>1</mn>
</mrow><mrow><mi mathvariant='normal'>ฮ</mi></mrow></mfrac></mstyle></math>.
</p><!-- l. 493 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Source Code: </span>Examples of BGV modulus switch can be executed by running <a href='https://github.com/fhetextbook/fhe-textbook/blob/main/source%20code/bgv.py'><span class='underline'>this Python script</span></a>.
                                                                                         
                                                                                         
</p>
   <!-- l. 496 --><div class='crosslinks'><p class='noindent'>[<a href='textsfModDrop1.html'>prev</a>][<a href='BGVScheme.html#ModulusSwitch.html'>parent</a>][<a href='CiphertexttoCiphertextMultiplication2.html'>next</a>]</p></div>
    
</body> 
</html>