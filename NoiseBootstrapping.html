<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Noise Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 536 --><div class='crosslinks'><p class='noindent'>[<a href='CoefficientExtraction.html'>prev</a>][<a href='TFHEScheme.html#NoiseBootstrapping.html'>parent</a>][<a href='TFHEonaDiscreteTorus.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='noise-bootstrapping'><span class='titlemark'>D-1.8   </span> <a id='x109-128000D-1.8'></a>Noise Bootstrapping</h4>
<!-- l. 540 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference: </span><a href='https://www.zama.ai/post/tfhe-deep-dive-part-4'>TFHE Deep Dive - Part IV - Programmable Bootstrapping</a> <span class='cite'>[<a href='refname.html#Xtfhe-4'>10</a>]</span>
</p><!-- l. 543 --><p class='indent'>   <!-- l. 543 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 545 --><p class='indent'>   Continuing homomorphic additions of TFHE ciphertexts does not necessarily increase the noise
<!-- l. 545 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>,
because <!-- l. 545 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>
is randomly generated over the Gaussian distribution, thus adding up many noises would
give the mean value of 0. On the other hand, continuing homomorphic multiplications
increases the noise, because the noise terms get multiplied, growing its magnitude. Thus,
we need to somehow <span class='rm-lmri-10x-x-109'>reset </span>the noise before it trespasses on the higher bits where plaintext
<!-- l. 545 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> resides
(i.e., preventing the red noise bits from overflowing to the blue plaintext bits as shown in <a href='LWECryptosystem.html#an-illustration-of-lwes-plaintext-scaling-and-adding-a-noise-delta-m-e-zq'>Figure 8<!-- tex4ht:ref: subsec:tfhe-extraction  --></a>). The
process of re-initializing the noise to a smaller value is called noise bootstrapping.
</p><!-- l. 547 --><p class='indent'>   As explained in the beginning of this section, TFHE uses LWE (which is GLWE with
<!-- l. 547 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>) to encrypt &amp; decrypt a plaintext.
That is, each plaintext is <!-- l. 547 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(a single number), encoded as a zero-degree polynomial. Further, the secret key S that encrypts each
<!-- l. 547 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> is a
vector <!-- l. 547 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-rel' stretchy='false'>⋯</mo><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
instead of a polynomial. On the other hand, TFHE’s noise bootstrapping uses homomorphic addition
between GLWE ciphertexts and homomorphic multiplication between GLWE and GGSW
ciphertexts.
</p><!-- l. 551 --><p class='indent'>   Suppose we have a TFHE ciphertext as follows:
</p><!-- l. 553 --><p class='indent'>   <!-- l. 553 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 555 --><p class='indent'>   <!-- l. 555 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 557 --><p class='indent'>   <!-- l. 557 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></mrow></math>
</p><!-- l. 559 --><p class='indent'>   <!-- l. 559 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 561 --><p class='indent'>   <!-- l. 561 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 563 --><p class='indent'>   , where <!-- l. 563 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub></math> is a
big noise accumulated over a series of many ciphertext (or plaintext) multiplications. The goal of noise bootstrapping
is to convert <!-- l. 563 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
into <!-- l. 563 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
such that:
</p><!-- l. 565 --><p class='indent'>   <!-- l. 565 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 567 --><p class='indent'>   <!-- l. 567 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>b</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msubsup><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>
</p><!-- l. 569 --><p class='indent'>   <!-- l. 569 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 571 --><p class='indent'>   , where <!-- l. 571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>
is a re-initialized noise.
</p><!-- l. 573 --><p class='indent'>   <!-- l. 573 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='overview3'><span class='titlemark'>D-1.8.1   </span> <a id='x109-129000D-1.8.1'></a>Overview</h5>
<!-- l. 577 --><p class='noindent'>To implement noise bootstrapping, we create a specially designed
<!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> called a Lookup Table
(LUT). Before explaining <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
we will first motivate the idea based on a preliminary LUT polynomial
<!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. Imagine that the
polynomial <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s each
degree term <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></math> has its
exponent <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></math>, a plaintext
<!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> with some noise
<!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></msub></mrow></math>, and its corresponding
coefficient <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>, which is a noise-free
plaintext. Therefore, the <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial <!-- l. 577 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is defined as follows:
</p><!-- l. 579 --><p class='indent'>   <!-- l. 579 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>q</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>q</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 581 --><p class='indent'>     <!-- l. 581 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 581 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
terms</span>
</p><!-- l. 583 --><p class='indent'>     <!-- l. 583 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 583 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
terms</span>
</p><!-- l. 585 --><p class='indent'>     <!-- l. 585 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 587 --><p class='indent'>     <!-- l. 587 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>e</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 587 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi mathvariant='normal'>Δ</mi></math>
terms</span>
</p><!-- l. 589 --><p class='indent'>   <!-- l. 589 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 591 --><p class='indent'>   In the above formula, each <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
and <!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>k</mi></mrow></msub></math>
represent every possible plaintext message and error values (where
<!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math> and
<!-- l. 591 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></msub></mrow></math>).
</p><!-- l. 593 --><p class='indent'>   We design <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to have the
special property that each <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
term represents the special mapping (exponent, coefficient)
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, where
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></math> can be any value in
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi mathvariant='normal'>Δ</mi></mrow></msub></math>. During the TFHE setup stage,
we GLWE-encrypt <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using
our newly defined GLWE key <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>,
a <span class='rm-lmri-10x-x-109'>bootstrapping key</span>, which is different from the LWE secret key
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>.
                                                                                         
                                                                                         
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> is a list of
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomials with binary coefficients. Later, during the noise bootstrapping stage, we will rotate the coefficients
of <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> by
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions to the
left by computing <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></mrow></math>,
by using the polynomial coefficient rotation method 1 technique (Summary A-5.2.1 in <a href='CoefficientRotation.html#coefficient-rotation'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Then, we will
extract the polynomial’s constant term’s coefficient (i.e., the left-most 0-degree term’s coefficient in the rotated
polynomial <!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup></math>)
by using the coefficient extraction technique (<a href='CoefficientExtraction.html#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Further, we will encrypt
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as a GLWE ciphertext at the TFHE setup stage, and thus the rotated
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
extracted constant term’s coefficient is an LWE encryption of
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> (i.e.,
<!-- l. 593 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>) with a
re-initialized (i.e., completely reduced) noise.
</p><!-- l. 595 --><p class='indent'>   To summarize, the noise bootstrapping procedure can be conceptually understood (at least for now) as
follows:
</p><!-- l. 597 --><p class='indent'>   <!-- l. 597 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 600 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Input</span></span><span class='rm-lmbx-10x-x-109'>: </span><!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a noisy ciphertext encrypting <!-- l. 600 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Convert the input into the form of <!-- l. 601 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></math>
   as a rotator of <!-- l. 601 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (Lookup Table).
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Rotate <!-- l. 602 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub></math>
   to the left by <!-- l. 602 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   positions by computing <!-- l. 602 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow><mrow><mi>′</mi></mrow></msubsup></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>Extract the rotated <!-- l. 603 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   constant term’s coefficient <!-- l. 603 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   as an LWE encryption, which is <!-- l. 603 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Output</span></span><span class='rm-lmbx-10x-x-109'>: </span><!-- l. 604 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as an LWE encryption of the plaintext <!-- l. 604 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   with a re-initialized noise</dd></dl>
<!-- l. 607 --><p class='indent'>   <!-- l. 607 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 609 --><p class='indent'>   The output <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
encrypts the same plaintext message as the input ciphertext, but with completely reduced noise. Therefore, the output
<!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> can be used for
subsequent TFHE homomorphic operations (e.g., addition or multiplication). During this noise bootstrapping process,
                                                                                         
                                                                                         
the polynomial <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub></math>
is used as a <span class='rm-lmri-10x-x-109'>dictionary </span>that contains the mappings from the noisy plaintext
<!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> (i.e., as
<!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>j</mi></mrow></math> where
<!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>) to the noise-free
plaintext <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
(i.e., as <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></mrow></math>
where <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>).
Therefore, <!-- l. 609 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub></math>
is called the Lookup Table (LUT).
</p><!-- l. 611 --><p class='indent'>   Then, what should be the degree of <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>?
In order for <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to encode all
possible mappings from <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
to <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>,
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> should be a
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial.
However, <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
is a very big number, and it is computationally infeasible to manage a
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial. Thus, in practice, we instead use a much smaller polynomial
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> whose degree is only
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Remember that according
to our TFHE setup, <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≪</mo><mi>q</mi></mrow></math>.
Therefore, we need a way to <span class='rm-lmri-10x-x-109'>compress </span>the big ciphertext space
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math> into a much smaller space
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></math> and encode the compressed
values as the exponents of <!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></math>
in a <span class='rm-lmri-10x-x-109'>proportionally </span>correct way. For this proportional compression of
<!-- l. 611 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>n</mi></mrow></msub></mrow></math>, we will
use the LWE modulus switching technique learned from <a href='LWEModulusSwitching.html#lwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>§</span>C-4.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>.
   
</p>
   <h5 class='subsubsectionHead' id='modulus-switch-for-noise-boootstrapping'><span class='titlemark'>D-1.8.2   </span> <a id='x109-130000D-1.8.2'></a>Modulus Switch for Noise Boootstrapping</h5>
<!-- l. 616 --><p class='noindent'>To avoid using the giant <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>q</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>q</mi></mrow></msub></math>, we will
compress <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> possible
ciphertext elements <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
into <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct exponents
of the <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
polynomial <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>,
where each <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math> term
in <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> represents a
mapping from <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></mrow></math>
                                                                                         
                                                                                         
(i.e., noisy plaintext to noise-free plaintext). However, notice that when we rotate the coefficients of the
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> to the left, as
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math> rotates across the
boundary between <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math>
and <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math> degree
terms, <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></math>’s
sign flips to <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></mrow></math>
(as shown in the example of <a href='CoefficientRotation.html#example1'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>). Due to this coefficient sign flip, the
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> can theoretically encode
total <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct coefficient
states as follows: <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. To
move each of these <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math>
distinct coefficients to the constant term’s coefficient position in
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> (i.e., shifting the
coefficient <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></math> to the
leftmost term in <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>), the
rotating computation of <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup></mrow></math>
can use <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math> values, which
are <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, to move
each of <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
coefficients to the constant term’s position. This implies that the exponent
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math> in
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup></mrow></math> can use any of the
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> distinct values to cover all
possible <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math> (sign-flipped)
coefficient states of <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>. Also,
remember that <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>. Therefore,
we will switch the modulo of <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
from <!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>.
Using the LWE modulus switching technique (<a href='LWEModulusSwitching.html#lwe-modulus-switching'><span class='ts1-lmr10-x-x-109'>§</span>C-4.1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), our original LWE ciphertext
<!-- l. 616 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>a</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math> (i.e.,
the initial input to the noise bootstrapping procedure) will be converted into the following:
</p><!-- l. 618 --><p class='indent'>   <!-- l. 618 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 620 --><p class='indent'>   <!-- l. 620 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msubsup></mrow></math>
</p><!-- l. 622 --><p class='indent'>   <!-- l. 622 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi></mrow></msubsup></mrow></math> <span style='color:#FF0000;'># the secret key
stays the same, as each <!-- l. 622 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is binary</span>
</p><!-- l. 624 --><p class='indent'>   <!-- l. 624 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>t</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 626 --><p class='indent'>   <!-- l. 626 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 628 --><p class='indent'>   <!-- l. 628 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>e</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 630 --><p class='indent'>   <!-- l. 630 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>b</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></mrow></math>
</p><!-- l. 634 --><p class='indent'>   <!-- l. 634 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 636 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The degree of </span><!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
<span class='rm-lmbx-10x-x-109'>and Security</span>: If our goal were to design the minimal-degree polynomial
<!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
whose coefficients map all possible values of the plaintext
<!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>, then it would be sufficient to
design a <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>-degree polynomial
<!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>. Nonetheless, the reason
why we choose the degree of <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to be <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi></mrow></math>
instead of <!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
is to guarantee an enough security level– the higher the polynomial degree
<!-- l. 636 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> is, the
safer our scheme is against attacks.
   
</p>
   <h5 class='subsubsectionHead' id='halving-the-plaintext-space-to-be-used'><span class='titlemark'>D-1.8.3   </span> <a id='x109-131000D-1.8.3'></a>Halving the Plaintext Space To be Used</h5>
<!-- l. 643 --><p class='noindent'>Problematically, the LUT polynomial <!-- l. 643 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
rotates <span class='rm-lmri-10x-x-109'>negacyclically</span>, that is, <!-- l. 643 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(i.e., coefficients flip their signs with the rotation period of
<!-- l. 643 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>). More
generally:
</p><!-- l. 646 --><p class='indent'>   <!-- l. 646 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
</p><!-- l. 649 --><p class='indent'>   <!-- l. 649 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>j</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace><mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mi>n</mi>    <mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>for </mtext></mstyle><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mn>2</mn><mi>n</mi><mspace class='quad' width='1em'></mspace></mtd></mtr> <!-- @{}l@{\quad }l@{} --></mtable>                                                                       </mrow><mo fence='true' form='postfix'></mo></mrow></mrow></mrow></math>
</p><!-- l. 657 --><p class='indent'>   <!-- l. 657 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 659 --><p class='noindent'>, where <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
denotes the constant term’s coefficient after rotating the polynomial
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math> positions to the left.
Problematically, <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>v</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
flips its sign whenever its rotation crosses the boundary between
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> and
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>. Given the
modulus-switched values <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>j</mi></mrow></msub></math>,
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>, and
<!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>, we design the following
LUT polynomial <!-- l. 659 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>:
</p><!-- l. 661 --><p class='indent'>   <!-- l. 661 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 663 --><p class='indent'>   <!-- l. 663 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 665 --><p class='indent'>     <!-- l. 665 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 665 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
                                                                                         
                                                                                         
terms</span>
</p><!-- l. 667 --><p class='indent'>     <!-- l. 667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 667 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
terms</span>
</p><!-- l. 669 --><p class='indent'>     <!-- l. 669 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 671 --><p class='indent'>     <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub>
                             </mrow></msup></mrow></math> <span style='color:#FF0000;'> #
total <!-- l. 671 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
terms</span>
</p><!-- l. 673 --><p class='indent'>   <!-- l. 673 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 676 --><p class='indent'>   Remember that by computing <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup></mrow></math>
for <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, we can rotate
<!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s coefficients to the
left by <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math> positions.
For each <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>j</mi></math>-slot
rotation of <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> where
<!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>, the rotated
polynomial <!-- l. 676 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
gets the following values as the constant-term’s coefficient:
</p><!-- l. 678 --><p class='indent'>   <!-- l. 678 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover class='msup'><mrow><mover accent='false'><mrow><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow>
<mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover></mrow><mo>︷</mo></mover></mrow><mrow><mstyle class='text'><mtext></mtext><mstyle class='math'><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext>’s constant term’s coefficient for </mtext><mstyle class='math'><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mstyle><mtext> rotations</mtext></mstyle></mrow></mover></math>
</p><!-- l. 682 --><p class='indent'>   <!-- l. 682 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 684 --><p class='indent'>   In the above expression, <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></math>
is a noise that can range from <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
Note that all of <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
exponents are designed to be mapped to the same coefficient value,
<!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, which aligns with the fact
that their underlying plaintext <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is the same when decrypted (once their associated noise
<!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></math> gets eliminated). This is
why each <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is redundantly
used <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> times in a row
as coefficients in <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
We can view this sequential repetition of coefficients as having a robustness of mapping each
<!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></math> to
<!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub></math> against any
noise <!-- l. 684 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>.
</p><!-- l. 686 --><p class='indent'>   So far, the above sequence of <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
coefficients is what we expect <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(i.e., the rotated polynomial) to return as its constant term’s coefficient for each of
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> rotations
(where each <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></mrow></math>).
However, the correctness of the coefficient mappings breaks when the rotation count is between
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
because their coefficients flip their signs when they cross the term’s boundary from
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup></math> to
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, due to the
                                                                                         
                                                                                         
polynomial ring’s negacyclic nature. Specifically, the constant term’s coefficient values of the rotated polynomial
<!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> are as follows for
each rotation of <!-- l. 686 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions:
</p><!-- l. 688 --><p class='indent'>   <!-- l. 688 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 690 --><p class='indent'>   <!-- l. 690 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover class='msup'><mrow><mover accent='false'><mrow><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mover class='msup'><mrow><mover accent='false'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow>
<mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow><mo>⏟</mo></munder></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mstyle class='text'><mtext>coeff. of </mtext></mstyle><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></msup></mrow></munder></mrow><mo>︷</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mstyle class='text'><mtext> repetitions</mtext></mstyle></mrow></mover></mrow><mo>︷</mo></mover></mrow><mrow><mstyle class='text'><mtext></mtext><mstyle class='math'><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mtext>’s constant term’s coefficient after each of </mtext><mstyle class='math'><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mstyle><mtext> rotations</mtext></mstyle></mrow></mover></math>
</p><!-- l. 692 --><p class='indent'>   <!-- l. 692 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 694 --><p class='indent'>   As we can see above, the rotated <!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
constant term’s coefficient shows a negacyclic pattern with the rotation period of
<!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>, where the
second <!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-rotation
group’s coefficients are exactly the negated values of the first
<!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-rotation
group’s values. Let’s understand why this negacyclic behavior breaks the (exponent, coefficient) =
<!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> mappings.
Since TFHE’s plaintext and ciphertext values are defined in rings, as we rotate the LUT polynomial
<!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, we ideally want the rotated
polynomial <!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant
term’s value (i.e., mapped plaintext value) to wrap around in a circular manner, representing a ring pattern (with sequential
<!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math> repetitions of each value to
be resistant against up to a <!-- l. 694 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><msub><mrow><mi>Z</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>
noise). However, the negacyclic nature of a polynomial ring makes the constant term’s value of the
second-half rotation group problematic, because they are exact negations of those of the first-half rotation
group, breaking the circular wrapping-around ring pattern between the first-group values and the
second-group values.
</p><!-- l. 697 --><p class='indent'>   To summarize the problem, <!-- l. 697 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
has a limitation in becoming a perfect LUT, because it preserves the correct mappings of (exponent, coefficient)
= <!-- l. 697 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> only for
one half of <!-- l. 697 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></mrow></math>,
not for the other half.
</p><!-- l. 699 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Solution: </span>Good news is that we have observed that
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s mappings of (exponent,
coefficient) = <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> preserve their
ring-pattern consistency if <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
is rotated no more than <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions (i.e., the first-half rotation group). Therefore, the easiest solution to avoid the
negacyclic problem of the LUT polynomial rotation is that the application of TFHE restricts
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> to be rotated
no more than <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions <span class='rm-lmri-10x-x-109'>by design </span>during the noise bootstrapping. To enforce this, when the TFHE application’s
computation pipeline processes plaintext values (in its original plaintext computation logic before considering
any homomorphic operations), the application should ensure to involve only some pre-defined continuous
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values
within <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math> as the
possible inputs and outputs of each computation step. This constraint effectively ensures the possible values of
                                                                                         
                                                                                         
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> to be continuous
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> values within
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi></mrow></msub></math>. Since the LUT
polynomial <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> gets rotated
by computing <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>, as the
application restricts <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
to be at most <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> (out of
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>) by its application
design, <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> will be
rotated at most <!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions during the noise bootstrapping. Thus, we can prevent the occurrences of the problematic
<!-- l. 700 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi>n</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
rotations that flip the signs of coefficients.
</p><!-- l. 702 --><p class='indent'>   To summarize, at the cost of halving the application’s usable plaintext values to some continuous
<!-- l. 702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> values within
<!-- l. 702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>, we can prevent
<!-- l. 702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s negacyclic rotation problem, and
thereby preserve <!-- l. 702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s correct mappings
of (exponent, coefficient) = <!-- l. 702 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 725 --><p class='indent'>   Considering all these, our final LUT polynomial
<!-- l. 725 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is as
follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-76'>     
<div class='tcolorbox-title'>
<!-- l. 748 --><p class='indent'>   <!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-1.8.3</span><!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>Structure  of  Lookup  Table  Polynomial</span>
                                                                                         
                                                                                         
<!-- l. 748 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐕</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>𝐗</mi><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math></p></div> 
<div class='tcolorbox-content'><!-- l. 729 --><p class='noindent'><!-- l. 729 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 731 --><p class='noindent'><!-- l. 731 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>
</p><!-- l. 733 --><p class='noindent'>
<!-- l. 733 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 735 --><p class='noindent'>
<!-- l. 735 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
</p><!-- l. 737 --><p class='noindent'>
<!-- l. 737 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle></mrow></math>
</p><!-- l. 739 --><p class='noindent'>
<!-- l. 739 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub>
                       </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub>
                       </mrow></msup></mrow></math>
</p><!-- l. 741 --><p class='noindent'>
<!-- l. 741 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub>
                             </mrow></msup></mrow></math>
</p><!-- l. 743 --><p class='noindent'><!-- l. 743 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 745 --><p class='noindent'>, where <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>t</mi> </mrow></mfrac></mstyle></mrow></math>.
The application should ensure that <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>m</mi></mrow><mrow><mi>t</mi><mo class='MathClass-bin' stretchy='false'>∕</mo><mn>2</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
are some continuous modulo-<!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
values in <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>.
This constraint ensures <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
rotation positions <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub></mrow></math>
(where <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>e</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msub></mrow></math>)
to be most <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
continuous possibilities, preventing <!-- l. 745 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
from making more than 1 full-cycle rotation that triggers a negacyclic problem.
</p>
 
</div> 
</div>
   
   <h5 class='subsubsectionHead' id='blind-rotation'><span class='titlemark'>D-1.8.4   </span> <a id='x109-132000D-1.8.4'></a>Blind Rotation</h5>
<!-- l. 754 --><p class='noindent'>Blind rotation refers to rotating an <span class='rm-lmri-10x-x-109'>encrypted </span>polynomial’s coefficients so that it is not possible to know
how many positions the polynomial’s coefficients are rotated, and after the rotation, it is not
possible to see which coefficient has moved to which degree term. Blind rotation uses the basic
polynomial rotation method 1 technique (Summary A-5.2 in <a href='CoefficientRotation.html#coefficient-rotation'><span class='ts1-lmr10-x-x-109'>§</span>A-5.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), with the difference that the
<!-- l. 754 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>
computation is done homomorphically.
</p><!-- l. 756 --><p class='indent'>   Note that <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                        </mrow></msup></mrow></math>, so
we can rotate <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
by computing <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo>
                               </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>.
In fact, we cannot directly compute the LWE decryption formula
<!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math> (or
<!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>) without the knowledge
of the LWE secret key <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>.
Nevertheless, there is a mathematical work-around to compute
<!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> without the knowledge of the
secret key <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, provided we are given
                                                                                         
                                                                                         
<!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> at the TFHE setup stage. Note
that <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mi mathvariant='italic'>𝐺𝐺𝑆</mi><msubsup><mrow><mi>W</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>}</mo></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup></math> is a GGSW encryption of
the LWE secret key <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, encrypted
by the GLWE secret key <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> (i.e.,
a <span class='rm-lmri-10x-x-109'>bootstrapping </span>key). We use <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math> to
homomorphically compute <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math> (i.e.,
blindly rotate the coefficients of <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 756 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  <!-- nolimits --></mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub></mrow></math>
positions), according to the following procedure:
</p><!-- l. 759 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>GLWE-encrypt the polynomial <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   with the bootstrapping key <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   at the TFHE setup stage, so that each coefficient of <!-- l. 759 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   gets encrypted.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msup></mrow></math>,
   which is basically rotating <!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>’s
   polynomials by <!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   positions to the left. Since <!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   is  a  known  value  visible  in  the  LWE  ciphertext,  we  can  directly  compute  the  rotation  of
   <!-- l. 760 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msup></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'>Compute <!-- l. 761 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>.
   This formula works for the special case where <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>{</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>:
   if <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>;
   else if <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>.
   Computing <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
   is done as a TFHE homomorphic addition and multiplication. We call this blind rotation of
   <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   where the selection bit <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   (i.e., the 1st element of the secret key vector <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>)
   is encrypted as a GGSW ciphertext by using <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>
   (i.e. the bootstrapping key) and <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is an encrypted polynomial as a GLWE ciphertext. Multiplying GLWE-encrypted <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   with <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>x</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
   is done by GLWE ciphertext-to-plaintext multiplication (<a href='GLWECiphertexttoPlaintextMultiplication.html#glwe-ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>C-3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and subtracting the result by
   GLWE-encrypted <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition/subtraction (<a href='GLWECiphertexttoCiphertextAddition.html#glwe-ciphertexttociphertext-addition'><span class='ts1-lmr10-x-x-109'>§</span>C-1<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and multiplying the
   result by GGSW-encrypted <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE-to-GGSW multiplication (<a href='HomomorphicCiphertexttoCiphertextMultiplication.html#generalization-to-glwetoggsw-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>D-1.6.2<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), and adding the result with GLWE-encrypted
   <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   is done by GLWE ciphertext-to-ciphertext addition. If <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
                                                                                         
                                                                                         
   then the formula’s <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></math>
   term gets multiplied to <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>,
   which effectively rotates <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>’s
   coefficients by <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></math>
   positions to the right. Else if <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>,
   then <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   does not get rotated and stays the same. In both cases, the resulting <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>
   is encrypted as a new GLWE ciphertext. During this blind rotation, unless we have the knowledge
   of <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math>
   and <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>,
   it is impossible to know whether <!-- l. 762 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
   has been rotated or not, and also how many positions have been rotated.
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'>By using the same blind rotation method as in the previous step, compute the GLWE encryption
   of <!-- l. 763 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>X</mi></mrow><mrow><mn>1</mn></mrow><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></mrow></math>.
   Note that we have the following publicly known components: <!-- l. 763 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></math>,
   a GLWE encryption of <!-- l. 763 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub></math>,
   and a GGSW ciphertext of <!-- l. 763 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></math>
   encrypted by using <!-- l. 763 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'>Continue to compute the GLWE encryption of <!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   in the same manner, and we finally get a GLWE encryption of <!-- l. 764 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
   whose computed value is equivalent to:
   <!-- l. 766 --><p class='noindent'><!-- l. 766 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>
   </p><!-- l. 768 --><p class='noindent'><!-- l. 768 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 770 --><p class='noindent'><!-- l. 770 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
   </p><!-- l. 772 --><p class='noindent'><!-- l. 772 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
   </p><!-- l. 774 --><p class='noindent'><!-- l. 774 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext> </mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
</p>
   </dd></dl>
<!-- l. 778 --><p class='indent'>   This means that the GLWE encryption of the final polynomial
<!-- l. 778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math> will have the coefficient
<!-- l. 778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> in its constant term,
as <!-- l. 778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is designed to
have the mapping (<!-- l. 778 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>m</mi></mrow></math>).
</p><!-- l. 780 --><p class='indent'>   Note that while we restrict the application’s plaintext space usage to some continuous
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo
values within <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:coeff-rotation  --></a>), this restriction does not exist in the ciphertext space. That is, it is okay for blind rotations to
rotate <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
positions during the intermediate steps, because their invalid positions can be brought back to valid ones by
their subsequent steps. Therefore, what matters for the noise bootstrapping correctness is only the completed
state <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. The
rotation-completed <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
must have been rotated <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
positions to the left. Therefore, we only need to ensure that
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math> falls within our
pre-defined continuous <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
modulo range within the <!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>
domain, which is equivalent to ensuring that the aggregate rotation count is at most
<!-- l. 780 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions to avoid coefficient extraction of any double-signed contradicting coefficients.
</p>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 784 --><p class='noindent' id='an-illustration-of-the-mux-logic-gate-'> <img alt='PIC' src='figures/mux-.png' /> <a id='x109-132006r13'></a></p>
<figcaption class='caption'><span class='id'>Figure 13: </span><span class='content'>An illustration of the MUX logic gate                                             </span></figcaption><!-- tex4ht:label?: x109-132006r13  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 789 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Homomorphic MUX Logic Gate: </span>In step 3, the formula
<!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
implements the MUX logic gate as shown in <a href='#an-illustration-of-the-mux-logic-gate-'>Figure 13<!-- tex4ht:ref: subsec:coeff-rotation  --></a>, where in our case
<!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is the selection bit that chooses
between the two inputs: <!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>
and <!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>. If
<!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></math> is 1, then the output is
<!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup></mrow></math>; otherwise, the output
is <!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></math>. In our design, the
homomorphic computation of <!-- l. 789 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
effectively implements a homomorphic MUX gate, where the two inputs are LWE-encrypted and the
selection bit is GGSW-encrypted.
   
</p>
   <h5 class='subsubsectionHead' id='coefficient-extraction1'><span class='titlemark'>D-1.8.5   </span> <a id='x109-133000D-1.8.5'></a>Coefficient Extraction</h5>
<!-- l. 794 --><p class='noindent'>Finally, we use the coefficient extraction technique (<a href='CoefficientExtraction.html#coefficient-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-1.7<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) to extract the rotated polynomial
<!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>V</mi> </mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s constant term’s coefficient
as an encryption of <!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>:
<!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>. At this point, the original
<!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></math> ciphertext’s old noise
<!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub></math> has gone, and the bootstrapped
new ciphertext <!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> has a newly
generated small noise <!-- l. 794 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>e</mi></mrow><mrow><mi>s</mi></mrow></msub></math>.
</p><!-- l. 796 --><p class='indent'>   In fact, the homomorphic MUX logic in the blind rotation procedure (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:coeff-rotation  --></a>) involves lots of ciphertext
multiplications and additions, which can accumulate additional noise until we reach the point of coefficient
extraction. In order to limit the accumulating noise during the series of MUX logic, we can carefully adjust the
security parameters. For example, we can design a narrower Gaussian distribution for sampling the noise
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>, while designing a
sufficiently large <!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
to compensate for the reduced noise. Meanwhile, increasing
<!-- l. 796 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
rather makes the system less secure, because it becomes more vulnerable to lattice reduction
attacks.
   
</p>
   <h5 class='subsubsectionHead' id='noise-bootstrapping-summary'><span class='titlemark'>D-1.8.6   </span> <a id='x109-134000D-1.8.6'></a>Noise Bootstrapping Summary</h5>
<!-- l. 806 --><p class='noindent'>TFHE’s noise bootstrapping procedure is summarized as follows:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-77'>     
<div class='tcolorbox-title'>
<!-- l. 861 --><p class='indent'>   <!-- l. 861 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-1.8.6</span><!-- l. 861 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>TFHE Noise Bootstrapping Procedure</span></p></div> 
<div class='tcolorbox-content'><!-- l. 810 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Lookup Table Encryption</span></span><span class='rm-lmbx-10x-x-109'>:          </span>Encrypt           the           LUT           polynomial
<!-- l. 810 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as       a       GLWE       ciphertext       by       using       the       bootstrapping       key
<!-- l. 810 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow><mrow><mi mathvariant='italic'>𝑏𝑘</mi></mrow></msub></math>.
</p><!-- l. 812 --><p class='noindent'><!-- l. 812 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span><span class='rm-lmbx-10x-x-109'>:     </span>Change     the     modulus     of     the     TFHE     ciphertext
    <!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>e</mi></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    from <!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>
   to get <!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
    where <!-- l. 815 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>t</mi> </mrow></mfrac></mstyle></mrow></math>.
    <!-- l. 817 --><p class='noindent'><!-- l. 817 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Blind Rotation</span></span><span class='rm-lmbx-10x-x-109'>:         </span>Rotate           the           GLWE-encrypted           polynomial
    <!-- l. 819 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
   by <!-- l. 819 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    positions to the left, by recursively computing:
    <!-- l. 821 --><p class='noindent'><!-- l. 821 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msup></mrow></math>
    </p><!-- l. 823 --><p class='noindent'><!-- l. 823 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub></mrow></math>
     </p><!-- l. 825 --><p class='noindent'>  <!-- l. 825 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>⋮</mi></math>
   </p><!-- l. 827 --><p class='noindent'><!-- l. 827 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
     </p><!-- l. 829 --><p class='noindent'><!-- l. 829 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup><mo class='MathClass-rel' stretchy='false'>⋯</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow></math>
      </p><!-- l. 831 --><p class='noindent'><!-- l. 831 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>+</mo><msubsup><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow><mrow>
<mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub>
                          </mrow></msup></mrow></math>
     </p><!-- l. 833 --><p class='noindent'><!-- l. 833 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>b</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup></mrow></math>
     </p><!-- l. 835 --><p class='noindent'><!-- l. 835 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
     </p><!-- l. 837 --><p class='noindent'>Each  step  of  the  actual  blind  rotation  above  is  computed  as  the  following  TFHE
    ciphertext-to-ciphertext multiplication and addition:
    </p><!-- l. 839 --><p class='noindent'><!-- l. 839 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 841 --><p class='noindent'><!-- l. 841 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Coefficient Extraction</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Homomorphically  extract  the  constant  term’s  coefficient
    <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   from the rotated polynomial <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></math>,
    which is <!-- l. 843 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
    </dd></dl>
<!-- l. 855 --><p class='noindent'><!-- l. 855 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 857 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Halving the Usable Plaintext Range</span></span><span class='rm-lmbx-10x-x-109'>:  </span>Problematically, the LUT polynomial V rotates
negacyclically. To avoid this problem, we require the application to ensure that the plaintext
<!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math> uses only continuous
<!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> modulo values
within <!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi></mrow></msub></math>. This way,
we avoid rotating <!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
more than <!-- l. 857 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
positions that cause coefficient extraction of double-signed contradicting coefficients.
</p> 
</div> 
</div>
                                                                                         
                                                                                         
   
   <h5 class='subsubsectionHead' id='example-noise-bootstrapping'><span class='titlemark'>D-1.8.7   </span> <a id='x109-135000D-1.8.7'></a>Example: Noise Bootstrapping</h5>
<!-- l. 867 --><p class='noindent'>Suppose the GLWE security setup: <!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math>,
<!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn></mrow></math>,
<!-- l. 867 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 869 --><p class='indent'>   <!-- l. 869 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 871 --><p class='indent'>   <!-- l. 871 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>29</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>30</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 873 --><p class='indent'>   <!-- l. 873 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mn>64</mn>
 </mrow><mrow><mn>8</mn> </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
</p><!-- l. 875 --><p class='indent'>   <!-- l. 875 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 877 --><p class='indent'>   And suppose we have the following LWE ciphertext:
</p><!-- l. 879 --><p class='indent'>   <!-- l. 879 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
</p><!-- l. 881 --><p class='indent'>   <!-- l. 881 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>t</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msub></mrow></math>
</p><!-- l. 883 --><p class='indent'>   <!-- l. 883 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>8</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 887 --><p class='indent'>   <!-- l. 887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>31</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>24</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
</p><!-- l. 890 --><p class='indent'>   <!-- l. 890 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math> (should be
the case that <!-- l. 890 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
for correct decryption)
</p><!-- l. 892 --><p class='indent'>   <!-- l. 892 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>b</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>8</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>31</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>7</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>8</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>24</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>q</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>64</mn></mrow></msub></mrow></math>
</p><!-- l. 894 --><p class='indent'>   <!-- l. 894 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 896 --><p class='indent'>   Now then, the TFHE noise bootstrapping procedure is as follows:
</p><!-- l. 898 --><p class='indent'>   <!-- l. 898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 901 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Modulus Switch: </span>Switch the modulus of <!-- l. 901 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   From <!-- l. 901 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>2</mn><mi>n</mi></mrow></math>,
   which is from <!-- l. 901 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>64</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>32</mn></mrow></math>.
   After the modulus switch, the original LWE ciphertext is converted as follows:
   <!-- l. 903 --><p class='noindent'><!-- l. 903 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>15</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mn>13</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>15</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   </p><!-- l. 905 --><p class='noindent'><!-- l. 905 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn></mrow><mrow><mi>k</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>8</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 908 --><p class='noindent'><!-- l. 908 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   </p><!-- l. 910 --><p class='noindent'><!-- l. 910 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 912 --><p class='noindent'><!-- l. 912 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mi>e</mi><mstyle displaystyle='true'><mfrac><mrow><mn>2</mn><mi>n</mi>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mn>2</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 914 --><p class='noindent'><!-- l. 914 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 916 --><p class='noindent'><!-- l. 916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msubsup><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mo class='MathClass-rel' stretchy='false'>=</mo><mn>9</mn></mrow></msubsup></mrow></math>
   </p><!-- l. 919 --><p class='noindent'><!-- l. 919 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>8</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>28</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>4</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>32</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>0</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>31</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>7</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌈</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mn>24</mn><mstyle displaystyle='true'><mfrac><mrow><mn>32</mn>
</mrow><mrow><mn>64</mn></mrow></mfrac></mstyle><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>⌋</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 921 --><p class='noindent'><!-- l. 921 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 923 --><p class='noindent'><!-- l. 923 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 925 --><p class='noindent'><!-- l. 925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 927 --><p class='noindent'>Note that <!-- l. 927 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>13</mn> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 929 --><p class='noindent'><!-- l. 929 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p><!-- l. 931 --><p class='noindent'><!-- l. 931 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-rel' stretchy='false'>≈</mo><mn>13</mn> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   </p><!-- l. 933 --><p class='noindent'>This small difference in <!-- l. 933 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></math>
   comes from the aggregated noises of rounding <!-- l. 933 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   during the modulus switch.
   </p><!-- l. 935 --><p class='noindent'><!-- l. 935 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Blind Rotation: </span>We assume that the application avoids the problem of negacyclic polynomial
   rotation by ensuring that the usable plaintext values are the following continuous <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mn>8</mn>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>
   modulo values within <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   which are <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   This implies that the only possible values of <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   in <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>
   will be: <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>.
   Based on these requirements, <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:tfhe-summary  --></a> is the Lookup Table polynomial <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   that maps <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>
   to <!-- l. 937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>.
   <div class='table'>
   <!-- l. 940 --><p class='noindent'></p><figure class='float' id='x109-135003r4'><span id='the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'></span>
   <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-37' rules='groups'><colgroup id='TBL-37-1g'><col id='TBL-37-1' /></colgroup><colgroup id='TBL-37-2g'><col id='TBL-37-2' /></colgroup><colgroup id='TBL-37-3g'><col id='TBL-37-3' /></colgroup><colgroup id='TBL-37-4g'><col id='TBL-37-4' /></colgroup><colgroup id='TBL-37-5g'><col id='TBL-37-5' /></colgroup><colgroup id='TBL-37-6g'><col id='TBL-37-6' /></colgroup><colgroup id='TBL-37-7g'><col id='TBL-37-7' /></colgroup><colgroup id='TBL-37-8g'><col id='TBL-37-8' /></colgroup><colgroup id='TBL-37-9g'><col id='TBL-37-9' /></colgroup><colgroup id='TBL-37-10g'><col id='TBL-37-10' /></colgroup><colgroup id='TBL-37-11g'><col id='TBL-37-11' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-1-'><td class='td11' colspan='7' id='TBL-37-1-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><!-- l. 947 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>4</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>5</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>         
</tr><tr id='TBL-37-2-'><td class='td11' colspan='7' id='TBL-37-2-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span style='color:#FFFFFF;'><span class='rm-lmr-9'>......</span></span> <!-- l. 948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow>
<mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>  
</tr><tr id='TBL-37-3-'><td class='td11' colspan='7' id='TBL-37-3-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span style='color:#FFFFFF;'><span class='rm-lmr-9'>....</span></span><!-- l. 949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>      
</tr><tr id='TBL-37-4-'><td class='td11' colspan='7' id='TBL-37-4-1' style='text-align:center; white-space:nowrap;'></td> <div class='multicolumn' style='text-align:left; white-space:nowrap;'><span style='color:#FFFFFF;'><span class='rm-lmr-9'>......</span></span><!-- l. 950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math></div>    
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-5-'><td class='td11' id='TBL-37-5-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 953 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>        </td><td class='td11' id='TBL-37-5-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-5-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td>
</tr><tr id='TBL-37-6-'><td class='td11' id='TBL-37-6-1' style='text-align:center; white-space:nowrap;'>     <span class='rm-lmr-9'>(in </span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math><span class='rm-lmr-9'>)        </span> </td><td class='td11' id='TBL-37-6-2' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>110</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow>
<mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-3' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>110</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-4' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>110</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-5' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>110</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-6' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>111</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-7' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>111</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>01</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-8' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>111</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>10</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-6-9' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 954 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><mstyle style='color:#FF8000;'><mn>111</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>11</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-7-'><td class='td11' id='TBL-37-7-1' style='text-align:center; white-space:nowrap;'>                                                 <span class='rm-lmbx-9'>constant term’s                                                                 </span> </td><td class='td11' id='TBL-37-7-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-7-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 956 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td>
</tr><tr id='TBL-37-8-'><td class='td11' id='TBL-37-8-1' style='text-align:center; white-space:nowrap;'>   <span class='rm-lmbx-9'>coeff. of </span><!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>    
 </td><td class='td11' id='TBL-37-8-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>110</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mstyle style='color:#FF8000;'><mn>111</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></math>    </td><td class='td11' id='TBL-37-8-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>111</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-9-'><td class='td11' id='TBL-37-9-1' style='text-align:center; white-space:nowrap;'> <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-9'>(plaintext)  </span> </td><td class='td11' id='TBL-37-9-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td><td class='td11' id='TBL-37-9-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-10-'><td class='td11' id='TBL-37-10-1' style='text-align:center; white-space:nowrap;'>       <!-- l. 962 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></math>        </td><td class='td11' id='TBL-37-10-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-10-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-10-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>   </td><td class='td11' id='TBL-37-10-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>3</mn></math>   </td><td class='td11' id='TBL-37-10-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>4</mn></math>   </td><td class='td11' id='TBL-37-10-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>5</mn></math>   </td><td class='td11' id='TBL-37-10-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>6</mn></math>   </td><td class='td11' id='TBL-37-10-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>7</mn></math>   </td>
</tr><tr id='TBL-37-11-'><td class='td11' id='TBL-37-11-1' style='text-align:center; white-space:nowrap;'>     <span class='rm-lmr-9'>(in </span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math><span class='rm-lmr-9'>)        </span> </td><td class='td11' id='TBL-37-11-2' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle></mrow><mrow>
<mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-3' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-4' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-5' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-6' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-7' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-8' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td><td class='td11' id='TBL-37-11-9' style='text-align:center; white-space:nowrap;'> <span class='rm-lmr-9'>(</span><!-- l. 963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#00FFFF;'></mstyle><msub><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math><span class='rm-lmr-9'>)  </span></td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-12-'><td class='td11' id='TBL-37-12-1' style='text-align:center; white-space:nowrap;'>                                                 <span class='rm-lmbx-9'>constant term’s                                                                 </span> </td><td class='td11' id='TBL-37-12-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-12-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-12-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-12-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-12-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-12-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-12-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-12-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 965 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td>
</tr><tr id='TBL-37-13-'><td class='td11' id='TBL-37-13-1' style='text-align:center; white-space:nowrap;'>   <span class='rm-lmbx-9'>coeff. of </span><!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mi>i</mi></mrow></msup></mrow></math>    
 </td><td class='td11' id='TBL-37-13-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>000</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td><td class='td11' id='TBL-37-13-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FF8000;'><mn>001</mn></mstyle><msub><mrow><mstyle style='color:#00FF00;'><mn>00</mn></mstyle></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>    </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-37-14-'><td class='td11' id='TBL-37-14-1' style='text-align:center; white-space:nowrap;'> <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝐦</mi></mstyle></math> <span class='rm-lmbx-9'>(plaintext)  </span> </td><td class='td11' id='TBL-37-14-2' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-14-3' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-14-4' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-14-5' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn></math>   </td><td class='td11' id='TBL-37-14-6' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-14-7' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-14-8' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td><td class='td11' id='TBL-37-14-9' style='text-align:center; white-space:nowrap;'>  <!-- l. 968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>   </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table> </div>
   
<figcaption class='caption'><span class='id'>Table 4: </span><span class='content'>The Lookup Table for <!-- l. 974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>64</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>
LWE setup. <span style='color:#FF8000;'>Orange</span> is the plaintext <!-- l. 974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>’s
bits. <span style='color:#00FF00;'>Green</span> is the noise <!-- l. 974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>e</mi></math>’s
bits.                                                                                      </span></figcaption><!-- tex4ht:label?: x109-135003r4  -->
   </figure>
   </div>
   <!-- l. 978 --><p class='noindent'>Note that <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s
   coefficients for the <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∼</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup></mrow></math>
   terms are <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   instead of <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
   so that if <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> gets
   rotated by <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>8</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>7</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>5</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>6</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>7</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
   slots to the left, the constant term’s coefficient flips its sign to
   <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>due to wrapping around
   the boundary of the <!-- l. 978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
   exponent.
   </p><!-- l. 980 --><p class='noindent'>During the actual bootstrapping, we will do a blind rotation of <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:tfhe-summary  --></a>’s
   <!-- l. 980 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> (which is
                                                                                         
                                                                                         
   GLWE-encrypted) by <!-- l. 980 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>
   positions to the left, which is computed as follows:
   </p><!-- l. 982 --><p class='noindent'><!-- l. 982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mover accent='true'><mrow><mi>e</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mi>i</mi></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>12</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>16</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn><mstyle class='text'><mtext> mod 32</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>2</mn><mi>n</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>32</mn></mrow></msub></mrow></math>
   </p><!-- l. 985 --><p class='noindent'>In <a href='#the-lookup-table-for-n-q-t-lwe-setup-orangeorange-is-the-plaintext-ms-bits-greengreen-is-the-noise-es-bits-'>Table 4<!-- tex4ht:ref: subsec:tfhe-summary  --></a>, if the rotation count <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
   the corresponding constant term’s coefficient is
   <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi></mrow></math>. As
   <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>, we finally
   get <!-- l. 985 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 989 --><p class='noindent'><!-- l. 989 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 991 --><p class='noindent'>The actual blind rotation is computed as follows:
   </p><!-- l. 993 --><p class='noindent'><!-- l. 993 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 995 --><p class='noindent'><!-- l. 995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mi>m</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>14</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>16</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>12</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 997 --><p class='noindent'><!-- l. 997 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi>b</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>V</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>12</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 999 --><p class='noindent'><!-- l. 999 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1001 --><p class='noindent'><!-- l. 1001 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>1</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1003 --><p class='noindent'><!-- l. 1003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>2</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1005 --><p class='noindent'><!-- l. 1005 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>3</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>3</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1007 --><p class='noindent'><!-- l. 1007 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>4</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>4</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>0</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1009 --><p class='noindent'><!-- l. 1009 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>5</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>5</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>5</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>16</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1011 --><p class='noindent'><!-- l. 1011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>6</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>6</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>6</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1013 --><p class='noindent'><!-- l. 1013 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>7</mn></mrow></msub><msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>s</mi></mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mover accent='true'><mrow><mi>a</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover></mrow><mrow><mn>7</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>V</mi> </mrow><mrow><mn>7</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mrow></math>
   </p><!-- l. 1015 --><p class='noindent'><!-- l. 1015 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1017 --><p class='noindent'>The final output of blind rotation is the GLWE ciphertext of
   <!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub></math>,
   <!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, whose constant
   term’s coefficient is <!-- l. 1017 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>m</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>.
   </p><!-- l. 1019 --><p class='noindent'><!-- l. 1019 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1021 --><p class='noindent'>Each step of the actual blind rotation above is computed as the following TFHE ciphertext-to-ciphertext
   multiplication:
   </p><!-- l. 1023 --><p class='noindent'><!-- l. 1023 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msubsup><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖦𝖲𝖶</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>s</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub></mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1025 --><p class='noindent'><!-- l. 1025 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1027 --><p class='noindent'>We will leave this computation for the reader’s exercise.
   </p><!-- l. 1029 --><p class='noindent'><!-- l. 1029 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Coefficient Extraction: </span>At the end of blind rotation, we finally get the following GLWE
   ciphertext:
   <!-- l. 1033 --><p class='noindent'><!-- l. 1033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>V</mi> </mrow><mrow><mn>8</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 1035 --><p class='noindent'><!-- l. 1035 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>4</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>5</mn></mrow></msub><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>6</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>7</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>8</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>9</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>10</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>11</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>12</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>13</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>14</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>15</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>0</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>1</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><msub><mrow><mi>v</mi></mrow><mrow><mn>3</mn></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1037 --><p class='noindent'><!-- l. 1037 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><mi>X</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>2</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>8</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>9</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>10</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>11</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>12</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>13</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>14</mn></mrow></msup><mo class='MathClass-bin' stretchy='false'>−</mo><mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>15</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
   </p><!-- l. 1039 --><p class='noindent'><!-- l. 1039 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>A</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>A</mi></mrow><mrow><mi>k</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mo> ∑</mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>15</mn></mrow></munderover><msub><mrow><mi>b</mi></mrow><mrow><mi>j</mi></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1041 --><p class='noindent'>Now, we extract the constant term’s coefficient of the encrypted polynomial
   <!-- l. 1041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖦𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>S</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using the
   coefficient extraction formula (Summary <a href='CoefficientExtraction.html#coefficient-extraction'>D-1.7<!-- tex4ht:ref: subsec:tfhe-extraction  --></a>). Specifically, we will extract the constant term’s coefficient, which
   corresponds to <!-- l. 1041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   We extract <!-- l. 1041 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
   by computing the following:
   </p><!-- l. 1043 --><p class='noindent'><!-- l. 1043 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msubsup><mrow><mi>a</mi></mrow><mrow><mi>k</mi></mrow><mrow><mi>′</mi></mrow></msubsup><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mi>h</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p>
   <table class='equation-star'><tr><td>
   <!-- l. 1045 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
<mstyle class='text'><mtext>, where </mtext></mstyle><msubsup><mrow><mi>a</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>j</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow class='cases'> <mrow><mo fence='true' form='prefix'>{</mo><mrow> <mtable align='axis' class='array' columnlines='none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mn>0</mn><mstyle class='text'><mtext>)</mtext></mstyle>              <mspace class='quad' width='1em'></mspace></mtd>
</mtr>  <mtr class='array-row'><mtd class='array-td' columnalign='left'><msub><mrow><mi>a</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>n</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mn>0</mn><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msub><mstyle class='text'><mtext> (if </mtext></mstyle><mn>0</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext>)</mtext></mstyle><mspace class='quad' width='1em'></mspace></mtd></mtr>  <!-- @{}l@{\quad }l@{} --></mtable>                                                                                       </mrow><mo fence='true' form='postfix'></mo></mrow></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>b</mi></mrow><mrow><mn>0</mn></mrow></msub><mstyle class='text'><mtext> is obtained from the polynomial </mtext></mstyle><mi>B</mi>
</mrow></math></td></tr></table>
   </dd></dl>
   
   <h5 class='subsubsectionHead' id='discussion6'><span class='titlemark'>D-1.8.8   </span> <a id='x109-136000D-1.8.8'></a>Discussion</h5>
   <ul class='itemize1'>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Programmable  Bootstrapping</span>:  While  the  bootstrapping  (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:tfhe-summary  --></a>)  uses  a  simple  Lookup
   Table <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   which maps <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   to <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi></mrow></math>,
   we can edit the coefficients of <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   to make <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>
   map to different values. For example, an altered mappings between the inputs and outputs to
   LUT can implement logic gates such as AND, OR, XOR, CMUX, etc, which will be explained in
   <a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:tfhe-summary  --></a>. Such edited mappings between the exponents and coefficients in <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   are called programmable bootstrapping. If we encrypt <!-- l. 1062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a GLWE ciphertext, we can hide the mappings as well as each input instance, which effectively
   implements <span class='rm-lmri-10x-x-109'>functional encryption</span>. Note that both the vanilla bootstrapping (<a href='#noise-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8<!-- tex4ht:ref: subsec:tfhe-summary  --></a>) and programmable
   bootstrapping (<a href='#application-gate-bootstrapping'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.9<!-- tex4ht:ref: subsec:tfhe-summary  --></a>) generate the same amount of noise.
   </li>
   <li class='itemize'><span class='rm-lmbx-10x-x-109'>Bootstrapping Noise</span>: During the bootstrapping’s LUT polynomial <!-- l. 1063 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   rotation, we perform many TFHE multiplications in the homomorphic MUX gates to derive
   <!-- l. 1063 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>V</mi> </mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>V</mi> </mrow><mrow><mi>k</mi></mrow></msub></mrow></math>,
   which inevitably creates additional noises before the the noise gets re-initialized at the end.
   However, a careful parameter choice can limit the growth of this additional noise during modulus
   switch and blind rotation.</li></ul>
                                                                                         
                                                                                         
   
   <h5 class='subsubsectionHead' id='application-gate-bootstrapping'><span class='titlemark'>D-1.8.9   </span> <a id='x109-137000D-1.8.9'></a>Application: Gate Bootstrapping</h5>
<!-- l. 1070 --><p class='noindent'>Besides implementing the homomorphic MUX logic gate used during blind rotation (<a href='#blind-rotation'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.4<!-- tex4ht:ref: subsec:tfhe-summary  --></a>), it is possible to leverage
the LUT polynomial <!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to implement other homomorphic logic gates such as AND, NAND, OR, XOR, etc. When implementing
these gates, each ciphertext is an encryption of a single-bit plaintext (or several bits can be bundled up
in a linear combination formula and be processed simultaneously by using LUT). Suppose
<!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>32</mn></mrow></math>,
<!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>8</mn></mrow></math>,
<!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>m</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mn>8</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>4</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>,
<!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>4</mn></mrow></math>,
<!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>2</mn><mi>n</mi>
  </mrow><mrow><mi>q</mi>   </mrow></mfrac></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn></mrow></math>, and we encode the gate
input into LWE plaintext as <!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>,
and <!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>1</mn> <mo class='MathClass-rel' stretchy='false'>→</mo><mn>1</mn></mrow></math>, and the maximum
(accumulated) noise <!-- l. 1070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>e</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>[</mo><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
</p>
   <div class='table'>
                                                                                         
                                                                                         
<!-- l. 1073 --><p class='indent'>   </p><figure class='float' id='x109-137001r5'><span id='an-example-truth-table-for-an-and-operation-with-an-additional-encoding'></span>
                                                                                         
                                                                                         
<!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-39' rules='groups'><colgroup id='TBL-39-1g'><col id='TBL-39-1' /><col id='TBL-39-2' /></colgroup><colgroup id='TBL-39-3g'><col id='TBL-39-3' /><col id='TBL-39-4' /></colgroup><colgroup id='TBL-39-5g'><col id='TBL-39-5' /></colgroup><colgroup id='TBL-39-6g'><col id='TBL-39-6' /></colgroup><colgroup id='TBL-39-7g'><col id='TBL-39-7' /></colgroup><colgroup id='TBL-39-8g'><col id='TBL-39-8' /></colgroup><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-39-1-'><td class='td11' colspan='7' id='TBL-39-1-1' style='text-align:center; white-space:nowrap;'></td>                                                                                                                                                                                                                                                                                                            <div class='multicolumn' style='text-align:center; white-space:nowrap;'>Lookup Table Polynomial <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>4</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>5</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>6</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>7</mn></mrow></msup></mrow></math></div>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-39-2-'><td class='td11' colspan='2' id='TBL-39-2-1' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Decoded</span></div>                                                                                                              </td><td class='td11' colspan='2' id='TBL-39-2-3' style='text-align:center; white-space:nowrap;'>                                                                                 <div class='multicolumn' style='text-align:center; white-space:nowrap;'><span class='rm-lmbx-10x-x-109'>Encoded</span></div>                                                                                                               </td><td class='td11' id='TBL-39-2-5' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-39' rules='groups'><tr id='TBL-39-1-'><td class='td11' id='TBL-39-1-1' style='text-align:center; white-space:nowrap;'>    <span class='rm-lmbx-10x-x-109'>Linear     </span></td></tr><tr id='TBL-39-2-'><td class='td11' id='TBL-39-2-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>combination</span></td>
</tr><tr id='TBL-39-3-'><td class='td11' id='TBL-39-3-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>of encodings </span></td></tr></table>                                                                                          </div></div> </td><td class='td11' id='TBL-39-2-6' style='text-align:center; white-space:nowrap;'> <div class='multicolumn' style='text-align:center; white-space:nowrap;'><!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-39' rules='groups'><tr id='TBL-39-1-'><td class='td11' id='TBL-39-1-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>Scaled Encoded </span></td></tr><tr id='TBL-39-2-'><td class='td11' id='TBL-39-2-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>Combination</span></td></tr></table>                                                                                     </div></div> </td><td class='td11' id='TBL-39-2-7' style='text-align:center; white-space:nowrap;'>                                             <span class='rm-lmbx-10x-x-109'>Bootstrapping                                                              </span></td><td class='td11' id='TBL-39-2-8' style='text-align:center; white-space:nowrap;'> <!-- tex4ht:inline --><div class='tabular'> <table class='tabular' id='TBL-40'><colgroup id='TBL-40-1g'><col id='TBL-40-1' /></colgroup><tr id='TBL-40-1-'><td class='td11' id='TBL-40-1-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>Decoded </span></td></tr><tr id='TBL-40-2-'><td class='td11' id='TBL-40-2-1' style='text-align:center; white-space:nowrap;'> <span class='rm-lmbx-10x-x-109'>result</span></td>
</tr></table>                                                                     </div> </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-39-3-'><td class='td11' id='TBL-39-3-1' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-39-3-2' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-39-3-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub></math>  </td><td class='td11' id='TBL-39-3-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub></math>  </td><td class='td11' id='TBL-39-3-5' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-3-6' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>  </td><td class='td11' id='TBL-39-3-7' style='text-align:center; white-space:nowrap;'>           <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>X</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-bin' stretchy='false'>+</mo><mi>e</mi></mrow></msup></mrow></math>                   </td><td class='td11' id='TBL-39-3-8' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∧</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>2</mn></mrow></msub></mrow></math>  </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr id='TBL-39-4-'><td class='td11' id='TBL-39-4-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-39-4-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-39-4-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-4-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-4-5' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></math>  </td><td class='td11' id='TBL-39-4-6' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>6</mn></mrow></math>  </td><td class='td11' id='TBL-39-4-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-4-8' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td>
</tr><tr id='TBL-39-5-'><td class='td11' id='TBL-39-5-1' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-39-5-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-39-5-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-5-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-5-5' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-5-6' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>  </td><td class='td11' id='TBL-39-5-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-5-8' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td>
</tr><tr id='TBL-39-6-'><td class='td11' id='TBL-39-6-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-39-6-2' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td><td class='td11' id='TBL-39-6-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-6-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-6-5' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-6-6' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>  </td><td class='td11' id='TBL-39-6-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>  </td><td class='td11' id='TBL-39-6-8' style='text-align:center; white-space:nowrap;'>                                         0                                                                 </td>
</tr><tr id='TBL-39-7-'><td class='td11' id='TBL-39-7-1' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-39-7-2' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td><td class='td11' id='TBL-39-7-3' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-7-4' style='text-align:right; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-7-5' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-7-6' style='text-align:center; white-space:nowrap;'> <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>2</mn></math>  </td><td class='td11' id='TBL-39-7-7' style='text-align:center; white-space:nowrap;'> constant term’s coeff. is <!-- l. 1124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>  </td><td class='td11' id='TBL-39-7-8' style='text-align:center; white-space:nowrap;'>                                         1                                                                 </td>
</tr><tr class='hline'><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>

<figcaption class='caption'><span class='id'>Table 5: </span><span class='content'>An example truth table for an AND operation with an additional encoding.            </span></figcaption><!-- tex4ht:label?: x109-137001r5  -->
                                                                                         
                                                                                         
   </figure>
   </div>
<!-- l. 1138 --><p class='indent'>   <a href='#an-example-truth-table-for-an-and-operation-with-an-additional-encoding'>Table 5<!-- tex4ht:ref: subsec:tfhe-summary  --></a> is a programmable bootstrapping design for an AND logic gate. For this application, we define the LUT
polynomial <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math> as
<!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mn>7</mn></mrow></munderover> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>i</mi></mrow></msup></mrow></math>. The LUT polynomial
<!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> maps one half of the plaintext
domain to <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>, while the other
half to <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> (as the terms wrap
around the boundary of <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>7</mn></mrow></math>).
In this design setup, each bit is separately encrypted as independent TFHE ciphertext. Gate inputs 0 and 1 are
encoded as <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
and <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>,
respectively. The linear combination (i.e., homomorphic computation formula) for an AND gate is
<!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi><msub><mrow><mi>m</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. Its output is positive if both
inputs are positive (i.e. <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>, in which
case the blind rotation will rotate <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> </mrow></math>
to the left by <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi mathvariant='normal'>Δ</mi></mrow><mo accent='true' stretchy='false'>^</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math> positions and the
constant term’s coefficient will be <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>.
Thus, the output of blind rotation and coefficient extraction will be
<!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> with a reduced noise, which is an
encoding of <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>1</mn></math>. This design can tolerate
the maximum noise of <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><mi>e</mi><mo class='MathClass-rel' stretchy='false'>|</mo><mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>. To endure
bigger noises, we should increase <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
and <!-- l. 1138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
</p><!-- l. 1140 --><p class='indent'>   Note that the AND gate’s LUT layout is negacyclic, which is a special case, thus we could use the entire
<!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mi>n</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>16</mn></mrow></math> coefficient
states in <!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
for the AND gate mapping function’s outputs, by leveraging
<!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>’s innate
property of negacyclic rotation. However, in many use cases, the LUT layout is not necessarily negacyclic
like this AND gate example. Even our noise bootstrapping’s LUT layout (<a href='#overview3'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.1<!-- tex4ht:ref: subsec:tfhe-summary  --></a>) was not negacyclic,
but a unity function (as it simply removes the noise). Thus, for most use cases, we need to use only
<!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>t</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> out of
<!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math> plaintext space to
avoid more than <!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
rotations of <!-- l. 1140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>V</mi> <mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(<a href='#halving-the-plaintext-space-to-be-used'><span class='ts1-lmr10-x-x-109'>§</span>D-1.8.3<!-- tex4ht:ref: subsec:tfhe-summary  --></a>).
</p><!-- l. 1142 --><p class='indent'>   Besides the AND gate, other logic gates can be built in a similar manner, each of which is based on a
different linear combination formula and LUT layout.
</p><!-- l. 1144 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Division: </span>TFHE does not support direct division of plaintext numbers
of any size. This is because TFHE’s LWE vector elements are in the
<!-- l. 1144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>Z</mi></mrow><mrow><mi>q</mi></mrow></msub></math> ring, where each element
<!-- l. 1144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>g</mi></math> does not necessarily have a
multiplicative inverse <!-- l. 1144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>, which
makes it hard to multiply <!-- l. 1144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>g</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>
                                                                                         
                                                                                         
to the target number to divide. Instead, division can be implemented as binary division based on the gates
implemented by gate bootstrapping. To support binary division, each plaintext has to be a single bit and
encrypted as an independent ciphertext. Or multiple bits can be bundled up and processed concurrently
by designing a linear combination formula, similar to the linear combination that we designed for
processing 2 input bits of an AND gate.
   
</p>
   <h5 class='subsubsectionHead' id='application-neural-networks-bootstrapping'><span class='titlemark'>D-1.8.10   </span> <a id='x109-138000D-1.8.10'></a>Application: Neural Networks Bootstrapping</h5>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1151 --><p class='noindent' id='an-illustration-of-neural-networks-'> <img alt='PIC' src='figures/neural-network-.png' /> <a id='x109-138001r14'></a></p>
<figcaption class='caption'><span class='id'>Figure 14: </span><span class='content'>An illustration of neural networks                                                </span></figcaption><!-- tex4ht:label?: x109-138001r14  -->
                                                                                         
                                                                                         
   </figure>
   <figure class='figure'> 

                                                                                         
                                                                                         
                                                                                         
                                                                                         
<!-- l. 1158 --><p class='noindent' id='an-illustration-of-neural-networkss-programmable-bootstrapping'> <img alt='PIC' src='figures/nn-homomorphic-.png' /> <a id='x109-138002r15'></a></p>
<figcaption class='caption'><span class='id'>Figure 15: </span><span class='content'>An illustration of neural networks’s programmable bootstrapping                    </span></figcaption><!-- tex4ht:label?: x109-138002r15  -->
                                                                                         
                                                                                         
   </figure>
<!-- l. 1163 --><p class='indent'>   Homomorphic encryption can be applied to the neurons of deep neural networks, in which each neuron
is generally comprised of two steps of computation:
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Linear Combination of Input Values: </span>An input feature value (or intermediate value) set
   <!-- l. 1166 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>x</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   a weight set <!-- l. 1166 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mstyle class='text'><mtext></mtext><mstyle class='math'><mo class='MathClass-rel' stretchy='false'>⋯</mo><mi>x</mi></mstyle><mtext></mtext></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>w</mi></mrow><mrow><mi>n</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   and a bias <!-- l. 1166 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>b</mi></math>
   are computed as: <!-- l. 1166 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>.
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Activation Function: </span><!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>y</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is computed, where <!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>f</mi></math>
   is a non-linear activation function such as the <!-- l. 1167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi class='loglike'>sin</mi><mo>⁡<!-- FUNCTION APPLICATION --></mo><!-- nolimits --></mrow></math>
   function, ReLU, sigmoid, hyperbolic tangent, etc.</dd></dl>
<!-- l. 1170 --><p class='indent'>   TFHE can homomorphically compute the 1st step’s linear combination formula:
<!-- l. 1170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math> as
<!-- l. 1170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>i</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><mi>n</mi></mrow></munderover><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mover accent='true'><mrow><mi>s</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>a</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>w</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>b</mi></mrow></math>, which
can be implemented as ciphertext addition (<a href='GLWECiphertexttoCiphertextAddition.html#glwe-ciphertexttociphertext-addition'><span class='ts1-lmr10-x-x-109'>§</span>C-1<!-- tex4ht:ref: subsec:tfhe-summary  --></a>) and ciphertext-to-plaintext multiplication
(<a href='GLWECiphertexttoPlaintextMultiplication.html#glwe-ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>C-3<!-- tex4ht:ref: subsec:tfhe-summary  --></a>).
</p><!-- l. 1172 --><p class='indent'>   However, the 2nd step’s non-linear functions cannot be expressed as addition and multiplication of
ciphertexts. To address this issue, the activation function can be evaluated as a programmable
bootstrapping, such that the output of the bootstrapping matches or (or is similar) to the output of the
activation function. If we use bootstrapping at the 2nd step, noises can be refreshed at the end of every
neuron, thus we can potentially handle neural networks of any depth without worrying about the noise
growth.
                                                                                         
                                                                                         
</p>
   <!-- l. 1176 --><div class='crosslinks'><p class='noindent'>[<a href='CoefficientExtraction.html'>prev</a>][<a href='TFHEScheme.html#NoiseBootstrapping.html'>parent</a>][<a href='TFHEonaDiscreteTorus.html'>next</a>]</p></div>
    
</body> 
</html>