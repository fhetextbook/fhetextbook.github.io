<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Noise Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 1816 --><div class='crosslinks'><p class='noindent'>[<a href='ApplicationMatrixMultiplication.html'>prev</a>][<a href='BFVScheme.html#NoiseBootstrapping1.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='noise-bootstrapping1'><span class='titlemark'>D-2.11   </span> <a id='x122-166000D-2.11'></a>Noise Bootstrapping</h4>
<!-- l. 1819 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 1: </span><a href='https://eprint.iacr.org/2022/1363.pdf'>Bootstrapping for BGV and BFV Revisited</a> <span class='cite'>[<a href='refname.html#Xcryptoeprint_2022_1363'>14</a>]</span>
</p><!-- l. 1823 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 2: </span><a href='https://eprint.iacr.org/2014/873.pdf'>Bootstrapping for HELib</a> <span class='cite'>[<a href='refname.html#X10.1007_s00145-020-09368-7'>15</a>]</span>
</p><!-- l. 1826 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 3: </span><a href='https://arxiv.org/pdf/1906.02867'>A Note on Lower Digits Extraction Polynomial for Bootstrapping</a> <span class='cite'>[<a href='refname.html#Xhuo2019notelowerdigitsextraction'>16</a>]</span>
</p><!-- l. 1829 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 4: </span><a href='https://eprint.iacr.org/2024/1587.pdf'>Fully Homomorphic Encryption for Cyclotomic Prime Moduli</a> <span class='cite'>[<a href='refname.html#Xcryptoeprint_2024_1587'>17</a>]</span>
</p><!-- l. 1838 --><p class='indent'>   <!-- l. 1838 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1840 --><p class='indent'>   In BFV, continuous ciphertext-to-ciphertext multiplication increases the noise in a multiplicative
manner, and once the noise overflows the message bits, then the message gets corrupted. Bootstrapping is
a process of resetting the grown noise.
   
</p>
   <h5 class='subsubsectionHead' id='highlevel-idea1'><span class='titlemark'>D-2.11.1   </span> <a id='x122-167000D-2.11.1'></a>High-level Idea</h5>
<!-- l. 1845 --><p class='noindent'>In this subsection, we will assume the plaintext modulus
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math>, a prime number.
Although <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math> can
be generalized as <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>
where <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕀</mi></mrow></math>
and <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>
(Summary D-2.3 in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>§</span>D-2.3<!-- tex4ht:ref: subsec:bfv-enc-dec  --></a>), we will explain BFV’s bootstrapping assuming
<!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> for simplicity, and
then generalize <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
as <!-- l. 1845 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math> in
the end.
</p><!-- l. 1847 --><p class='indent'>   The core idea of the BFV bootstrapping is to homomorphically evaluate a special polynomial
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, a digit extraction polynomial
modulo <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> (for some positive
integer <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜀</mi></math>), where the input to
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is a noisy plaintext value
modulo <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> and the output is a
noise-free plaintext value modulo <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>,
where the noise located at the least significant digits in a
base-<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> (prime) representation gets
zeroed out. For example, <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>6</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>6</mn><mi>p</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. Given the
noise resides in the least significant <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
digits in base-<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
representation, we can homomorphically recursively evaluate
                                                                                         
                                                                                         
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> total
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> times in a row, which zeros
out the least significant (base-<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digits of
input <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>.
To homomorphically evaluate the noisy plaintext through
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>, we need to first switch the
plaintext modulus from <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
to <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>, where
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>≫</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>&gt;</mo> <mi>p</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi></mrow></math>. The larger
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜀</mi></math> is, the
more likely that the noise gets successfully zeroed out, but instead the computation overhead becomes larger.
If <!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜀</mi></math> is
small, the computation gets faster, but the digit-wise distance between the noise and the plaintext
gets smaller, potentially corrupting the plaintext during bootstrapping, because removing the
most significant noise digit may remove the least significant plaintext digit as well. Therefore,
<!-- l. 1847 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜀</mi></math> should
be chosen carefully.
</p><!-- l. 1849 --><p class='indent'>   <!-- l. 1849 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1851 --><p class='indent'>   The technical details of the BFV bootstrapping procedure are as follows. Suppose we have an RLWE
ciphertext <!-- l. 1851 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
where <!-- l. 1851 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>,
 <!-- l. 1851 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math> and
<!-- l. 1851 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> (i.e.,
the plaintext modulus is a prime).
</p><!-- l. 1854 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Modulus Switch (</span><!-- l. 1854 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   Scale down the ciphertext modulus from <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   to <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
   where <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≪</mo><mi>q</mi></mrow></math>.
   The purpose of this modulus switch is to change the plaintext modulus to <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>,
   which is required to use the digit extraction polynomial <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (because we need to represent the input to <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a base-<!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   number in order to interpret it as a <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
   value). Notice that <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>,
   where <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≈</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi></mrow></math>
   <span style='color:#FF0000;'> # the modulus switch error of <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>E</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   plus the modulus switch error of the plaintext’s scaling factor <!-- l. 1854 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math></span>
   <!-- l. 1856 --><p class='noindent'><!-- l. 1856 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption: </span>Suppose we have the <span class='rm-lmri-10x-x-109'>bootstrapping key </span><!-- l. 1858 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖾𝗏</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow><mrow><mi>β</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>l</mi></mrow></msubsup><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
                                                                                         
                                                                                         
   which is the secret key <!-- l. 1858 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   encrypted by <!-- l. 1858 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   (itself) modulo <!-- l. 1858 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   Using this <span class='rm-lmri-10x-x-109'>encrypted </span>secret key, we <span class='rm-lmri-10x-x-109'>homomorphically </span>decrypt <!-- l. 1858 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   <!-- l. 1860 --><p class='noindent'><!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   <span style='color:#FF0000;'># where <!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is a modulo-<!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   ciphertext that encrypts a modulo-<!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   plaintext <!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   whose scaling factor <!-- l. 1860 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   </span>
   </p><!-- l. 1862 --><p class='noindent'><!-- l. 1862 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1864 --><p class='noindent'><!-- l. 1864 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1866 --><p class='noindent'><!-- l. 1866 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1868 --><p class='noindent'><!-- l. 1868 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> # <!-- l. 1868 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math>
   is some integer polynomials to represent the coefficient values that wrap around <!-- l. 1868 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math></span>
   </p><!-- l. 1876 --><p class='noindent'><!-- l. 1876 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1878 --><p class='noindent'>Let’s see how we derived the above relation. Suppose we compute <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
   whose output will be <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>.
   Now, instead of using the plaintext secret key <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>,
   we use an encrypted secret key <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   is a plaintext modulo <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>,
   its scaling factor <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math>,
   and the ciphertext encrypting <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   is in modulo <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   Then, the result of homomorphically computing <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></math>
   will be an encryption of <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
   where <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
   stands for the wrapping-around coefficient values of the multiples of <!-- l. 1878 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>.
   </p><!-- l. 1880 --><p class='noindent'>Notice that we did not reduce <!-- l. 1880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
   by modulo <!-- l. 1880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   during homomorphic decryption (without modulo-<!-- l. 1880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   reduction), because such a homomorphic modulo reduction is not directly doable. Instead, we will
   handle <!-- l. 1880 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
   in the later digit extraction step.
   </p><!-- l. 1883 --><p class='noindent'>For simplicity, we will denote <!-- l. 1883 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
   </p><!-- l. 1885 --><p class='noindent'><!-- l. 1885 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span><span class='rm-lmbx-10x-x-109'>: </span>Move the (encrypted) polynomial <!-- l. 1887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>’s
   coefficients <!-- l. 1887 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
   to the input vector slots of an RLWE ciphertext. This is done by computing:
   <!-- l. 1889 --><p class='noindent'><!-- l. 1889 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 1891 --><p class='noindent'>, where <!-- l. 1891 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
   is the batch encoding matrix that converts input vector slot values into polynomial coefficients
   (Summary D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>).
   </p><!-- l. 1893 --><p class='noindent'><!-- l. 1893 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Digit Extraction: </span>We design a polynomial <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (a digit extraction polynomial) zeros out the least significant base-<!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit(s) by recursively evaluating the polynomial. Using each <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   (i.e., the <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
   coefficient of <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>)
   as an input, we recursively evaluate <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   total <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   times consecutively, which effectively zeros out the least significant <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   digits of the base-<!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation of <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   (i.e., noise value), and keeps only the most significant base-<!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit of <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
   (i.e., plaintext value). Throughout the digit extraction, the value stored at the input vector slots
   of the ciphertext gets updated from <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
   to <!-- l. 1895 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
   <!-- l. 1898 --><p class='noindent'><!-- l. 1898 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span><span class='rm-lmbx-10x-x-109'>: </span>Homomorphically move each input vector slot’s value back to the (encrypted)
   polynomial  coefficient  position.  This  is  done  by  homomorphically  multiplying  the  decoding
   matrix <!-- l. 1901 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
   to the ciphertext (Summary D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>).
   <!-- l. 1904 --><p class='noindent'><!-- l. 1904 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation: </span>At this point, we have the ciphertext <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   where the plaintext modulus is <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   and the plaintext scaling factor <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>.
   Without doing any actual additional computation, we can view this ciphertext as <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace><mi>q</mi></mrow></math>,
   which is an encryption of plaintext modulus <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   whose scaling factor <!-- l. 1907 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>.
   This is because:
   <!-- l. 1909 --><p class='noindent'><!-- l. 1909 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>(</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mstyle><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mstyle mathsize='1.61em'><mrow><mo fence='true' form='prefix'>)</mo><mrow></mrow><mo fence='true' form='postfix'></mo></mrow></mstyle></mstyle></mrow></math>
   </p><!-- l. 1911 --><p class='noindent'><!-- l. 1911 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>q</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1913 --><p class='noindent'><!-- l. 1913 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> </mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1916 --><p class='noindent'>In other words, we can view the ciphertext <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   whose plaintext modulus is <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
   and scaling factor <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
                                                                                         
                                                                                         
   as another ciphertext <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   whose plaintext modulus is <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   and scaling factor <!-- l. 1916 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>.
</p>
   </dd></dl>
<!-- l. 1923 --><p class='indent'>   <!-- l. 1923 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1925 --><p class='indent'>   Notice that the final ciphertext <!-- l. 1925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>’s
scaling factor stays the same as before the bootstrapping, while the original noises
<!-- l. 1925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math> and
<!-- l. 1925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math> have
been eliminated. On the other hand, the homomorphic operation of <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit extraction, and
<span class='rm-lmss-10x-x-109'>SlotToCoeff </span>must have accumulated additional noises, but their size is fixed and smaller than
<!-- l. 1925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math> and
<!-- l. 1925 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math>.
</p><!-- l. 1927 --><p class='indent'>   Next, we will explain each step more in detail.
   
</p>
   <h5 class='subsubsectionHead' id='modulus-switch'><span class='titlemark'>D-2.11.2   </span> <a id='x122-168000D-2.11.2'></a>Modulus Switch</h5>
<!-- l. 1932 --><p class='noindent'>The first step of the BFV bootstrapping is to do a modulus switch from
<!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> to some prime
power modulus <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
where <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≪</mo><mi>q</mi></mrow></math>.
Before the bootstrapping, suppose the encrypted plaintext with noise is
<!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>. Then, after the modulus
switch from <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>, the plaintext
would scale down to <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
where <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math> roughly
contains <!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle><mi>E</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></math>
plus the modulus switching noise of the plaintext’s scaling factor
<!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>→</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>.
The goal of the BFV bootstrapping is to zero out this noise
<!-- l. 1932 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math>.
   
</p>
   <h5 class='subsubsectionHead' id='homomorphic-decryption'><span class='titlemark'>D-2.11.3   </span> <a id='x122-169000D-2.11.3'></a>Homomorphic Decryption</h5>
<!-- l. 1937 --><p class='noindent'>Let’s denote the modulus-switched noisy plaintext as
<!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. We further denote
polynomial <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>’s each
degree term’s coefficient <!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
as base-<!-- l. 1937 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
                                                                                         
                                                                                         
number as follows:
</p><!-- l. 1939 --><p class='indent'>   <!-- l. 1939 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 1941 --><p class='indent'>   <!-- l. 1941 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1943 --><p class='indent'>   Then, <!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> is a
base-<!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> number
comprising <!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>𝜀</mi></math>
digits: <!-- l. 1943 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 1946 --><p class='indent'>   We assume that the highest base-<!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index for the noise is <!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></math>,
which is equivalent to the noise budget, and the pure plaintext portion solely resides at the
base-<!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index
<!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> (i.e., the most
significant base-<!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit in modulo <!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>).
Given this assumption, we extract the noise-free plaintext by computing the following:
</p><!-- l. 1948 --><p class='indent'>   <!-- l. 1948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math> <span style='color:#FF0000;'> # where the noise is
assumed to be smaller than <!-- l. 1948 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
   </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></math></span>
</p><!-- l. 1950 --><p class='indent'>   The above formula is equivalent to shifting the
base-<!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
number <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
by <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digits to
the right (and rounding the decimal value). However, remember that we don’t have direct access to polynomial
<!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> unless we have
the secret key <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
to decrypt the ciphertext storing the plaintext. Instead, we can only derive
<!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math> as an
encrypted form. Specifically, we can <span class='rm-lmri-10x-x-109'>homomorphically </span>decrypt the modulus-switched ciphertext
<!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using the <span class='rm-lmri-10x-x-109'>encrypted </span>secret
key <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as a <span class='rm-lmri-10x-x-109'>bootstrapping key</span>. For
this ciphertext <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the plaintext
modulus is <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>, the plaintext scaling
factor is <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>, and the ciphertext
modulus is <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>. With this encrypted
secret key <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, we homomorphically
decrypt the encrypted <!-- l. 1950 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
as follows:
</p><!-- l. 1953 --><p class='indent'>   <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 1955 --><p class='indent'>   <!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1957 --><p class='indent'>   <!-- l. 1957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 1960 --><p class='indent'>   <!-- l. 1960 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 1962 --><p class='indent'>   <!-- l. 1962 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 1964 --><p class='indent'>   <!-- l. 1964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span style='color:#FF0000;'> #
<!-- l. 1964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math> is
                                                                                         
                                                                                         
some integer polynomials to represent the coefficient values that wrap around modulo
<!-- l. 1964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> as multiples
of <!-- l. 1964 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math></span>
</p><!-- l. 1966 --><p class='indent'>   <!-- l. 1966 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1968 --><p class='indent'>   <!-- l. 1968 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 1970 --><p class='indent'>   <!-- l. 1970 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1972 --><p class='indent'>   During this homomorphic decryption, we did not reduce the plaintext result by modulo
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>, because
the homomorphic decryption is a ciphertext-to-plaintext multiplication and addition done in the ciphertext
modulus <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
(not <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>) by
using <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup></math> and
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup></math> as plaintexts (with the
plaintext modulus <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>e</mi></mrow></msup></math>) and
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as a ciphertext (with the
ciphertext modulus <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>). This
is why the wrapping term <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
is preserved in the plaintext after the homomorphic decryption– we will handle
this term at the later stage of bootstrapping. Also, notice that the computation of
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> would not generate much
noise. This is because <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
is a plaintext modulo <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>,
and thus the new noise generated by ciphertext-to-plaintext multiplication is
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> (where
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is the encryption
noise of <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>). Since the
ciphertext modulus <!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>≫</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
<!-- l. 1972 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>≫</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>.
</p><!-- l. 1974 --><p class='indent'>   Once we have derived <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>, our next
step is to remove the noise in the lower <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
digits (in terms of base-<!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
representation) of each <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
for <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>. This is equivalent
to transforming noisy <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
into noise-free <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math> where
<!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>. BFV’s solution to do
this is to design a <!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>-degree
polynomial function which computes the same logical result as
<!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>.
We will later explain how to design this polynomial by using the digit extraction polynomial
<!-- l. 1974 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(<a href='#digit-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.5<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>).
</p><!-- l. 1988 --><p class='indent'>   However, in order to <span class='rm-lmri-10x-x-109'>homomorphically </span>evaluate this polynomial at each coefficient
<!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> given the ciphertext
                                                                                         
                                                                                         
<!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, we need to move
polynomial <!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>’s
each coefficient <!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
to the input vector slots of an RLWE ciphertext. This is because BFV supports homomorphic batched
<!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,⋅)</mtext></mrow></math> operations
based on input vector slots of ciphertexts as operands. Therefore, we need to evaluate the noise-removing
polynomial <!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
based on the values stored in the input vector slots of a ciphertext.
</p><!-- l. 1990 --><p class='indent'>   In the next sub-section, we will explain the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>procedure, a process of moving polynomial
coefficients into input vector slots of a ciphertext <span class='rm-lmri-10x-x-109'>homomorphically</span>.
   
</p>
   <h5 class='subsubsectionHead' id='coefftoslot-and-slottocoeff'><span class='titlemark'>D-2.11.4   </span> <a id='x122-170000D-2.11.4'></a><span class='rm-lmss-10x-x-109'>CoeffToSlot </span>and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span></h5>
<!-- l. 1995 --><p class='noindent'>The goal of the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step is to homomorphically move polynomial
<!-- l. 1995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>’s
coefficients <!-- l. 1995 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
to input vector slots.
</p><!-- l. 1998 --><p class='indent'>   In Summary D-2.9.3 (in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>), we learned that the encoding formula for converting a vector of input slots
<!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math> into a vector of
polynomial coefficients <!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></math>
is: <!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>→</mo></mover></mrow></math>, where
<!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> is a basis of the
<!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
vector space crafted as follows:
</p><!-- l. 2000 --><p class='indent'>   <!-- l. 2000 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>       </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>    <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2008 --><p class='indent'>   <!-- l. 2008 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2010 --><p class='indent'>   <span style='color:#FF0000;'> # where the rotation helper function <!-- l. 2010 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
</p><!-- l. 2012 --><p class='indent'>   <!-- l. 2012 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2014 --><p class='indent'>   Therefore, given the input ciphertext <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖼𝗍</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
we can understand its input vector slots as storing some values such that multiplying
<!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> to each of them turns them
into a coefficient <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> of polynomial
<!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>. This implies that if we
<span class='rm-lmri-10x-x-109'>homomorphically </span>multiply <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> to
the input vector slots of <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>, then the
resulting ciphertext’s <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
input vector slots will contain the <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
coefficients of <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>, which is equivalent
to moving the coefficients of <!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
to the input vector slots. Therefore, the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step is equivalent to homomorphically computing
<!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>. We
                                                                                         
                                                                                         
can homomorphically compute matrix-vector multiplication by using the technique explained in
<a href='ApplicationMatrixMultiplication.html#application-matrix-multiplication'><span class='ts1-lmr10-x-x-109'>§</span>D-2.10<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>.
</p><!-- l. 2016 --><p class='indent'>   After the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step, we can homomorphically eliminate the noise in the lower
<!-- l. 2016 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
base-<!-- l. 2016 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digits
of each <!-- l. 2016 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
by homomorphically evaluating the noise-removing polynomial (to be explained in the next
subsection).
</p><!-- l. 2018 --><p class='indent'>   After we get noise-free coefficients of <!-- l. 2018 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>,
we need to move them back from the input vector slots to their original coefficient
positions. This step is called <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>, which is an exact inverse procedure of
<span class='rm-lmss-10x-x-109'>CoeffToSlot</span>. We also learned in Summary D-2.9.3 (in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>) that the inverse matrix of
<!-- l. 2018 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> is
<!-- l. 2018 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>,
where:
</p><!-- l. 2020 --><p class='indent'>   <!-- l. 2020 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>⋮</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>⋮</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>⋮</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>⋱</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>⋮</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>⋯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2033 --><p class='indent'>   Therefore, the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step is equivalent to homomorphically multiplying
<!-- l. 2033 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math> to the
output of the noise-eliminating polynomial evaluation.
</p><!-- l. 2035 --><p class='indent'>   In the next subsection, we will learn how to design the core algorithm of
BFV, the noise elimination polynomial, based on the digit extraction polynomial
<!-- l. 2035 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   
</p>
   <h5 class='subsubsectionHead' id='digit-extraction'><span class='titlemark'>D-2.11.5   </span> <a id='x122-171000D-2.11.5'></a>Digit Extraction</h5>
<!-- l. 2042 --><p class='noindent'>Remember we defined polynomial <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
as the scaled noisy plaintext: <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
and each <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is
the <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
coefficient of <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
(where <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>).
The goal of the digit extraction step is to homomorphically zero out the lower
(base-<!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digits
of each <!-- l. 2042 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
where the noise resides.
                                                                                         
                                                                                         
</p><!-- l. 2044 --><p class='indent'>   First, we always think of <!-- l. 2044 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
as a base-<!-- l. 2044 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> number
(since this is a modulo-<!-- l. 2044 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
value) as follows:
</p><!-- l. 2046 --><p class='indent'>   <!-- l. 2046 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2048 --><p class='indent'>   <!-- l. 2048 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2050 --><p class='indent'>   Next, we define a new notation that denotes <!-- l. 2050 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in a different way as follows:
</p><!-- l. 2052 --><p class='indent'>   <!-- l. 2052 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 2054 --><p class='indent'>   , where <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>,
and <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕀</mi></mrow></math>,
and <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math> is
<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>’s least
significant base-<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index whose value is non-zero after digit index 0. Therefore, each
<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></mrow></math> is mapped to a
unique set of <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 2057 --><p class='indent'>   Next, we define a <span class='rm-lmri-10x-x-109'>lifting </span>polynomial <!-- l. 2057 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
in terms of <!-- l. 2057 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> and
its associated <!-- l. 2057 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 2059 --><p class='indent'>   <!-- l. 2059 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
</p><!-- l. 2062 --><p class='indent'>   Verbally speaking, <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
processes <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> in such
a way that it keeps <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>
(i.e., <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>’s value
at the base-<!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index 0) the same as before, then finds the next least significant
base-<!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit whose value is non-zero (whose digit index is denoted as
<!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>)
and zeros it, during which the subsequent higher significant
base-<!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digits may get updated to any arbitrary values (i.e., the function doesn’t care about those values whose
base-<!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index is higher
than <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math> because they fall
outside the modulo <!-- l. 2062 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></math>
range).
</p><!-- l. 2064 --><p class='indent'>   We will show an example of how <!-- l. 2064 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is updated if it is evaluated by the <!-- l. 2064 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math>
function recursively total <!-- l. 2064 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
times in a row as follows:
</p><!-- l. 2066 --><p class='indent'>   <!-- l. 2066 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder> </mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext> times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 2068 --><p class='indent'>   <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2070 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>1st Recursion: </span><!-- l. 2070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
                                                                                         
                                                                                         
<span style='color:#FF0000;'> # <!-- l. 2070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2072 --><p class='indent'>   <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2074 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>2nd Recursion: </span><!-- l. 2074 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>′</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow><mrow><mi>′</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> <span style='color:#FF0000;'>
# <!-- l. 2074 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2076 --><p class='indent'>   <!-- l. 2076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2078 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>3rd Recursion: </span><!-- l. 2078 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow><mrow><mi>″</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow><mrow><mi>″</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
<span style='color:#FF0000;'> # <!-- l. 2078 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>4</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2080 --><p class='indent'>   <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>⋮</mi></math>
</p><!-- l. 2082 --><p class='noindent'><!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Recursion: </span><!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder> </mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext> times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> <span style='color:#FF0000;'>
# <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math></span>
</p><!-- l. 2084 --><p class='indent'>   <!-- l. 2084 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2088 --><p class='indent'>   In the above recursive computation, notice that the order of using function
<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></math> is
specifically <!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>.
We choose this specific order because we assume that for the initial input
<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, we don’t know its
associated <!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math> value (i.e.,
the least significant base-<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index whose value is non-zero after digit index 0). If we choose the order
<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>→</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-rel' stretchy='false'>→</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>, then regardless
of the value of <!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
we get the universal guarantee that the final output will be
<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math> (i.e., the value
of the base-<!-- l. 2088 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index 0).
</p><!-- l. 2090 --><p class='indent'>   <!-- l. 2090 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2092 --><p class='indent'>   Now, we define the digit extraction function <!-- l. 2092 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 2094 --><p class='indent'>   <!-- l. 2094 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><mo class='MathClass-open' stretchy='false'>(</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>v</mi></mrow></msub></mrow><mo>⏟</mo></munder> </mrow><mrow><mi>v</mi><mstyle class='text'><mtext> times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2097 --><p class='indent'>   Notice that <!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is equivalent to
zeroing out the least significant base-<!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit of <!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>. Let’s see what happens
if we recursively evaluate <!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
at <!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> for
<!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></math> (total
<!-- l. 2097 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
times):
</p><!-- l. 2099 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>1st Recursion: </span><!-- l. 2099 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2101 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>2nd Recursion: </span><!-- l. 2101 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2103 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>3rd Recursion: </span><!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2105 --><p class='indent'>   <!-- l. 2105 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>⋮</mi></math>
</p><!-- l. 2107 --><p class='indent'>   <!-- l. 2107 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Recursion: </span><!-- l. 2107 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
</p><!-- l. 2109 --><p class='indent'>   <!-- l. 2109 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 2111 --><p class='indent'>   As shown above, recursively evaluating <!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
at <!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> for
<!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></math> (total
<!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> times) is equivalent to zeroing
out the least significant (base-<!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digits
modulo <!-- l. 2111 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>.
</p><!-- l. 2123 --><p class='indent'>   <!-- l. 2123 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2125 --><p class='indent'>   By recursively applying the digit extraction function
<!-- l. 2125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
as above, we can zero out the noise stored at the least significant
(base-<!-- l. 2125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2125 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digit
indices.
</p><!-- l. 2127 --><p class='indent'>   Now, our final remaining task is to design the actual <span class='rm-lmri-10x-x-109'>lifting </span>polynomial
<!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> that
implements <!-- l. 2127 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>.
</p><!-- l. 2129 --><p class='indent'>   <!-- l. 2129 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2131 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Designing </span><!-- l. 2131 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
We will derive <!-- l. 2131 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
based on the following steps.
</p><!-- l. 2133 --><p class='indent'>   <!-- l. 2133 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2136 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'>Let’s define <!-- l. 2136 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   = <!-- l. 2136 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   <!-- l. 2138 --><p class='noindent'><!-- l. 2138 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2140 --><p class='noindent'>, where <!-- l. 2140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>,
    <!-- l. 2140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   is the least significant base-<!-- l. 2140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit’s index of <!-- l. 2140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   which has a non-zero value,  and  <!-- l. 2140 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
   </mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
    </mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
   </p><!-- l. 2142 --><p class='noindent'>Basically, <!-- l. 2142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   can be any number in <!-- l. 2142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>ℤ</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></msub></math>
   whose base-<!-- l. 2142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation has 0s between the base-<!-- l. 2142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit index greater than 0 and smaller than <!-- l. 2142 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>.
   </p><!-- l. 2144 --><p class='noindent'><!-- l. 2144 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2146 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
   <div class='proof'>
   <!-- l. 2149 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span>Fermat’s Little Theorem states <!-- l. 2149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><mn>1</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
                                                                                         
                                                                                         
   for all <!-- l. 2149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>
   and prime <!-- l. 2149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
   Therefore, <!-- l. 2149 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>≡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>.
                                                                                        □
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2152 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <div class='proof'>
   <!-- l. 2155 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2155 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
   <table class='equation-star'><tr><td>
   <!-- l. 2155 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>p</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mtext> ∑</mtext></mrow><mrow>
<mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></munderover><mrow><mo fence='true' form='prefix'>(</mo><mfrac linethickness='0.0pt'><mrow><mi>p</mi></mrow>
<mrow><mi>j</mi></mrow></mfrac><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>j</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>p</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup><mstyle class='text'><mtext> # binomial expansion formula</mtext></mstyle>
</mrow></math></td></tr></table>
   <!-- l. 2158 --><p class='noindent'><!-- l. 2158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup></mrow></math>
                                                                                        □
</p>
   </div>
   <!-- l. 2161 --><p class='noindent'><!-- l. 2161 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span>Given <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> and
   <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math> are fixed, there
   exists <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> polynomials
   <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math> (where each polynomial is
   at most <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> degrees) such that
   any <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> (i.e., any number whose
   base-<!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> representation has 0s
   between the base-<!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index
   greater than 0 and smaller than <!-- l. 2163 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>)
   can be expressed as the following formula:
   <!-- l. 2165 --><p class='noindent'><!-- l. 2165 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
                                                                                         
                                                                                         
</p>
   <div class='proof'>
   <!-- l. 2170 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2170 --><p class='noindent'><!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   can be expressed as a base-<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   number as follows:
   </p><!-- l. 2172 --><p class='noindent'><!-- l. 2172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
</mrow></msup></mrow></math>
   </p><!-- l. 2174 --><p class='noindent'><!-- l. 2174 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2176 --><p class='noindent'>Based on step 3’s claim (<!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>),
   we know that the value of <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   depends only on <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>
   (given <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   and <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   are fixed). Therefore, we can imagine that there exists some function <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   whose input is <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
   and the output is <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
   Alternatively, we can imagine that there exist <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
   different functions <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math>
   such that each <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   is a polynomial whose input is <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
   and the output is <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>,
   and <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>.
   The input and output domain of each polynomial <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   is <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
   Therefore, we can design each <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   as a <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
   polynomial and derive each <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   based on polynomial interpolation (<a href='LagrangesPolynomialInterpolation.html#lagranges-polynomial-interpolation'><span class='ts1-lmr10-x-x-109'>§</span>A-15<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>) by using <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   coordinate values.
   </p><!-- l. 2178 --><p class='noindent'>Note that whenever we increase <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   to <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>,
   we add a new polynomial <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></math>.
   However, the previous polynomials <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math>
   stay the same as before, because increasing <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   by 1 only adds a new base-<!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   constant <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></math>
   for the highest base-<!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit, while keeping the lower-digit constants <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math>
   the same as before. Therefore, the polynomials <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math>,
   each of which computes <!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub></mrow></math>,
   also stay the same as before.
                                                                                        □
                                                                                         
                                                                                         
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span>The formula in step 4’s claim can be further concretized as follows:
   <!-- l. 2184 --><p class='noindent'><!-- l. 2184 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
</p>
   <div class='proof'>
   <!-- l. 2187 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2187 --><p class='noindent'>According to step 2’s claim (<!-- l. 2187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>),
   we know that the following base-<!-- l. 2187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation of <!-- l. 2187 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup></math>:
   </p><!-- l. 2189 --><p class='noindent'><!-- l. 2189 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2191 --><p class='noindent'><!-- l. 2191 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2193 --><p class='noindent'>will be the following:
   </p><!-- l. 2195 --><p class='noindent'><!-- l. 2195 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2197 --><p class='noindent'><!-- l. 2197 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2199 --><p class='noindent'>, since the least significant base-<!-- l. 2199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit of <!-- l. 2199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup></math>
   in the base-<!-- l. 2199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation is always <!-- l. 2199 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>.
   Thus, the formula in step 4’s claim:
   </p><!-- l. 2201 --><p class='noindent'><!-- l. 2201 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2203 --><p class='noindent'><!-- l. 2203 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2205 --><p class='noindent'>can be further concretized as follows:
   </p><!-- l. 2207 --><p class='noindent'><!-- l. 2207 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2209 --><p class='noindent'><!-- l. 2209 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
                                                                                        □
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <div class='proof'>
   <!-- l. 2216 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2216 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   Remember that in step 1, we defined <!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   as: <!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>.
   Therefore, <!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></mrow></math>.
   This implies that for each polynomial <!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>,
                                                                                         
                                                                                         
   the following is true:
   </p><!-- l. 2219 --><p class='noindent'><!-- l. 2219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2221 --><p class='noindent'><!-- l. 2221 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2223 --><p class='noindent'>We can further derive the following:
   </p><!-- l. 2225 --><p class='noindent'><!-- l. 2225 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   (where <!-- l. 2225 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>)
   </p><!-- l. 2227 --><p class='noindent'><!-- l. 2227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2229 --><p class='noindent'>The above is true because:
   </p><!-- l. 2231 --><p class='noindent'><!-- l. 2231 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2233 --><p class='noindent'><!-- l. 2233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup></mrow></math>
   (for some integer <!-- l. 2233 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>)
   </p><!-- l. 2235 --><p class='noindent'><!-- l. 2235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   <span style='color:#FF0000;'> # multiplying <!-- l. 2235 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></math>
   to both sides</span>
   </p><!-- l. 2237 --><p class='noindent'><!-- l. 2237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> # <!-- l. 2237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   and <!-- l. 2237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   differ by some multiple of <!-- l. 2237 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></math></span>
   </p><!-- l. 2239 --><p class='noindent'><!-- l. 2239 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2241 --><p class='noindent'>Therefore, <!-- l. 2241 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>.
   </p><!-- l. 2243 --><p class='noindent'><!-- l. 2243 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2245 --><p class='noindent'>Now, given step 5’s claim (<!-- l. 2245 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>),
   we can derive the following:
   </p><!-- l. 2247 --><p class='noindent'><!-- l. 2247 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2249 --><p class='noindent'><!-- l. 2249 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> # applying step 5’s claim</span>
   </p><!-- l. 2251 --><p class='noindent'><!-- l. 2251 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mo>∑</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> # since <!-- l. 2251 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math></span>
   </p><!-- l. 2253 --><p class='noindent'><!-- l. 2253 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
                                                                                        □
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
7. </dt><dd class='enumerate-enumitem'>Finally, we define the lifting polynomial <!-- l. 2257 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   <!-- l. 2259 --><p class='noindent'><!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>−</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   </p><!-- l. 2261 --><p class='noindent'><!-- l. 2261 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FFFFFF;'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2264 --><p class='noindent'>The above relation implies that <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math> is
   equivalent to the least significant base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit of <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> (according to step 6’s
   claim). Therefore, if we plug in <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   into <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
   regard <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then the output is some number whose least significant
   base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit is
                                                                                         
                                                                                         
   <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math> and the 2nd least
   significant base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit
   is <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>. As we recursively
   apply the output back to <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and increment <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   by 1, we iteratively zero out the 2nd least significant
   base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit, the 3rd least
   significant base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit, and so
   on. We repeat this process for <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   times to zero out the upper <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
   base-<!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digits, keeping only the least significant digit as it is (i.e.,
   <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>).
   Therefore, <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is a valid lifting polynomial that can be iteratively used to extract the least significant digit of
   <!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
</p>
   </dd></dl>
<!-- l. 2269 --><p class='indent'>   We use <!-- l. 2269 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as the internal helper function within the digit extraction function
<!-- l. 2269 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> that
calls <!-- l. 2269 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> a
total <!-- l. 2269 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
times.
</p><!-- l. 2273 --><p class='indent'>   <!-- l. 2273 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   
</p>
   <h5 class='subsubsectionHead' id='scaling-factor-reinterpretation'><span class='titlemark'>D-2.11.6   </span> <a id='x122-172000D-2.11.6'></a>Scaling Factor Re-interpretation</h5>
<!-- l. 2281 --><p class='noindent'>Remember that homomorphically decrypting <!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
outputs an encryption of <!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>, whose
entire value is bigger than <!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>.
The final result of homomorphic digit extraction is equivalent to zeroing out the least significant
(base-<!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math> digits of the
input value <!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
Therefore, at the end of digit extraction, we get a ciphertext that encrypts
<!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>, where
<!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
is a polynomial with coefficients which are some multiples of
<!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> to account for the
wrapping values of <!-- l. 2281 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>.
</p><!-- l. 2283 --><p class='indent'>   Therefore, the output of the digit extraction and <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>steps is the ciphertext
<!-- l. 2283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, where the plaintext
                                                                                         
                                                                                         
modulus is <!-- l. 2283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math> and the
plaintext scaling factor <!-- l. 2283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
( as we derived in <a href='#homomorphic-decryption'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>). However, our desired outcome of the BFV
bootstrapping is a noise-removed ciphertext whose plaintext modulus is
<!-- l. 2284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> and the plaintext
scaling factor is <!-- l. 2284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>.
Without doing any actual additional computation, we can view the above ciphertext
<!-- l. 2284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> as an encryption of
plaintext modulo <!-- l. 2284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
whose scaling factor is <!-- l. 2284 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>.
This is because:
</p><!-- l. 2287 --><p class='indent'>   <!-- l. 2287 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 2289 --><p class='indent'>   <!-- l. 2289 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>q</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
</p><!-- l. 2291 --><p class='indent'>   <!-- l. 2291 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> </mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2293 --><p class='indent'>   <!-- l. 2293 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2295 --><p class='indent'>   Therefore, we can view the above ciphertext as
<!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> whose plaintext
modulus is <!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> and
scaling factor <!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>,
because the underlying ciphertext’s structure of these two viewpoints is identical. This
leads to the corollary that evaluating the digit extraction function (<a href='#digit-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.5<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>) at
<!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> recursively
total <!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
times is logically equivalent to the noise elimination and plaintext modulus switch
(<!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>p</mi></mrow></math>) as
follows:
</p><!-- l. 2297 --><p class='indent'>   <!-- l. 2297 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
</p><!-- l. 2300 --><p class='indent'>   <!-- l. 2300 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2302 --><p class='indent'>   We can optionally design a more precise rounding-based function by modifying
<!-- l. 2302 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> to
<!-- l. 2302 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
   </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow></math> as
follows:
</p><!-- l. 2305 --><p class='indent'>   <!-- l. 2305 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
   </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
</p><!-- l. 2314 --><p class='indent'>   <!-- l. 2314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2316 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Generalization of </span><!-- l. 2316 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
We have explained the BFV bootstrapping with the assumption that the plaintext modulus
<!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> is a prime number.
However, we can generalize <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
as <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math> where
<!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>r</mi></math> can be any positive integer.
The benefit of choosing <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>
                                                                                         
                                                                                         
with a small <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
instead of <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> with
a big <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> is the
efficient noise management of the digit extraction process. As digit extraction requires many ciphertext-to-plaintext
multiplications with <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></mrow></math>,
using a small <!-- l. 2316 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
generates a smaller noise during the homomorphic operations.
   
</p>
   <h5 class='subsubsectionHead' id='summary3'><span class='titlemark'>D-2.11.7   </span> <a id='x122-173000D-2.11.7'></a>Summary</h5>
<!-- l. 2322 --><p class='noindent'>We summarize the BFV bootstrapping procedure (with the generalization of
<!-- l. 2322 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>) as
follows.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-88'>     
<div class='tcolorbox-title'>
<!-- l. 2413 --><p class='indent'>   <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-2.11.7</span><!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>BFV Bootstrapping</span></p></div> 
<div class='tcolorbox-content'><!-- l. 2326 --><p class='noindent'>Suppose we have an RLWE ciphertext <!-- l. 2326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Δ</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
where <!-- l. 2326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math>
and <!-- l. 2326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>
(i.e.,      the      plaintext      modulus      is      a      power      of      some      prime),
<!-- l. 2326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>𝕀</mi></mrow></math>,
and <!-- l. 2326 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>≥</mo><mn>1</mn></mrow></math>.
</p><!-- l. 2328 --><p class='noindent'><!-- l. 2328 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span> <span class='rm-lmbx-10x-x-109'>(from </span><!-- l. 2331 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>→</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   Scale down the ciphertext from <!-- l. 2331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    to <!-- l. 2331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    <span style='color:#FF0000;'> # where <!-- l. 2331 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≪</mo><mi>q</mi></mrow></math></span>
   <!-- l. 2333 --><p class='noindent'><!-- l. 2333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2335 --><p class='noindent'><!-- l. 2335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    <span style='color:#FF0000;'> # where <!-- l. 2335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>≈</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>−</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mi>M</mi></mrow></math>,
    which   is   a   modulus   switch   noise   plus   a   rounding   noise   caused   by   treating
    <!-- l. 2335 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Δ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow> <mo class='MathClass-rel' stretchy='false'>≈</mo><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>.</span>
    </p><!-- l. 2337 --><p class='noindent'><!-- l. 2337 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption</span></span><span class='rm-lmbx-10x-x-109'>:         </span>With           the           bootstrapping           key
    <!-- l. 2339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    homomorphically decrypt <!-- l. 2339 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    as follows:
    <!-- l. 2341 --><p class='noindent'><!-- l. 2341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> # where <!-- l. 2341 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow></mrow></math></span>
    </p><!-- l. 2343 --><p class='noindent'><!-- l. 2343 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2345 --><p class='noindent'>Now,    we    denote    the    modulus-switched    noisy    plaintext    polynomial    as
    <!-- l. 2345 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
    </p><!-- l. 2347 --><p class='noindent'><!-- l. 2347 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmbx-10x-x-109'>: </span>Move the (encrypted) polynomial <!-- l. 2349 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>’s
    coefficients <!-- l. 2349 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub></mrow></math>
     to the input vector slots. This is done by computing:
    <!-- l. 2351 --><p class='noindent'><!-- l. 2351 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
    </p><!-- l. 2353 --><p class='noindent'><!-- l. 2353 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>Z</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>⟨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>⟩</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 2355 --><p class='noindent'>, where <!-- l. 2355 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>⋅</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
    is the batch encoding matrix (Summary D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>).
    </p><!-- l. 2357 --><p class='noindent'><!-- l. 2357 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
4.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Digit Extraction</span></span><span class='rm-lmbx-10x-x-109'>: </span>We design a polynomial <!-- l. 2359 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    (a digit extraction polynomial) as follows:
    <!-- l. 2361 --><p class='noindent'><!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>∑</mi><mo> ⁡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></munderover><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
    <span style='color:#FF0000;'> # where <!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>∈</mo> <msub><mrow><mi>ℤ</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></msub></mrow></math>,
    and <!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
   is <!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>’s
    least significant base-<!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit   index   whose   value   is   non-zero   after   digit   index   after   digit   index
    <!-- l. 2361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math></span>
    </p><!-- l. 2363 --><p class='noindent'><!-- l. 2363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>𝜀</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
     <span style='color:#FF0000;'> # a <!-- l. 2363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
    polynomial       recursively       used       to       finally       extract       the       value
    <!-- l. 2363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math></span>
    </p><!-- l. 2365 --><p class='noindent'><!-- l. 2365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>≡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>−</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>⋯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder> </mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mstyle class='text'><mtext> times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    </p><!-- l. 2367 --><p class='noindent'><!-- l. 2367 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2369 --><p class='noindent'>We       homomorphically       evaluate       the       digit       extraction       polynomial
    <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub></math>
    for <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>{</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
  recursively total <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
    times at each coefficient <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    of <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
   stored    at    input    vector    slots,    which    zeros    out    the    least    significant
    (base-<!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
    <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></math>
    digits of <!-- l. 2369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    as follows:
    </p><!-- l. 2371 --><p class='noindent'><!-- l. 2371 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    </p><!-- l. 2373 --><p class='noindent'><!-- l. 2373 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    </p><!-- l. 2375 --><p class='noindent'><!-- l. 2375 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2377 --><p class='noindent'>, provided <!-- l. 2377 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math>’s
    each coefficient <!-- l. 2377 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>𝜀</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>&lt;</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow></math>.
    At   this   point,   each   input   vector   slot   contains   the   noise-removed   coefficient
    <!-- l. 2377 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>′</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>.
    </p><!-- l. 2379 --><p class='noindent'><!-- l. 2379 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
5.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmbx-10x-x-109'>:    </span>Homomorphically     move     each     input     vector     slot’s     value
    <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>
    back to the (encrypted) polynomial coefficient positions. This is done by multiplying
    <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
   to     the     output     ciphertext     of     the     digit     extraction     step,     where
    <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>∗</mo></mrow></msup></math>
   is the decoding matrix (Summary D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>). The output of this computation is
    <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    where <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
    and the plaintext modulus is <!-- l. 2381 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>.
    <!-- l. 2383 --><p class='noindent'><!-- l. 2383 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
6.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation</span></span><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 2387 --><p class='noindent'>The output of the previous step is <!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    where <!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>,
    which is a modulo-<!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   ciphertext encrypting a modulo-<!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></math>
    plaintext with the scaling factor <!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle></math>.
    Without  any  additional  computation,  we  can  theoretically  view  this  ciphertext  as  a
    modulo-<!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   ciphertext encrypting a modulo-<!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   plaintext with the scaling factor <!-- l. 2387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></math>.
    This is because:
    </p><!-- l. 2389 --><p class='noindent'><!-- l. 2389 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
    </p><!-- l. 2391 --><p class='noindent'><!-- l. 2391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>q</mi></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 2393 --><p class='noindent'><!-- l. 2393 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle><mi>M</mi> </mrow><mo fence='true' form='postfix'>)</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 2395 --><p class='noindent'><!-- l. 2395 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2397 --><p class='noindent'>For     these     two     viewpoints,     their     underlying     ciphertext     structure     is
    identical.      Therefore,      the      digit      extraction      function      (<a href='#digit-extraction'><span class='ts1-lmr10-x-x-109'>§</span>D-2.11.5<!-- tex4ht:ref: subsubsec:bfv-rotation-summary  --></a>)      at
    <!-- l. 2397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    recursively total <!-- l. 2397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>𝜀</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></math>
   times  is  logically  equivalent  to  the  noise  elimination  and  plaintext  modulus  switch
    (<!-- l. 2397 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>→</mo><mi>p</mi></mrow></math>)
    as follows:
    </p><!-- l. 2399 --><p class='noindent'><!-- l. 2399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌊</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
   </p><!-- l. 2401 --><p class='noindent'><!-- l. 2401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2403 --><p class='noindent'>A    more    precise    rounding-based    logic    can    be    designed    by    modifying
    <!-- l. 2403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    to <!-- l. 2403 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow></math>
    as follows:
    </p><!-- l. 2406 --><p class='noindent'><!-- l. 2406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>∘</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup>
     </mrow><mrow><mn>2</mn>    </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>⌈</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>⌋</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
</p>
   </dd></dl>
 
</div> 
</div>                                                                     
                                                                                         
<!-- l. 2415 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Necessity of Homomorphic Decryption: </span>Suppose that we performed the BFV bootstrapping
without homomorphic decryption. Then, the input to the digit extraction step would be
<!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>, not
<!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. This is because
the ciphertext <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
encrypts <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>″</mi></mrow></msup><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, where
<!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>″</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup></mrow></math>. Therefore, applying the
<span class='rm-lmss-10x-x-109'>CoeffToSlot </span>transformation to <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>″</mi></mrow></msup><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
will store the coefficients of <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>,
not the coefficients of <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>″</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup></mrow></math>. In order
to preserve the noise <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup></math> as well, we
homomorphically decrypt <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>″</mi></mrow></msup><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by
using an encrypted secret key <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
to make it <!-- l. 2415 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>𝖱𝖫𝖶𝖤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>σ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Δ</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>⋅</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi><mo class='MathClass-bin' stretchy='false'>−</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>𝜀</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>.
</p><!-- l. 619 --><p class='indent'>
                                                                                         
                                                                                         
</p>
   <!-- l. 621 --><div class='crosslinks'><p class='noindent'>[<a href='ApplicationMatrixMultiplication.html'>prev</a>][<a href='BFVScheme.html#NoiseBootstrapping1.html'>parent</a>]</p></div>
    
</body> 
</html>