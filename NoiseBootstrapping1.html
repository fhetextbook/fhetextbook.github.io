<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Noise Bootstrapping</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 1911 --><div class='crosslinks'><p class='noindent'>[<a href='ApplicationMatrixMultiplication.html'>prev</a>][<a href='BFVScheme.html#NoiseBootstrapping1.html'>parent</a>]</p></div>
   <h4 class='subsectionHead' id='noise-bootstrapping1'><span class='titlemark'>D-2.11   </span> <a id='x125-167000D-2.11'></a>Noise Bootstrapping</h4>
<!-- l. 1914 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 1: </span><a href='https://eprint.iacr.org/2022/1363.pdf'>Bootstrapping for BGV and BFV Revisited</a>Â <span class='cite'>[<a href='refname.html#Xcryptoeprint_2022_1363'>14</a>]</span>
</p><!-- l. 1918 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 2: </span><a href='https://eprint.iacr.org/2014/873.pdf'>Bootstrapping for HELib</a>Â <span class='cite'>[<a href='refname.html#X10.1007_s00145-020-09368-7'>15</a>]</span>
</p><!-- l. 1921 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 3: </span><a href='https://arxiv.org/pdf/1906.02867'>A Note on Lower Digits Extraction Polynomial for Bootstrapping</a>Â <span class='cite'>[<a href='refname.html#Xhuo2019notelowerdigitsextraction'>16</a>]</span>
</p><!-- l. 1924 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>- Reference 4: </span><a href='https://eprint.iacr.org/2024/1587.pdf'>Fully Homomorphic Encryption for Cyclotomic Prime Moduli</a>Â <span class='cite'>[<a href='refname.html#Xcryptoeprint_2024_1587'>17</a>]</span>
</p><!-- l. 1933 --><p class='indent'>   <!-- l. 1933 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1935 --><p class='indent'>   In BFV, continuous ciphertext-to-ciphertext multiplication increases the noise in a multiplicative
manner, and once the noise overflows the message bits, then the message gets corrupted. Bootstrapping is
a process of resetting the grown noise.
   
</p>
   <h5 class='subsubsectionHead' id='highlevel-idea1'><span class='titlemark'>D-2.11.1   </span> <a id='x125-168000D-2.11.1'></a>High-level Idea</h5>
<!-- l. 1940 --><p class='noindent'>In this subsection, we will assume the plaintext modulus
<!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math>, a prime number.
Although <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math> can
be generalized as <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>
where <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„¤</mi></mrow></math>
and <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>â‰¥</mo><mn>1</mn></mrow></math>
(SummaryÂ D-2.3 in <a href='EncryptionandDecryption1.html#encryption-and-decryption1'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.3<!-- tex4ht:ref: subsec:bfveencddec  --></a>), we will explain BFVâ€™s bootstrapping assuming
<!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> for simplicity, and
then generalize <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
as <!-- l. 1940 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math> in
the end.
</p><!-- l. 1942 --><p class='indent'>   The core idea of the BFV bootstrapping is to homomorphically evaluate a special polynomial
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, a digit extraction polynomial
modulo <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> (for some positive
integer <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>), where the input to
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is a noisy plaintext value
modulo <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> and the output is a
noise-free plaintext value modulo <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>,
shifted to the right by 1 base-<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit. Here, where the noise located at the least significant digits in a
base-<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
(prime) representation is zeroed out and shifted right. For example,
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>3</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>6</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>3</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>4</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>6</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>. Given that the noise resides
in the least significant <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
                                                                                         
                                                                                         
digits in base-<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
representation, we can homomorphically and recursively evaluate
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> total
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
times in a row, which zeroes out and removes the least significant
(base-<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> digits of
input <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>.
To homomorphically evaluate the noisy plaintext through
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>, we need to first switch the
plaintext modulus from <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math>
to <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>, where
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mi>p</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>t</mi></mstyle>. The larger
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> is, the
more likely it is that the noise gets successfully zeroed out; however, the computation overhead becomes
larger. If <!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> is
small, the computation gets faster, but the digit-wise distance between the noise and the plaintext
decreases, potentially corrupting the plaintext during bootstrapping, because removing the
most significant noise digit may also remove the least significant plaintext digit. Therefore,
<!-- l. 1942 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> should
be chosen carefully.
</mrow></math></p><!-- l. 1944 --><p class='indent'>   <!-- l. 1944 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1946 --><p class='indent'>   The technical details of the BFV bootstrapping procedure are as follows. Suppose we have an RLWE
ciphertext <!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
where <!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>A</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>B</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi></mrow></math>,
 <!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>, and
<!-- l. 1946 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi>p</mi></mrow></math> (i.e.,
the plaintext modulus is a prime).
</p><!-- l. 1949 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Modulus Switch (</span><!-- l. 1949 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   Scale down the ciphertext modulus from <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   to <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   where <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><mi>q</mi></mrow></math>.
   The purpose of this modulus switch is to change the plaintext modulus to <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>,
   which is required to use the digit extraction polynomial <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (because we need to represent the input to <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as a base-<!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   number in order to interpret it as a <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   value). Notice that <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msubsup><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>,
   where <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>M</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   the modulus switch error of <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>E</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>
                                                                                         
                                                                                         
   plus the modulus switch error of the plaintextâ€™s scaling factor <!-- l. 1949 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math></span>
   <!-- l. 1951 --><p class='noindent'><!-- l. 1951 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption: </span>Suppose we have the <span class='rm-lmri-10x-x-109'>bootstrapping key </span><!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
   which is the secret key <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   encrypted by <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   (itself) modulo <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   with the plaintext scaling factor <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>.
   Using this <span class='rm-lmri-10x-x-109'>encrypted </span>secret key, we <span class='rm-lmri-10x-x-109'>homomorphically </span>decrypt <!-- l. 1953 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   <!-- l. 1955 --><p class='noindent'><!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>
   <span style='color:#FF0000;'><!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   where <!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is a modulo-<!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   ciphertext that encrypts a modulo-<!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   plaintext <!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   whose scaling factor <!-- l. 1955 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>
   </span>
   </p><!-- l. 1957 --><p class='noindent'><!-- l. 1957 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1959 --><p class='noindent'><!-- l. 1959 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1961 --><p class='noindent'><!-- l. 1961 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   </p><!-- l. 1963 --><p class='noindent'><!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math>
   is some integer polynomials to represent the coefficient values that wrap around <!-- l. 1963 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math></span>
   </p><!-- l. 1971 --><p class='noindent'><!-- l. 1971 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 1973 --><p class='noindent'>Letâ€™s see how we derived the above relation. Suppose we compute <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   whose output will be <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>.
   Now, instead of using the plaintext secret key <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>,
   we use an encrypted secret key <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
   where <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   is a plaintext modulo <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>,
   its scaling factor <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>,
   and the ciphertext encrypting <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
   is in modulo <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>.
   Then, the result of homomorphically computing <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></math>
   will be an encryption of <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
   where <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   stands for the wrapping-around coefficient values of the multiples of <!-- l. 1973 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>.
   </p><!-- l. 1975 --><p class='noindent'>Notice that we did not reduce <!-- l. 1975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   by modulo <!-- l. 1975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
   during homomorphic decryption (without modulo-<!-- l. 1975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
   reduction), because such a homomorphic modulo reduction is not directly doable. Instead, we will
   handle <!-- l. 1975 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   in the later digit extraction step.
                                                                                         
                                                                                         
   </p><!-- l. 1978 --><p class='noindent'>For simplicity, we will denote <!-- l. 1978 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
   </p><!-- l. 1980 --><p class='noindent'><!-- l. 1980 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span><span class='rm-lmbx-10x-x-109'>: </span>Move the (encrypted) polynomial <!-- l. 1982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>â€™s
   coefficients <!-- l. 1982 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></math>
   to the input vector slots of an RLWE ciphertext. This is done by computing:
   <!-- l. 1984 --><p class='noindent'><!-- l. 1984 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
   </p><!-- l. 1986 --><p class='noindent'>, where <!-- l. 1986 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
   is the batch encoding matrix that converts input vector slot values into polynomial coefficients
   (SummaryÂ D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>).
   </p><!-- l. 1988 --><p class='noindent'><!-- l. 1988 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='rm-lmbx-10x-x-109'>Digit Extraction: </span>We design a polynomial <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   (i.e., a digit extraction polynomial) that zeros out the least significant base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit(s) modulo <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>.
   The digit extraction procedure recursively applies <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   to the input <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
   to eliminate the least significant (base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></math>
   digits of input <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>
   and shifts them to the right. Regarding the input <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math>,
   we assume the noise resides in the least significant (base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
   <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></math>
   digits, and the message <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>m</mi></math>
   resides in the higher base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digits modulo <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>.
   Therefore, digit extraction has the effect of zeroing out and deleting (i.e., shifting to the right) the
   least significant <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   digits of the base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation of <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>m</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>e</mi></mrow></math>.
   This digit extraction is performed homomorphically. Throughout the digit extraction, the scaled
   plaintext message with noise stored at the input vector slots of the ciphertext gets updated from
   <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
   to <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>p</mi></mrow></math>.
   During digit extraction, we also use a special method called scaling factor re-interpretation, which
   conceptually increases the scaling factor <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>
   over each round of digit extraction to <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>    <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>   <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo><mo>â€¦</mo><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>,
   which equivalently has the conceptual effect of dividing the scaled message and noise stored in the
   plaintext slots by <!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   (i.e., shift to the right by 1 base-<!-- l. 1990 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit) as follows:
   <!-- l. 1992 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 1992 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1994 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Round 1: </span><!-- l. 1994 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
                                                                                         
                                                                                         
   </p><!-- l. 1996 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Round 2: </span><!-- l. 1996 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
   </p><!-- l. 1998 --><p class='noindent'><!-- l. 1998 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>â‹®</mi></math>
   </p><!-- l. 2000 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Round </span><!-- l. 2000 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
   <!-- l. 2000 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi mathvariant='italic'>ğ¾ğ‘</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   </p><!-- l. 2003 --><p class='noindent'><!-- l. 2003 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2005 --><p class='noindent'>Importantly, the scaling factor re-interpretation does not require any actual computation; we
   only change the way of interpreting the ciphertext. We will cover this in more detail. later.
   </p><!-- l. 2008 --><p class='noindent'><!-- l. 2008 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p></dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span><span class='rm-lmbx-10x-x-109'>: </span>Homomorphically move each input vector slotâ€™s value back to the (encrypted)
   polynomial  coefficient  position.  This  is  done  by  homomorphically  multiplying  the  decoding
   matrix <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>
   to the ciphertext (SummaryÂ D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>). The final output of this step is <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>b</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>,
   where <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mstyle class='text'><mtext>b</mtext></mstyle><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   is a new small noise term generated during the homomorphic operation of  <span class='rm-lmss-10x-x-109'>CoeffToSlot</span>, digit
   extraction, and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>. The size of <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mstyle class='text'><mtext>b</mtext></mstyle><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   is fixed and smaller than <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>E</mi></math>
   and <!-- l. 2011 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>.
   <!-- l. 2014 --><p class='noindent'><!-- l. 2014 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
   </dd></dl>
<!-- l. 2035 --><p class='indent'>   Next, we will explain each step in more detail.
   
</p>
   <h5 class='subsubsectionHead' id='modulus-switch'><span class='titlemark'>D-2.11.2   </span> <a id='x125-169000D-2.11.2'></a>Modulus Switch</h5>
<!-- l. 2040 --><p class='noindent'>The first step of the BFV bootstrapping is to do a modulus switch from
<!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math> to some prime
power modulus <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
where <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><mi>q</mi></mrow></math>.
Before the bootstrapping, suppose the encrypted plaintext with noise is
<!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>. Then, after the modulus
switch from <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>, the plaintext
would scale down to <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
where <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> roughly
contains <!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle><mi>E</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>
plus the modulus switching noise of the plaintextâ€™s scaling factor
<!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>.
The goal of the BFV bootstrapping is to zero out this noise
<!-- l. 2040 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>.
   
                                                                                         
                                                                                         
</p>
   <h5 class='subsubsectionHead' id='homomorphic-decryption'><span class='titlemark'>D-2.11.3   </span> <a id='x125-170000D-2.11.3'></a>Homomorphic Decryption</h5>
<!-- l. 2045 --><p class='noindent'>Letâ€™s denote the modulus-switched noisy plaintext as
<!-- l. 2045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>. We further denote
polynomial <!-- l. 2045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>â€™s each
degree termâ€™s coefficient <!-- l. 2045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
as base-<!-- l. 2045 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
number as follows:
</p><!-- l. 2047 --><p class='indent'>   <!-- l. 2047 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2049 --><p class='indent'>   <!-- l. 2049 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2051 --><p class='indent'>   Then, <!-- l. 2051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math> is a
base-<!-- l. 2051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> number
comprising <!-- l. 2051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math>
digits: <!-- l. 2051 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>{</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>}</mo></mrow></math>
</p><!-- l. 2054 --><p class='indent'>   We assume that the highest base-<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index for the noise is <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></math>,
which is equivalent to the noise budget, and the pure plaintext portion solely resides at the
base-<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index
<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> (i.e., the most
significant base-<!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit in modulo <!-- l. 2054 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>).
Given this assumption, we extract the noise-free plaintext by computing the following:
</p><!-- l. 2056 --><p class='indent'>   <!-- l. 2056 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></math> <span style='color:#FF0000;'>
<!-- l. 2056 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> where the noise is assumed
to be smaller than <!-- l. 2056 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>
   </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></math></span>
</p><!-- l. 2058 --><p class='indent'>   The above formula is equivalent to shifting the
base-<!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
number <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
by <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> digits to
the right (and rounding the decimal value). However, remember that we donâ€™t have direct access to polynomial
<!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math> unless we have
the secret key <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>
to decrypt the ciphertext storing the plaintext. Instead, we can only derive
<!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math> as an
encrypted form. Specifically, we can <span class='rm-lmri-10x-x-109'>homomorphically </span>decrypt the modulus-switched ciphertext
<!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> by using the <span class='rm-lmri-10x-x-109'>encrypted </span>secret
key <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as a <span class='rm-lmri-10x-x-109'>bootstrapping key</span>. For
this ciphertext <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, the plaintext
modulus is <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>, the plaintext scaling
factor is <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>, and the ciphertext
modulus is <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>. With this encrypted
secret key <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>S</mi></math>, we homomorphically
decrypt the encrypted <!-- l. 2058 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
                                                                                         
                                                                                         
as follows:
</p><!-- l. 2061 --><p class='indent'>   <!-- l. 2061 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2063 --><p class='indent'>   <!-- l. 2063 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2065 --><p class='indent'>   <!-- l. 2065 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2068 --><p class='indent'>   <!-- l. 2068 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2070 --><p class='indent'>   <!-- l. 2070 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2072 --><p class='indent'>   <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span style='color:#FF0000;'>
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math> is
some integer polynomials to represent the coefficient values that wrap around modulo
<!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math> as multiples
of <!-- l. 2072 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math></span>
</p><!-- l. 2074 --><p class='indent'>   <!-- l. 2074 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2076 --><p class='indent'>   <!-- l. 2076 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2078 --><p class='indent'>   <!-- l. 2078 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2080 --><p class='indent'>   During this homomorphic decryption, we did not reduce the plaintext result by modulo
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>, because
the homomorphic decryption is a ciphertext-to-plaintext multiplication and addition done in the ciphertext
modulus <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
(not <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>) by
using <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> and
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> as plaintexts (with the
plaintext modulus <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>e</mi></mrow></msup></math>) and
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> as a ciphertext (with the
ciphertext modulus <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>). This
is why the wrapping term <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
is preserved in the plaintext after the homomorphic decryptionâ€“ we will handle
this term at the later stage of bootstrapping. Also, notice that the computation of
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> would not generate much
noise. This is because <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
is a plaintext modulo <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>,
and thus the new noise generated by ciphertext-to-plaintext multiplication is
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math> (where
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></math> is the encryption
noise of <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>). Since the
ciphertext modulus <!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
<!-- l. 2080 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â‰«</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mi>E</mi></mrow><mrow><mi>s</mi></mrow></msub></mrow></math>.
</p><!-- l. 2082 --><p class='indent'>   Once we have derived <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>, our next
step is to remove the noise in the lower <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
digits (in terms of base-<!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
representation) of each <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
for <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>. This is equivalent
to transforming noisy <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
into noise-free <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math> where
<!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow></math>. BFVâ€™s solution to do
                                                                                         
                                                                                         
this is to design a <!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>-degree
polynomial function which computes the same logical result as
<!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>.
We will later explain how to design this polynomial by using the digit extraction polynomial
<!-- l. 2082 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
(<a href='#digit-extraction'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.11.5<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>).
</p><!-- l. 2096 --><p class='indent'>   However, in order to <span class='rm-lmri-10x-x-109'>homomorphically </span>evaluate this polynomial at each coefficient
<!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> given the ciphertext
<!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>, we need to move
polynomial <!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>â€™s
each coefficient <!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
to the input vector slots of an RLWE ciphertext. This is because BFV supports homomorphic batched
<!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mtext class='MathClass-open' stretchy='false'>(+,â‹…)</mtext></mrow></math> operations
based on input vector slots of ciphertexts as operands. Therefore, we need to evaluate the noise-removing
polynomial <!-- l. 2096 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
based on the values stored in the input vector slots of a ciphertext.
</p><!-- l. 2098 --><p class='indent'>   In the next sub-section, we will explain the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>procedure, a process of moving polynomial
coefficients into input vector slots of a ciphertext <span class='rm-lmri-10x-x-109'>homomorphically</span>.
   
</p>
   <h5 class='subsubsectionHead' id='coefftoslot-and-slottocoeff'><span class='titlemark'>D-2.11.4   </span> <a id='x125-171000D-2.11.4'></a><span class='rm-lmss-10x-x-109'>CoeffToSlot </span>and <span class='rm-lmss-10x-x-109'>SlotToCoeff</span></h5>
<!-- l. 2103 --><p class='noindent'>The goal of the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step is to homomorphically move polynomial
<!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>â€™s
coefficients <!-- l. 2103 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
to input vector slots.
</p><!-- l. 2106 --><p class='indent'>   In SummaryÂ D-2.9.3 (in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>), we learned that the encoding formula for converting a vector of input slots
<!-- l. 2106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></math> into a vector of
polynomial coefficients <!-- l. 2106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></math>
is: <!-- l. 2106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>m</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>v</mi></mrow><mo accent='true' stretchy='false'>â†’</mo></mover></mrow></math>, where
<!-- l. 2106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></math> is a basis of the
<!-- l. 2106 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
vector space crafted as follows:
</p><!-- l. 2108 --><p class='indent'>   <!-- l. 2108 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'>         <mn>1</mn>         </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>      <mn>1</mn>       </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'>          <mn>1</mn>          </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>       <mn>1</mn>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>            <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>    <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                              </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2116 --><p class='indent'>   <!-- l. 2116 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2118 --><p class='indent'>   <span style='color:#FF0000;'> <!-- l. 2118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>where the rotation
helper function <!-- l. 2118 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>h</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mn>5</mn></mrow><mrow><mi>h</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mn>2</mn><mi>n</mi></mrow></math></span>
</p><!-- l. 2120 --><p class='indent'>   <!-- l. 2120 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2122 --><p class='indent'>   Therefore, given the input ciphertext <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¼ğ—</mtext></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
we can understand its input vector slots as storing some values such that multiplying
<!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> to each of them turns them
into a coefficient <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> of polynomial
                                                                                         
                                                                                         
<!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>. This implies that if we
<span class='rm-lmri-10x-x-109'>homomorphically </span>multiply <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> to
the input vector slots of <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>, then the
resulting ciphertextâ€™s <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>-dimensional
input vector slots will contain the <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
coefficients of <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>, which is equivalent
to moving the coefficients of <!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
to the input vector slots. Therefore, the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step is equivalent to homomorphically computing
<!-- l. 2122 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>. We
can homomorphically compute matrix-vector multiplication by using the technique explained in
<a href='ApplicationMatrixMultiplication.html#application-matrix-multiplication'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.10<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>.
</p><!-- l. 2124 --><p class='indent'>   After the <span class='rm-lmss-10x-x-109'>CoeffToSlot </span>step, we can homomorphically eliminate the noise in the lower
(base-<!-- l. 2124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> digits
of each <!-- l. 2124 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
by homomorphically evaluating the noise-removing polynomial (to be explained in the next
subsection).
</p><!-- l. 2126 --><p class='indent'>   After we get noise-free coefficients of <!-- l. 2126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>,
we need to move them back from the input vector slots to their original coefficient
positions. This step is called <span class='rm-lmss-10x-x-109'>SlotToCoeff</span>, which is an exact inverse procedure of
<span class='rm-lmss-10x-x-109'>CoeffToSlot</span>. We also learned in SummaryÂ D-2.9.3 (in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>) that the inverse matrix of
<!-- l. 2126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>n</mi></mrow><mrow><mi>R</mi></mrow></msubsup></mrow></math> is
<!-- l. 2126 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>,
where:
</p><!-- l. 2128 --><p class='indent'>   <!-- l. 2128 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo>  <mrow><mo fence='true' form='prefix'>[</mo><mrow><mtable align='axis' class='array' columnlines='none none none none none none none none none' displaystyle='true' equalcolumns='false' equalrows='false' rowlines='none none none none none none none none' style=''> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>    <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>    </mtd><mtd class='array-td' columnalign='center'>    <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>     </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>     </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>â‹®</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>  </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>   </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>  <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>   </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'>   <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo>   </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>    </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'>   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>    </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'>  <mi>â‹®</mi> </mtd><mtd class='array-td' columnalign='center'>      <mi>â‹®</mi>      </mtd><mtd class='array-td' columnalign='center'>       <mi>â‹®</mi>       </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-rel' stretchy='false'>â‹±</mo> </mtd><mtd class='array-td' columnalign='center'>        <mi>â‹®</mi>        </mtd>
</mtr> <mtr class='array-row'><mtd class='array-td' columnalign='center'> <mn>1</mn> </mtd><mtd class='array-td' columnalign='center'> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mn>2</mn></mrow></msup>  </mtd><mtd class='array-td' columnalign='center'>  <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> </mtd><mtd class='array-td' columnalign='center'> <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><msub><mrow><mi>J</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup>  </mtd>
</mtr>  <!-- *\c@MaxMatrixCols c --></mtable>                                                                                                                                                            </mrow><mo fence='true' form='postfix'>]</mo></mrow> </mrow></math>
</p><!-- l. 2141 --><p class='indent'>   Therefore, the <span class='rm-lmss-10x-x-109'>SlotToCoeff </span>step is equivalent to homomorphically multiplying
<!-- l. 2141 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math> to the
output of the noise-eliminating polynomial evaluation.
</p><!-- l. 2143 --><p class='indent'>   In the next subsection, we will learn how to design the core algorithm of
BFV, the noise elimination polynomial, based on the digit extraction polynomial
<!-- l. 2143 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
   
</p>
   <h5 class='subsubsectionHead' id='digit-extraction'><span class='titlemark'>D-2.11.5   </span> <a id='x125-172000D-2.11.5'></a>Digit Extraction</h5>
<!-- l. 2150 --><p class='noindent'>Remember that we defined polynomial <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
as the scaled noisy plaintext: <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>,
                                                                                         
                                                                                         
and each <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> is
the <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
coefficient of <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
(where <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>i</mi> <mo class='MathClass-rel' stretchy='false'>â‰¤</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>). The
goal of the digit extraction step is to homomorphically zero out and delete (i.e., shift to the right) the lower
(base-<!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
<!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> digits
of each <!-- l. 2150 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
where the noise resides.
</p><!-- l. 2152 --><p class='indent'>   First, we always think of <!-- l. 2152 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
as a base-<!-- l. 2152 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> representation
(since this is a modulo-<!-- l. 2152 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></math>
value) as follows:
</p><!-- l. 2154 --><p class='indent'>   <!-- l. 2154 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2156 --><p class='indent'>   <!-- l. 2156 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2158 --><p class='indent'>   Next, we define a new notation that denotes <!-- l. 2158 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
in a different way as follows:
</p><!-- l. 2160 --><p class='indent'>   <!-- l. 2160 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup></mrow></math>
</p><!-- l. 2162 --><p class='indent'>   , where <!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>,
and <!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„¤</mi></mrow></math>,
and <!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> is
<!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>â€™s least
significant base-<!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index whose value is non-zero after digit index 0. Therefore, each
<!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></msub></mrow></math> is mapped to a
unique set of <!-- l. 2162 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 2165 --><p class='indent'>   Next, we define a <span class='rm-lmri-10x-x-109'>lifting </span>polynomial <!-- l. 2165 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></math>
in terms of <!-- l. 2165 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> and
its associated <!-- l. 2165 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 2167 --><p class='indent'>   <!-- l. 2167 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
</p><!-- l. 2170 --><p class='indent'>   Verbally speaking, <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
processes <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> in such
a way that it keeps <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>
(i.e., <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>â€™s value
at the base-<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index 0) the same as before, then finds the next least significant
base-<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit whose value is non-zero (whose digit index is denoted as
<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>)
and zeros it, during which the subsequent higher significant
base-<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digits may be updated to arbitrary values (i.e., the function doesnâ€™t care about those values whose
base-<!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index is higher
than <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> because they fall
                                                                                         
                                                                                         
outside the modulo <!-- l. 2170 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></math>
range).
</p><!-- l. 2172 --><p class='indent'>   We will show an example of how <!-- l. 2172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
is updated if it is evaluated by the <!-- l. 2172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></math>
function recursively a total of <!-- l. 2172 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
times in a row as follows:
</p><!-- l. 2174 --><p class='indent'>   <!-- l. 2174 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
</p><!-- l. 2176 --><p class='indent'>   <!-- l. 2176 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2178 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>1st Recursion: </span><!-- l. 2178 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2180 --><p class='indent'>   <span style='color:#FF0000;'> <!-- l. 2180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
<!-- l. 2180 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2182 --><p class='indent'>   <!-- l. 2182 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2184 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>2nd Recursion: </span><!-- l. 2184 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow><mrow><mi>â€²</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2186 --><p class='indent'>   <span style='color:#FF0000;'> <!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
<!-- l. 2186 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2188 --><p class='indent'>   <!-- l. 2188 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2190 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>3rd Recursion: </span><!-- l. 2190 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>c</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow><mrow><mi>â€³</mi></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2192 --><p class='indent'>   <span style='color:#FF0000;'> <!-- l. 2192 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
<!-- l. 2192 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>4</mn></mrow></msup></mrow></math></span>
</p><!-- l. 2194 --><p class='indent'>   <!-- l. 2194 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>â‹®</mi></math>
</p><!-- l. 2196 --><p class='noindent'><!-- l. 2196 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Recursion: </span><!-- l. 2196 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
</p><!-- l. 2198 --><p class='indent'>   <span style='color:#FF0000;'> <!-- l. 2198 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
<!-- l. 2198 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math></span>
</p><!-- l. 2200 --><p class='indent'>   <!-- l. 2200 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2204 --><p class='indent'>   In the above recursive computation, notice that the order of using function
<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></math> is
specifically <!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></math>.
We choose this specific order because we assume that for the initial input
<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>, we do not know its
associated <!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> value (i.e.,
the least significant base-<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index whose value is non-zero after digit index 0). If we choose the order
<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-rel' stretchy='false'>â†’</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></math>, then regardless
of the value of <!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>,
we obtain the universal guaranty that the final output will be
<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math> (i.e., the value
of the base-<!-- l. 2204 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit index 0).
</p><!-- l. 2206 --><p class='indent'>   <!-- l. 2206 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2208 --><p class='indent'>   Now, we define the digit extraction function <!-- l. 2208 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as follows:
</p><!-- l. 2210 --><p class='indent'>   <!-- l. 2210 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mrow><mi>p</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
</p><!-- l. 2213 --><p class='indent'>   , where <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mrow><mi>p</mi></mrow></msub></math> denotes division
                                                                                         
                                                                                         
by <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> and rounding down to the
nearest multiple of <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>. Verbally
speaking, <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>v</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is equivalent to zeroing
out the least significant base-<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit of <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> and then shifting to
the right by 1 base-<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit. The
shifting is done by inverse <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
multiplication (i.e., <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>). Notice
that the last base-<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit of
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> is 0, which is is exactly divisible by
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>. Thus, multiplying by the inverse
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> has the effect of exact division
(i.e., shifting the whole base-<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
representation by 1 digit to the right). The reason why the inverse
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> is in
modulo <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>
is that we are currently under the BFV ciphertext relation:
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¢ğ—ˆğ–¾ğ–¿ğ–¿ğ–³ğ—ˆğ–²ğ—…ğ—ˆğ—</mtext></mstyle><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>c</mi><mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>s</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>c</mi><mo class='MathClass-rel' stretchy='false'>â†’</mo><mi>s</mi><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, whose plaintext slots store
the coefficients of <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>. Upon
homomorphically computing <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as part of the 1st round of digit extraction, the ciphertext is updated to
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>, whose plaintext slots
store the coefficients of <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mo class='MathClass-open' stretchy='false'>âŒŠ</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>âŒ‹</mo></mrow><mrow><mi>p</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
where <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mo class='MathClass-open' stretchy='false'>âŒŠ</mo><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>âŒ‹</mo></mrow><mrow><mi>p</mi></mrow></msub></math> is equivalent to
rounding <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> down to the
nearest multiple of <!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
Therefore, to right-shift these coefficient values stored in slots by 1
(base-<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
digit, we need to homomorphically multiply the slot values by
<!-- l. 2213 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>. This is
equivalent to performing the ciphertext-to-plaintext multiplication (<a href='CiphertexttoPlaintextMultiplication.html#ciphertexttoplaintext-multiplication'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.6<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>) as follows:
</p><!-- l. 2215 --><p class='indent'>   <!-- l. 2215 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¤ğ—‡ğ–¼ğ—ˆğ–½ğ–¾</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2217 --><p class='indent'>   <!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math> <span style='color:#FF0000;'>
<!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math> since
<!-- l. 2217 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–¤ğ—‡ğ–¼ğ—ˆğ–½ğ–¾</mtext></mstyle><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><mi>X</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>0</mn><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></math>
</span>
</p><!-- l. 2219 --><p class='indent'>   <!-- l. 2219 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2221 --><p class='indent'>   <!-- l. 2221 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2223 --><p class='indent'>   Therefore, by multiplying the coefficients of two BFV ciphertext polynomials
<!-- l. 2223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> and
<!-- l. 2223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> by
<!-- l. 2223 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>, we
obtain the following effect:
</p><!-- l. 2225 --><p class='indent'>   <!-- l. 2225 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-open' stretchy='false'>(</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2227 --><p class='indent'>   <!-- l. 2227 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo><msub><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mrow><mi>p</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
                                                                                         
                                                                                         
</p><!-- l. 2230 --><p class='indent'>   <!-- l. 2230 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow> <mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2232 --><p class='indent'>   <!-- l. 2232 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2234 --><p class='indent'>   Verbally speaking, the above inverse-<!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
multiplication to all polynomial coefficients of <!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><msub><mrow><mi>g</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
has the following two effects: (2) scales down the plaintext by
<!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>; and (2) reduces
the noise <!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> to
<!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math> (i.e., right-shift
by 1 base-<!-- l. 2234 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
digit).
</p><!-- l. 2236 --><p class='indent'>   <!-- l. 2236 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2238 --><p class='indent'>   For now, the digit extraction procedure can be understood as recursively evaluating
<!-- l. 2238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math> with the input
<!-- l. 2238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> by decreasing
<!-- l. 2238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>ğœ€</mi></math> by 1 at each
round (total <!-- l. 2238 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
rounds) as follows:
</p><!-- l. 2240 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 2240 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2242 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>1st Round: </span><!-- l. 2242 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2244 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>2nd Round: </span><!-- l. 2244 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2246 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>3rd Round: </span><!-- l. 2246 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>4</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2248 --><p class='indent'>   <!-- l. 2248 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>â‹®</mi></math>
</p><!-- l. 2250 --><p class='indent'>   <!-- l. 2250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Round: </span><!-- l. 2250 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2252 --><p class='indent'>   <!-- l. 2252 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2254 --><p class='indent'>   As shown above, the entire digit extraction procedure results in two
effects on the values stored in the plaintext slots: (1) scales down the message
<!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi></mrow></math> back to
<!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>M</mi></math>; and (2) zeros
out the noise <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> (i.e.,
<!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>0</mn></mrow></math>); and. The reason
why <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>K</mi></math> gets updated
to <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></mrow></math> across rounds is
that each <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th roundâ€™s
evaluation of function <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>F</mi></math>
and <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>G</mi></math> is done modulo
<!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi></mrow></msup></math>, which produces
new <!-- l. 2254 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi></mrow></msup></math>-multiple
overflow garbage values each time.
</p><!-- l. 2256 --><p class='indent'>   <!-- l. 2256 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
</p><!-- l. 2259 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation: </span>Although we explained above that each round
<!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math> involves the
multiplication of <!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>,
technically, this multiplication is skipped, and instead, we conceptually re-interpret the scaling factor
<!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> to be
changed to <!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â†’</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>
across <!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
rounds of digit extraction. This implies that at each round of digit extraction, the plaintext operands used
for ciphertext-to-plaintext homomorphic operations should encode their values by using the correct scaling
factor at each moment in time. At the end of digit extraction, the final plaintext scaling factor becomes
<!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>, the desired setup
for BFV ciphertexts. Applying the scaling factor re-interpretation, the true digit extraction procedure (without explicit
multiplication by <!-- l. 2259 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
at each round) is performed as follows:
</p><!-- l. 2262 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>Input: </span><!-- l. 2262 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2264 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>1st Round: </span><!-- l. 2264 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
 </mrow><mrow><mi>p</mi> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2266 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>2nd Round: </span><!-- l. 2266 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>2</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2268 --><p class='indent'>   <span class='rm-lmbx-10x-x-109'>3rd Round: </span><!-- l. 2268 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>  <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>4</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>4</mn></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mn>3</mn></mrow></msup> </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>3</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2270 --><p class='indent'>   <!-- l. 2270 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>â‹®</mi></math>
</p><!-- l. 2272 --><p class='indent'>   <!-- l. 2272 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mstyle></math><span class='rm-lmbx-10x-x-109'>-th
Round: </span><!-- l. 2272 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><munderover><mrow><mo stretchy='true'>==â‡’</mo></mrow><mrow><mstyle class='MathClass-rel' stretchy='false'><mspace class='nbsp' width='0.33em'></mspace></mstyle></mrow><mrow><mstyle class='text'><mtext>effect</mtext></mstyle><mspace class='nbsp' width='0.33em'></mspace></mrow></munderover> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
</p><!-- l. 2276 --><p class='indent'>   <!-- l. 2276 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2280 --><p class='indent'>   <!-- l. 2280 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2283 --><p class='indent'>   Notice that at the end of the final round, the plaintext scaling factor becomes
<!-- l. 2283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>,
the desired plaintext scaling factor for standard BFV ciphertexts. Therefore, the scaling
factor re-interpretation has two benefits: (1) we can skip explicit multiplication by
<!-- l. 2283 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math> at each
round; (2) at the end of all rounds, the plaintext scaling factor becomes the desired value for standard
BFV ciphertexts, gracefully completing the bootstrapping procedure.
</p><!-- l. 2286 --><p class='indent'>   <!-- l. 2286 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2288 --><p class='indent'>   Now, our final remaining task is to design the actual <span class='rm-lmri-10x-x-109'>lifting </span>polynomial
<!-- l. 2288 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> that
implements <!-- l. 2288 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math>.
</p><!-- l. 2290 --><p class='indent'>   <!-- l. 2290 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 2292 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>Designing </span><!-- l. 2292 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math><span class='rm-lmbx-10x-x-109'>:</span>
We will derive <!-- l. 2292 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
based on the following steps.
</p><!-- l. 2295 --><p class='indent'>
   </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2295 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
                                                                                         
                                                                                         
   <div class='proof'>
   <!-- l. 2298 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span>Itâ€™s true that <!-- l. 2298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>.
   Fermatâ€™s Little Theorem states <!-- l. 2298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>a</mi></mrow><mrow><mi>p</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mi>a</mi><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>
   for all <!-- l. 2298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>a</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><mi>p</mi></mrow></msub></mrow></math>
   and prime <!-- l. 2298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>.
   Therefore, <!-- l. 2298 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msup><mrow><mi>z</mi></mrow><mrow><mi>p</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>.
                                                                                        â–¡
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
2. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2301 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <div class='proof'>
   <!-- l. 2304 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2304 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p>
   <table class='equation-star'><tr><td>
   <!-- l. 2304 --><math class='equation' display='block' xmlns='http://www.w3.org/1998/Math/MathML'><mrow>
   <msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>k</mi><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>p</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><munderover accent='false' accentunder='false'><mrow><mtext> âˆ‘</mtext></mrow><mrow>
<mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></munderover><mrow><mo fence='true' form='prefix'>(</mo><mfrac linethickness='0.0pt'><mrow><mi>p</mi></mrow>
<mrow><mi>j</mi></mrow></mfrac><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>j</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>k</mi><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>p</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msup><mstyle class='text'><mstyle><mo class='MathClass-rel' stretchy='false'>â–¹</mo></mstyle></mstyle>
</mrow></math></td></tr></table>
   <!-- l. 2307 --><p class='noindent'><!-- l. 2307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   all terms where <!-- l. 2307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mstyle class='MathClass-rel' stretchy='false'>/mo&gt; <mi>p</mi></mstyle>
   are <!-- l. 2307 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></math></mrow></math>
                                                                                        â–¡
</span></p>
   </div>
   <!-- l. 2310 --><p class='noindent'><!-- l. 2310 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
                                                                                         
                                                                                         
   </p></dd><dt class='enumerate-enumitem'>
3. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span>Given <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> and
   <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> are fixed, there
   exists <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> polynomials
   <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>2</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math> (where each polynomial is
   at most <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math> degrees) such that
   any <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math> (i.e., any number whose
   base-<!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> representation has 0s
   between the base-<!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit index
   greater than 0 and smaller than <!-- l. 2312 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>)
   can be expressed as the following formula:
   <!-- l. 2314 --><p class='noindent'><!-- l. 2314 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
</p>
   <div class='proof'>
   <!-- l. 2319 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2319 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2319 --><p class='noindent'><!-- l. 2319 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   can be expressed as a base-<!-- l. 2319 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   number as follows:
   </p><!-- l. 2321 --><p class='noindent'><!-- l. 2321 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow></msup></mrow></math>
   </p><!-- l. 2323 --><p class='noindent'><!-- l. 2323 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2325 --><p class='noindent'>Based on step 3â€™s claim (<!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>),
   we know that the value of <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   depends only on <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>
   (given <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   and <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   are fixed). Therefore, we can imagine that there exists some function <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>f</mi><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   whose input is <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
   and the output is <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
   Alternatively, we can imagine that there exist <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>
   different functions <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   such that each <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   is a polynomial whose input is <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>
   and the output is <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>,
   and <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>.
   In this case, the input and output domain of each polynomial <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   is <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>[</mo><mn>0</mn><mo class='MathClass-punc' stretchy='false'>,</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>]</mo></mrow></math>.
   Therefore, we can design each <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   as a <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
   polynomial and derive each <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>
   based on polynomial interpolation (<a href='LagrangesPolynomialInterpolation.html#lagranges-polynomial-interpolation'><span class='ts1-lmr10-x-x-109'>Â§</span>A-15<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>) by using <!-- l. 2325 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   coordinate values.
   </p><!-- l. 2327 --><p class='noindent'>Note that whenever we increase <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
                                                                                         
                                                                                         
   to <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math>,
   we add a new polynomial <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></math>.
   However, the previous polynomials <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   stay the same as before, because increasing <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   by 1 only adds a new base-<!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   constant <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn></mrow></msub></math>
   for the highest base-<!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit, while keeping the lower-digit constants <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>
   the same as before. Therefore, the polynomials <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>f</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>,
   each of which computes <!-- l. 2327 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub></mrow></math>,
   also stay the same as before.
                                                                                        â–¡
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
4. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span>The formula in step 4â€™s claim can be further concretized as follows:
   <!-- l. 2333 --><p class='noindent'><!-- l. 2333 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
</p>
   <div class='proof'>
   <!-- l. 2336 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2336 --><p class='noindent'>According to step 2â€™s claim (<!-- l. 2336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>p</mi></mrow></math>),
   we know that the following base-<!-- l. 2336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation of <!-- l. 2336 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup></math>:
   </p><!-- l. 2338 --><p class='noindent'><!-- l. 2338 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2340 --><p class='noindent'><!-- l. 2340 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2342 --><p class='noindent'>will be the following:
   </p><!-- l. 2344 --><p class='noindent'><!-- l. 2344 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>1</mn></mrow></msub><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>2</mn></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2346 --><p class='noindent'><!-- l. 2346 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2348 --><p class='noindent'>, since step 2â€™s claim implies that the least significant base-<!-- l. 2348 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit of <!-- l. 2348 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup></math>
   in the base-<!-- l. 2348 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   representation is always <!-- l. 2348 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>.
   Thus, the formula in step 4â€™s claim:
   </p><!-- l. 2350 --><p class='noindent'><!-- l. 2350 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>0</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2352 --><p class='noindent'><!-- l. 2352 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2354 --><p class='noindent'>can be further concretized as follows:
   </p><!-- l. 2356 --><p class='noindent'><!-- l. 2356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2358 --><p class='noindent'><!-- l. 2358 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
                                                                                        â–¡
</p>
   </div>
                                                                                         
                                                                                         
   </dd><dt class='enumerate-enumitem'>
5. </dt><dd class='enumerate-enumitem'><span class='rm-lmbxi-10x-x-109'>Claim: </span><!-- l. 2362 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <div class='proof'>
   <!-- l. 2365 --><p class='noindent'><span class='head'>
   <span class='rm-lmri-10x-x-109'>Proof.</span> </span><!-- l. 2365 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   Remember that in step 1, we defined <!-- l. 2366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   as: <!-- l. 2366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></munderover><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>j</mi></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>.
   Therefore, <!-- l. 2366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></mrow></math>.
   This implies that for each polynomial <!-- l. 2366 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub></math>,
   the following is true:
   </p><!-- l. 2368 --><p class='noindent'><!-- l. 2368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2370 --><p class='noindent'><!-- l. 2370 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2372 --><p class='noindent'>Next, we derive the following:
   </p><!-- l. 2374 --><p class='noindent'><!-- l. 2374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   (where <!-- l. 2374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>j</mi> <mo class='MathClass-rel' stretchy='false'>â‰¥</mo><mn>1</mn></mrow></math>)
   </p><!-- l. 2376 --><p class='noindent'><!-- l. 2376 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2378 --><p class='noindent'>The above is true because:
   </p><!-- l. 2380 --><p class='noindent'><!-- l. 2380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup></mrow></math>
   </p><!-- l. 2382 --><p class='noindent'><!-- l. 2382 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup></mrow></math>
   (for some integer <!-- l. 2382 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>q</mi></math>)
   </p><!-- l. 2384 --><p class='noindent'><!-- l. 2384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   multiplying <!-- l. 2384 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></math>
   to both sides</span>
   </p><!-- l. 2386 --><p class='noindent'><!-- l. 2386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>q</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   <!-- l. 2386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   and <!-- l. 2386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   differ by some multiple of <!-- l. 2386 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></math></span>
   </p><!-- l. 2388 --><p class='noindent'><!-- l. 2388 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2390 --><p class='noindent'>Therefore, <!-- l. 2390 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>.
   </p><!-- l. 2392 --><p class='noindent'><!-- l. 2392 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2394 --><p class='noindent'>Now, given step 5â€™s claim (<!-- l. 2394 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>),
   we can derive the following:
   </p><!-- l. 2396 --><p class='noindent'><!-- l. 2396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2398 --><p class='noindent'><!-- l. 2398 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munderover accent='false' accentunder='false'><mrow><mo>âˆ‘</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2398 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   applying step 5â€™s claim</span>
   </p><!-- l. 2400 --><p class='noindent'><!-- l. 2400 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo><munderover accent='false' accentunder='false'><mrow> <mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munderover accent='false' accentunder='false'><mrow><mo>âˆ‘</mo>
</mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2400 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
   applying <!-- l. 2400 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math></span>
   </p><!-- l. 2402 --><p class='noindent'><!-- l. 2402 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
                                                                                         
                                                                                         
                                                                                        â–¡
</p>
   </div>
   </dd><dt class='enumerate-enumitem'>
6. </dt><dd class='enumerate-enumitem'>Finally, we define the lifting polynomial <!-- l. 2406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   as follows:
   <!-- l. 2408 --><p class='noindent'><!-- l. 2408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msubsup><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>p</mi></mrow></msubsup> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><mn>1</mn></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
      </mrow></munderover><msub><mrow><mi>f</mi></mrow><mrow><mi>j</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow></math>
   </p><!-- l. 2410 --><p class='noindent'><!-- l. 2410 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle style='color:#FFFFFF;'><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
   </p><!-- l. 2413 --><p class='noindent'>The above relation implies that <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math> is
   equivalent to the least significant base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit of <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>x</mi></math> (according to step 6â€™s
   claim). Therefore, if we plug in <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
   into <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> and
   regard <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>1</mn></mrow></math>,
   then the output is some number whose least significant
   base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit is
   <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math> and the 2nd least
   significant base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit
   is <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>0</mn><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mn>2</mn></mrow></msup></mrow></math>. As we recursively
   apply the output back to <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   and increment <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   by 1, we iteratively zero out the 2nd least significant
   base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit, the 3rd least
   significant base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> digit, and so
   on. We repeat this process for <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   times to zero out the upper <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
   base-<!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digits, keeping only the least significant digit as it is (i.e.,
   <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mn>0</mn></mrow></msub></math>).
   Therefore, <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
   is a valid lifting polynomial that can be iteratively used to extract the least significant digit of
   <!-- l. 2413 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
</p>
   </dd></dl>
<!-- l. 2418 --><p class='indent'>   We use <!-- l. 2418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as the internal helper function within the digit extraction function
<!-- l. 2418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> that
calls <!-- l. 2418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>x</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> a
total of <!-- l. 2418 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>v</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
times.
   
</p>
                                                                                         
                                                                                         
   <h5 class='subsubsectionHead' id='summary3'><span class='titlemark'>D-2.11.6   </span> <a id='x125-173000D-2.11.6'></a>Summary</h5>
<!-- l. 2470 --><p class='noindent'>We summarize the BFV bootstrapping procedure (with the generalization of
<!-- l. 2470 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>) as
follows.
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-91'>     
<div class='tcolorbox-title'>
<!-- l. 2569 --><p class='indent'>   <!-- l. 2569 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>SummaryÂ D-2.11.6</span><!-- l. 2569 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></math>
                                                                                         
                                                                                         
<span class='rm-lmbx-10x-x-109'>BFV Bootstrapping</span></p></div> 
<div class='tcolorbox-content'><!-- l. 2474 --><p class='noindent'>Suppose we have an RLWE ciphertext <!-- l. 2474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mi>E</mi><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
where <!-- l. 2474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>t</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>
and <!-- l. 2474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>t</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></math>
(i.e.,      the      plaintext      modulus      is      a      power      of      some      prime),
<!-- l. 2474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„¤</mi></mrow></math>,
and <!-- l. 2474 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-rel' stretchy='false'>â‰¥</mo><mn>1</mn></mrow></math>.
</p><!-- l. 2476 --><p class='noindent'><!-- l. 2476 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Modulus Switch</span></span> <span class='rm-lmbx-10x-x-109'>(from </span><!-- l. 2479 --><math display='inline' mathvariant='bold-italic' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>q</mi> <mo class='MathClass-rel' stretchy='false'>â†’</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math><span class='rm-lmbx-10x-x-109'>):</span>
   Scale down the ciphertext from <!-- l. 2479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>A</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>B</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    to <!-- l. 2479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>A</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow><mo class='MathClass-punc' stretchy='false'>,</mo> <mrow><mo fence='true' form='prefix'>âŒˆ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>B</mi></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    <span style='color:#FF0000;'> <!-- l. 2479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
  where <!-- l. 2479 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ª</mo><mi>q</mi></mrow></math></span>
   <!-- l. 2481 --><p class='noindent'><!-- l. 2481 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2483 --><p class='noindent'><!-- l. 2483 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'>mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
    <span style='color:#FF0000;'> <!-- l. 2483 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
  where <!-- l. 2483 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>E</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><mi>q</mi>
</mrow><mrow><mi>p</mi></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup>
 </mrow><mrow><mi>q</mi> </mrow></mfrac></mstyle> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mi>M</mi></mrow></math>,
    which  is  a  modulus  switch  noise  plus  the  rounding  noise  caused  by  treating
    <!-- l. 2483 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow> <mo class='MathClass-rel' stretchy='false'>â‰ˆ</mo><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow></math>.</span>
    </p><!-- l. 2485 --><p class='noindent'><!-- l. 2485 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Homomorphic Decryption</span></span><span class='rm-lmbx-10x-x-109'>:         </span>With           the           bootstrapping           key
    <!-- l. 2487 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    homomorphically decrypt <!-- l. 2487 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-punc' stretchy='false'>,</mo><msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
    as follows:
    <!-- l. 2489 --><p class='noindent'><!-- l. 2489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>A</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>S</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>B</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>
   <span style='color:#FF0000;'> <!-- l. 2489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
  where <!-- l. 2489 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math></span>
    </p><!-- l. 2491 --><p class='noindent'><!-- l. 2491 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2493 --><p class='noindent'>Now,    we    denote    the    modulus-switched    noisy    plaintext    polynomial    as
    <!-- l. 2493 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Z</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo> <mi>K</mi><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>.
    </p><!-- l. 2495 --><p class='noindent'><!-- l. 2495 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
3.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>CoeffToSlot</span></span><span class='rm-lmbx-10x-x-109'>: </span>Move the (encrypted) polynomial <!-- l. 2497 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>â€™s
    coefficients <!-- l. 2497 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mn>0</mn></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub></mrow></math>
     to the input vector slots. This is done by computing:
    <!-- l. 2499 --><p class='noindent'><!-- l. 2499 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mi>Z</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
    </p><!-- l. 2501 --><p class='noindent'><!-- l. 2501 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><msup><mrow><mi>Z</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 2503 --><p class='noindent'>, where <!-- l. 2503 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>n</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><msubsup><mrow><mi>I</mi></mrow><mrow><mi>R</mi></mrow><mrow><mi>n</mi></mrow></msubsup></mrow></math>
    is the batch encoding matrix (SummaryÂ D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>).
    </p><!-- l. 2505 --><p class='noindent'><!-- l. 2505 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
4.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmbx-10x-x-109'>Digit Extraction</span></span><span class='rm-lmbx-10x-x-109'>: </span>We design a polynomial <!-- l. 2507 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    (a digit extraction polynomial) as follows:
    <!-- l. 2509 --><p class='noindent'><!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <mrow><mo fence='true' form='prefix'>(</mo><mrow><munderover accent='false' accentunder='false'><mrow><mi class='MathClass-op'>âˆ‘</mi><mo> â¡<!-- FUNCTION APPLICATION --></mo>
  </mrow><mrow><mi>j</mi><mo class='MathClass-rel' stretchy='false'>=</mo><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></munderover><msub><mrow><mi>d</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msub><msup><mrow><mi>p</mi></mrow><mrow><mi>j</mi></mrow></msup></mrow><mo fence='true' form='postfix'>)</mo></mrow></mrow></math>
    <span style='color:#FF0000;'> <!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
  where <!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <msub><mrow><mi>â„¤</mi></mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></msub></mrow></math>,
    and <!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
   is <!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>â€™s
    least significant base-<!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>
   digit   index   whose   value   is   non-zero   after   digit   index   after   digit   index
    <!-- l. 2509 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math></span>
    </p><!-- l. 2511 --><p class='noindent'><!-- l. 2511 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>F</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><msup><mrow><mi>ğœ€</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-bin' stretchy='false'>+</mo><mn>1</mn>
      </mrow></msup></mrow></math>
     <span style='color:#FF0000;'> <!-- l. 2511 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mo class='MathClass-rel' stretchy='false'>â–¹</mo></math>
  a <!-- l. 2511 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>p</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree
    polynomial       recursively       used       to       finally       extract       the       value
    <!-- l. 2511 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>d</mi></mrow><mrow><mn>0</mn></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math></span>
    </p><!-- l. 2513 --><p class='noindent'><!-- l. 2513 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>â‰¡</mo><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><munder class='msub'><mrow><munder accentunder='false'><mrow><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>F</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msub><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><msub><mrow><mi>F</mi></mrow><mrow><mn>1</mn></mrow></msub></mrow><mo>âŸ</mo></munder> </mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mstyle class='text'><mtext>Â times</mtext></mstyle></mrow></munder><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
    </p><!-- l. 2515 --><p class='noindent'><!-- l. 2515 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p><!-- l. 2519 --><p class='noindent'>We       homomorphically       evaluate       the       digit       extraction       polynomial
    <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub></math>
    recursively total <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
    times at each coefficient <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    of <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Z</mi></math>
   stored  at  input  vector  slots,  which  zeros  out  and  right-shifts  the  least  significant
    (base-<!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>)
    <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ğœ€</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></math>
    digits of <!-- l. 2519 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub></math>
    as follows:
    </p><!-- l. 2521 --><p class='noindent'><!-- l. 2521 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>2</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>3</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>âˆ˜</mo><msub><mrow><mi>G</mi></mrow><mrow><mi>ğœ€</mi></mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msub><mrow><mi>z</mi></mrow><mrow><mi>i</mi></mrow></msub><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    </p><!-- l. 2523 --><p class='noindent'><!-- l. 2523 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mi>â€²</mi></mrow></msubsup><mi>p</mi></mrow></math>
   </p><!-- l. 2525 --><p class='noindent'><!-- l. 2525 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
   </p><!-- l. 2527 --><p class='noindent'>, provided <!-- l. 2527 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>â€™s
    each coefficient is smaller than <!-- l. 2527 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âˆ¥</mo><mrow><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup>
  </mrow><mrow><mn>2</mn>  </mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âˆ¥</mo></mrow></math>.
    At   this   point,   each   input   vector   slot   contains   the   noise-removed   coefficient
    <!-- l. 2527 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><mi>p</mi></mrow></math>.
    </p><!-- l. 2529 --><p class='noindent'><span class='underline'><span class='rm-lmbx-10x-x-109'>Scaling Factor Re-interpretation</span></span><span class='rm-lmbx-10x-x-109'>: </span>At each <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
    round       of       digit       extraction,       we       do       not       explicitly       multiply
    <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>
    to perform division by <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math>,
    but instead conceptually borrow this term from the denominator of the plaintext scaling
    factor <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>,
    conceptually updating the scaling factor to <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>     <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>.
    This implies that at <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math>-th
    round  of  digit  extraction,  the  plaintext  operations  used  for  ciphertext-to-plaintext
    homomorphic  operations  should  encode  their  values  by  using  the  scaling  factor
    <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow>     <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>i</mi><mo class='MathClass-bin' stretchy='false'>+</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>.
    At    the    end    of    digit    extraction,    the    plaintext    scaling    factor    becomes
    <!-- l. 2529 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mi mathvariant='normal'>Î”</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>.
    </p><!-- l. 2532 --><p class='noindent'><!-- l. 2532 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
    </p></dd><dt class='enumerate-enumitem'>
5.  </dt><dd class='enumerate-enumitem'><span class='underline'><span class='rm-lmssbx-10x-x-109'>SlotToCoeff</span></span><span class='rm-lmbx-10x-x-109'>:    </span>Homomorphically     move     each     input     vector     slotâ€™s     value
    <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>m</mi></mrow><mrow><mi>i</mi></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msubsup><mrow><mi>k</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msubsup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></math>
    back to the (encrypted) polynomial coefficient positions. This is done by multiplying
    <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>
   to     the     output     ciphertext     of     the     digit     extraction     step,     where
    <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mover accent='true'><mrow><mi>W</mi></mrow><mo accent='true' stretchy='false'>~</mo></mover></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ—</mo></mrow></msup></math>
   is the decoding matrix (SummaryÂ D-2.9.3 in <a href='HomomorphicRotationofInputVectorSlots.html#summary2'><span class='ts1-lmr10-x-x-109'>Â§</span>D-2.9.3<!-- tex4ht:ref: subsubsec:bfvrrotationssummary  --></a>). The output of this computation is
    <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>K</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mi>p</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mstyle class='text'><mtext>b</mtext></mstyle><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle> <mo class='MathClass-rel' stretchy='false'>=</mo><msub><mrow> <mstyle class='text'><mtext class='textsf' mathvariant='sans-serif'>ğ–±ğ–«ğ–¶ğ–¤</mtext></mstyle></mrow><mrow><mi>S</mi><mo class='MathClass-punc' stretchy='false'>,</mo><mi>Ïƒ</mi></mrow></msub><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mi mathvariant='normal'>Î”</mi> <mo class='MathClass-bin' stretchy='false'>â‹…</mo><mo class='MathClass-open' stretchy='false'>(</mo><mi>M</mi> <mo class='MathClass-bin' stretchy='false'>+</mo> <msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mstyle class='text'><mtext>new2</mtext></mstyle><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle><mspace width='0.2em'></mspace><mo class='MathClass-bin' stretchy='false'> mod</mo><mspace width='0.2em'></mspace> <mi>q</mi></mrow></math>,
    where <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>E</mi></mrow><mrow><mo class='MathClass-open' stretchy='false'>âŸ¨</mo><mstyle class='text'><mtext>b</mtext></mstyle><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mrow></msup></math>
   is       the       new       noise       generated       during       bootstrapping       (step
    <!-- l. 2534 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn> <mo class='MathClass-rel' stretchy='false'>âˆ¼</mo><mn>5</mn></mrow></math>).
    </dd></dl>
 
</div> 
</div>                                                                     
                                                                                         
<!-- l. 2571 --><p class='noindent'><span class='rm-lmbx-10x-x-109'>The purpose of Homomorphic Decryption: </span>Its purpose is to temporarily adjust the scaling factor of the
ciphertext to preserve the correctness of bootstrapping. Before homomorphic decryption, the ciphertext encrypts
<!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi></mrow></math>, a message with the scaling factor
<!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup></math>. After homomorphic decryption,
the ciphertext encrypts <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi></mrow></math>,
the message <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mi>r</mi></mrow></msup><mi>M</mi></mrow></math> with the
scaling factor <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi mathvariant='normal'>Î”</mi></mrow><mrow><mi>â€²</mi></mrow></msup> <mo class='MathClass-rel' stretchy='false'>=</mo> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>ğœ€</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></mrow></math>. This
specific adjustment is needed for the scaling factor re-interpretation during each round of digit extraction to conceptually
divide by <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>p</mi></math> (i.e., multiply
by <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-rel' stretchy='false'>|</mo><msup><mrow><mi>p</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup><msub><mrow><mo class='MathClass-rel' stretchy='false'>|</mo></mrow><mrow><mi>q</mi></mrow></msub></mrow></math>) and eventually adjust
the scaling factor back to <!-- l. 2571 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'> <mrow><mo fence='true' form='prefix'>âŒŠ</mo><mrow><mstyle displaystyle='true'><mfrac><mrow> <mi>q</mi>
</mrow><mrow><msup><mrow><mi>p</mi></mrow><mrow><mi>r</mi></mrow></msup></mrow></mfrac></mstyle></mrow><mo fence='true' form='postfix'>âŒ‹</mo></mrow></math>
as the original form for standard BFV ciphertexts.
</p><!-- l. 621 --><p class='indent'>
                                                                                         
                                                                                         
</p>
   <!-- l. 623 --><div class='crosslinks'><p class='noindent'>[<a href='ApplicationMatrixMultiplication.html'>prev</a>][<a href='BFVScheme.html#NoiseBootstrapping1.html'>parent</a>]</p></div>
    
</body> 
</html>