<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Sparsely Packing Ciphertext</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!--  l. 1354  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicConjugation.html'>prev</a>][<a href='CKKSScheme.html#SparselyPackingCiphertext.html'>parent</a>][<a href='ModulusBootstrapping.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='sparsely-packing-ciphertext'><span class='titlemark'>D-3.12   </span> <a id='x135-195000D-3.12'></a>Sparsely Packing Ciphertext</h4>
<!--  l. 1357  --><p class='noindent'>In <a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>Â§</span>D-3.1<!--  tex4ht:ref: subsec:ckks-conjugation   --></a>, we learned the CKKS encoding scheme which encodes an input vector with
<!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> slots (i.e.,
<!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional input vector) into
an <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial. While
the polynomial ringâ€™s degree <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
is fixed at the setup stage of CKKS as a security parameter, some applications may only need to use fewer than
<!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> input vector slots. Suppose
we only need to use <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>
slots out of <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> slots,
where <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math> is some
number that divides <!--  l. 1357  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
Then, the corresponding input vector and encoded polynomial gets a special property as described
below:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-100'>     
<div class='tcolorbox-title'>
<!--  l. 1373  --><p class='indent'>   <!--  l. 1373  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>âŸ¨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>SummaryÂ D-3.12</span><!--  l. 1373  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>âŸ©</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>CKKSâ€™s Sparsely Packing Polynomial and
                                                                                         
                                                                                         
Ciphertext</span></p></div> 
<div class='tcolorbox-content'><!--  l. 1362  --><p class='noindent'>Suppose that an <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>-dimensional
input vector gets encoded into a polynomial in <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
And suppose that <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></math>
is some number that divides <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
We define polynomial <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as  the  one  which  has  non-zero  constants  at  the  terms  whose  power  is  a  multiple  of
<!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></math>
and all other terms have zero constants (i.e., <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac> </mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>â‹¯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>âˆ’</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>).
We can express <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as some <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
where <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>
and thus <!--  l. 1362  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!--  l. 1364  --><p class='noindent'><!--  l. 1364  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 1366  --><p class='noindent'>Then, the followings are true:
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'>Every <!--  l. 1369  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    is        isomorphically        mapped        to        (i.e.,        decoded        into)        some
    <!--  l. 1369  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
    input vector which comprises <!--  l. 1369  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
   repetitions of <!--  l. 1369  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
    consecutive slot values.
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Conversely, if an <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
    input vector comprises <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
   repetitions of the first <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
    consecutive     slot     values,     then     the     vector     gets     encoded     into     some
    <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    (i.e., some polynomial in <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    that   has   zero   constants   at   the   terms   whose   degree   is   not   a   multiple   of
    <!--  l. 1370  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>).</dd></dl>
 
</div> 
</div>
<!--  l. 1375  --><p class='indent'>   We could show both directions of proof: (1) the forward (decoding-direction) proof; and (2) the backward
(encoding-direction) proof. However, it is sufficient to prove only either direction, because the encoding
(<!--  l. 1375  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>Ïƒ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn></mrow></msup></math>) and
decoding (<!--  l. 1375  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>Ïƒ</mi></math>)
processes are isomorphic. Among these two, we will show only the forward proof for simplicity.
   
</p>
   <h5 class='subsubsectionHead' id='forward-proof-decoding-of-sparsely-packed-ciphertext'><span class='titlemark'>D-3.12.1   </span> <a id='x135-196000D-3.12.1'></a>Forward Proof: Decoding of Sparsely Packed Ciphertext</h5>
<!--  l. 1379  --><p class='noindent'>We will prove that for each <!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>âˆˆ</mo> <mi>â„¤</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
(i.e., a polynomial in <!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>â„</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>âˆ•</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
which has non-zero constants only at those terms with a power of multiple of
<!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
and zero constants in all other terms), the polynomial gets decoded into some
<!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional input
vector which comprises <!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math>
repetitions of the first <!--  l. 1379  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
consecutive slot values.
</p><!--  l. 1381  --><p class='indent'>   To decode <!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> into an input
vector, we need to evaluate <!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
at <!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> distinct
roots of <!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> (i.e.,
<!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
primitive <!--  l. 1381  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity), which are:
</p><!--  l. 1383  --><p class='indent'>   <!--  l. 1383  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext>Â </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!--  l. 1386  --><p class='indent'>   <span id='textcolor171'># where <!--  l. 1386  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Ï‰</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœ‹</mi></mrow>
<mrow><mi>n</mi></mrow></mfrac> </mrow></msup></mrow></math>, the base and
generator of the primitive (<!--  l. 1386  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi></mrow></math>)-th
roots of unity</span>
</p><!--  l. 1388  --><p class='indent'>   <!--  l. 1388  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 1390  --><p class='indent'>   But since <!--  l. 1390  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
the above evaluation is equivalent to evaluating:
</p><!--  l. 1392  --><p class='indent'>   <!--  l. 1392  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!--  l. 1395  --><p class='indent'>   <!--  l. 1395  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 1397  --><p class='indent'>   <!--  l. 1397  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Ï‰</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!--  l. 1400  --><p class='indent'>   <!--  l. 1400  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 1402  --><p class='indent'>   <!--  l. 1402  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext>Â </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>â‹¯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Î¾</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>âˆ’</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!--  l. 1405  --><p class='indent'>   <span id='textcolor172'># where <!--  l. 1405  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Î¾</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>ğ‘–ğœ‹</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>, the base and
generator of the primitive <!--  l. 1405  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity</span>
</p><!--  l. 1407  --><p class='indent'>   <!--  l. 1407  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!--  l. 1409  --><p class='indent'>   Notice that <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Î¾</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>Ï‰</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>. Therefore,
the above evaluation of <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
outputs <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow></mfrac></mstyle></math> repeated
values of <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> evaluated
at <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> distinct
primitive <!--  l. 1409  --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>Î¼</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><msup><mrow><mi>n</mi></mrow><mrow><mi>â€²</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity.
                                                                                         
                                                                                         
</p>
   <!--  l. 1622  --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicConjugation.html'>prev</a>][<a href='CKKSScheme.html#SparselyPackingCiphertext.html'>parent</a>][<a href='ModulusBootstrapping.html'>next</a>]</p></div>
    
</body> 
</html>