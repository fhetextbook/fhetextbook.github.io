<!DOCTYPE html> 
<html lang='en-US' xml:lang='en-US'> 
<head><title>Sparsely Packing Ciphertexts</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='index.css' rel='stylesheet' type='text/css' /> 
<meta content='index.tex' name='src' /> 
 <script async='async' id='MathJax-script' src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js' type='text/javascript'></script>  
</head><body>
   <!-- l. 1353 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicConjugation.html'>prev</a>][<a href='CKKSScheme.html#SparselyPackingCiphertexts.html'>parent</a>][<a href='ModulusBootstrapping.html'>next</a>]</p></div>
   <h4 class='subsectionHead' id='sparsely-packing-ciphertexts'><span class='titlemark'>D-3.12   </span> <a id='x135-195000D-3.12'></a>Sparsely Packing Ciphertexts</h4>
<!-- l. 1356 --><p class='noindent'>In <a href='EncodingandDecoding.html#encoding-and-decoding'><span class='ts1-lmr10-x-x-109'>§</span>D-3.1<!-- tex4ht:ref: subsec:ckks-conjugation  --></a>, we learned the CKKS encoding scheme which encodes an input vector with
<!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> slots (i.e.,
<!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional input vector) into
an <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>n</mi> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-degree polynomial. While
the polynomial ring’s degree <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>
is fixed at the setup stage of CKKS as a security parameter, some applications may only need to use fewer than
<!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math> input vector slots. Suppose
we only need to use <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>
slots out of <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> slots,
where <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></math> is some
number that divides <!-- l. 1356 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
Then, the corresponding input vector and encoded polynomial get a special property as described
below:
</p>
   <div class='tcolorbox tcolorbox' id='tcolobox-100'>     
<div class='tcolorbox-title'>
<!-- l. 1372 --><p class='indent'>   <!-- l. 1372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>⟨</mo></mstyle></math><span class='rm-lmbx-10x-x-109'>Summary D-3.12</span><!-- l. 1372 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>⟩</mo></mstyle></math>
<span class='rm-lmbx-10x-x-109'>CKKS’s Sparsely Packing Polynomial and
                                                                                         
                                                                                         
Ciphertext</span></p></div> 
<div class='tcolorbox-content'><!-- l. 1361 --><p class='noindent'>Suppose that an <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math>-dimensional
input vector gets encoded into a polynomial in <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
And suppose that <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></math>
is some number that divides <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math>.
We define polynomial <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as  the  one  which  has  non-zero  constants  at  the  terms  whose  power  is  a  multiple  of
<!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></math>
and all other terms have zero constants (i.e., <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>c</mi></mrow><mrow><mn>0</mn></mrow></msub> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac> </mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mfrac><mrow><mn>2</mn><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac> </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mo class='MathClass-rel' stretchy='false'>⋯</mo> <mo class='MathClass-bin' stretchy='false'>+</mo> <msub><mrow><mi>c</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msub><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi><mo class='MathClass-bin' stretchy='false'>−</mo> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>).
We can express <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
as some <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
where <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>Y</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>
and thus <!-- l. 1361 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>.
</p><!-- l. 1363 --><p class='noindent'><!-- l. 1363 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1365 --><p class='noindent'>Then, the following are true:
    </p><dl class='enumerate-enumitem'><dt class='enumerate-enumitem'>
1.  </dt><dd class='enumerate-enumitem'>Every <!-- l. 1368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    is        isomorphically        mapped        to        (i.e.,        decoded        into)        some
    <!-- l. 1368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
    input vector which comprises <!-- l. 1368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math>
   repetitions of <!-- l. 1368 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
    consecutive slot values.
    </dd><dt class='enumerate-enumitem'>
2.  </dt><dd class='enumerate-enumitem'>Conversely, if an <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional
    input vector comprises <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math>
   repetitions of the first <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
    consecutive     slot     values,     then     the     vector     gets     encoded     into     some
    <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    (i.e., some polynomial in <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
    that   has   zero   constants   at   the   terms   whose   degree   is   not   a   multiple   of
    <!-- l. 1369 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math>).</dd></dl>
 
</div> 
</div>
<!-- l. 1374 --><p class='indent'>   We could show both directions of proof: (1) the forward (decoding-direction) proof; and (2) the backward
(encoding-direction) proof. However, it is sufficient to prove only either direction, because the encoding
(<!-- l. 1374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow><mi>σ</mi></mrow><mrow><mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn></mrow></msup></math>) and
decoding (<!-- l. 1374 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>σ</mi></math>)
processes are isomorphic. Among these two, we will show only the forward proof for simplicity.
   
</p>
   <h5 class='subsubsectionHead' id='forward-proof-decoding-of-sparsely-packed-ciphertext'><span class='titlemark'>D-3.12.1   </span> <a id='x135-196000D-3.12.1'></a>Forward Proof: Decoding of Sparsely Packed Ciphertext</h5>
<!-- l. 1378 --><p class='noindent'>We will prove that for each <!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>∈</mo> <mi>ℤ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>Y</mi> </mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
  </mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
                                                                                         
                                                                                         
(i.e., a polynomial in <!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ℝ</mi><mo class='MathClass-open' stretchy='false'>[</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>]</mo><mo class='MathClass-bin' stretchy='false'>∕</mo><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
which has non-zero constants only at those terms with a power of multiple of
<!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math>
and zero constants in all other terms), the polynomial gets decoded into some
<!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><mi>n</mi>
</mrow><mrow><mn>2</mn></mrow></mfrac></mstyle></math>-dimensional input
vector which comprises <!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math>
repetitions of the first <!-- l. 1378 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup>
</mrow><mrow><mn>2</mn> </mrow></mfrac></mstyle></math>
consecutive slot values.
</p><!-- l. 1380 --><p class='indent'>   To decode <!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> into an input
vector, we need to evaluate <!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
at <!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> distinct
roots of <!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msup><mrow><mi>X</mi></mrow><mrow><mi>n</mi></mrow></msup> <mo class='MathClass-bin' stretchy='false'>+</mo> <mn>1</mn></mrow></math> (i.e.,
<!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math> distinct
primitive <!-- l. 1380 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity), which are:
</p><!-- l. 1382 --><p class='indent'>   <!-- l. 1382 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1385 --><p class='indent'>   <span style='color:#FF0000;'> # where <!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ω</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
<mrow><mi>n</mi></mrow></mfrac> </mrow></msup></mrow></math>, the base and
generator of the primitive (<!-- l. 1385 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><mi>n</mi></mrow></math>)-th
roots of unity</span>
</p><!-- l. 1387 --><p class='indent'>   <!-- l. 1387 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1389 --><p class='indent'>   But since <!-- l. 1389 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>M</mi><mo class='MathClass-open' stretchy='false'>(</mo><mi>X</mi><mo class='MathClass-close' stretchy='false'>)</mo> <mo class='MathClass-rel' stretchy='false'>=</mo> <msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>X</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>,
the above evaluation is equivalent to evaluating:
</p><!-- l. 1391 --><p class='indent'>   <!-- l. 1391 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1394 --><p class='indent'>   <!-- l. 1394 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1396 --><p class='indent'>   <!-- l. 1396 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ω</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1399 --><p class='indent'>   <!-- l. 1399 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1401 --><p class='indent'>   <!-- l. 1401 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow> <mo class='MathClass-rel' stretchy='false'>=</mo> <mstyle mathvariant='bold'><mo class='MathClass-open' stretchy='false'>(</mo></mstyle><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ξ</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>0</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mstyle class='text'><mtext> </mtext></mstyle><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ξ</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mo class='MathClass-punc' stretchy='false'>,</mo><mo class='MathClass-rel' stretchy='false'>⋯</mo><mspace class='thinspace' width='0.17em'></mspace><mo class='MathClass-punc' stretchy='false'>,</mo><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><msup><mrow><mi>ξ</mi></mrow><mrow><mi>J</mi><mo class='MathClass-open' stretchy='false'>(</mo><mfrac><mrow><mi>n</mi></mrow>
<mrow><mn>2</mn></mrow></mfrac> <mo class='MathClass-bin' stretchy='false'>−</mo><mn>1</mn><mo class='MathClass-close' stretchy='false'>)</mo></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo><mstyle mathvariant='bold'><mo class='MathClass-close' stretchy='false'>)</mo></mstyle></mrow></math>
</p><!-- l. 1404 --><p class='indent'>   <span style='color:#FF0000;'> # where <!-- l. 1404 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ξ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>e</mi></mrow><mrow><mfrac><mrow><mi mathvariant='italic'>𝑖𝜋</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>, the base and
generator of the primitive <!-- l. 1404 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity</span>
</p><!-- l. 1406 --><p class='indent'>   <!-- l. 1406 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'></math>
</p><!-- l. 1408 --><p class='indent'>   Notice that <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>ξ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <msup><mrow><mi>ω</mi></mrow><mrow> <mfrac><mrow><mi>n</mi></mrow>
<mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mrow></msup></mrow></math>. Therefore,
the above evaluation of <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>
outputs <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mstyle displaystyle='true'><mfrac><mrow> <mi>n</mi>
</mrow><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow></mfrac></mstyle></math> repeated
values of <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><msub><mrow><mi>M</mi></mrow><mrow><mi>Y</mi> </mrow></msub><mo class='MathClass-open' stretchy='false'>(</mo><mi>Y</mi> <mo class='MathClass-close' stretchy='false'>)</mo></mrow></math> evaluated
at <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mfrac><mrow><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup></mrow>
<mrow><mn>2</mn></mrow></mfrac> </mrow></math> distinct
primitive <!-- l. 1408 --><math display='inline' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo class='MathClass-open' stretchy='false'>(</mo><mi>μ</mi> <mo class='MathClass-rel' stretchy='false'>=</mo> <mn>2</mn><msup><mrow><mi>n</mi></mrow><mrow><mi>′</mi></mrow></msup><mo class='MathClass-close' stretchy='false'>)</mo></mrow></math>-th
roots of unity.
                                                                                         
                                                                                         
</p>
   <!-- l. 1621 --><div class='crosslinks'><p class='noindent'>[<a href='HomomorphicConjugation.html'>prev</a>][<a href='CKKSScheme.html#SparselyPackingCiphertexts.html'>parent</a>][<a href='ModulusBootstrapping.html'>next</a>]</p></div>
    
</body> 
</html>